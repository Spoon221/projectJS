import{r as P,u as Yt,c as yl,a as xr,D as bi,V as gt,O as Ei,P as Os,b as Sr,R as rr,T as bl,d as El,e as us,M as Kr,f as No,g as _l,h as fs,i as Jo,j as Gr,I as Ml,S as ks,L as Ls,k as vn,F as yr,C as zt,l as Tl,m as wl,n as Fl,o as wr,p as nr,q as zr,s as Il,t as Ko,v as jo,w as Sl,x as Dl,B as Bn,y as Rl,z as Ft,A as Qo,E as hs,G as Wo,H as Qi,J as xl,K as Xo,N as Gl,Q as Vo,U as Ul,W as Ol,X as kl,Y as Ll,Z as Pl,_ as Wi,$ as Hl,a0 as Nl,a1 as Jl,a2 as Yo,a3 as zo,a4 as Kl,a5 as jl,a6 as Ql,a7 as Wl,a8 as cr,a9 as Xl,aa as Vl,ab as Yl,ac as zl,ad as lr,ae as wa,af as Fa,ag as Ia,ah as Ps,ai as Zo,aj as Zl,ak as qo,al as Ht,am as ur,an as jr,ao as Tn,ap as ql,aq as $l,ar as eu,as as tu,at as ru,au as nu,av as iu,aw as Sa,ax as su,ay as Un,az as au,aA as Dr,aB as $o,aC as ec,aD as li,aE as ou,aF as cu,aG as ds,aH as lu,aI as uu,aJ as fu,aK as hu,aL as ps,aM as du,aN as Da,aO as pu,aP as mu,aQ as Au,aR as gu,aS as vu,aT as Bu,aU as Cu,aV as yu,aW as Qr,aX as De}from"./index-CRdF4OMy.js";function Zt(){return Zt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Zt.apply(null,arguments)}const On=new gt,Hs=new gt,bu=new gt,Ra=new Sr;function Eu(t,e,n){const s=On.setFromMatrixPosition(t.matrixWorld);s.project(e);const i=n.width/2,r=n.height/2;return[s.x*i+i,-(s.y*r)+r]}function _u(t,e){const n=On.setFromMatrixPosition(t.matrixWorld),s=Hs.setFromMatrixPosition(e.matrixWorld),i=n.sub(s),r=e.getWorldDirection(bu);return i.angleTo(r)>Math.PI/2}function Mu(t,e,n,s){const i=On.setFromMatrixPosition(t.matrixWorld),r=i.clone();r.project(e),Ra.set(r.x,r.y),n.setFromCamera(Ra,e);const a=n.intersectObjects(s,!0);if(a.length){const c=a[0].distance;return i.distanceTo(n.ray.origin)<c}return!0}function Tu(t,e){if(e instanceof Ei)return e.zoom;if(e instanceof Os){const n=On.setFromMatrixPosition(t.matrixWorld),s=Hs.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,r=n.distanceTo(s);return 1/(2*Math.tan(i/2)*r)}else return 1}function wu(t,e,n){if(e instanceof Os||e instanceof Ei){const s=On.setFromMatrixPosition(t.matrixWorld),i=Hs.setFromMatrixPosition(e.matrixWorld),r=s.distanceTo(i),a=(n[1]-n[0])/(e.far-e.near),c=n[1]-a*e.far;return Math.round(a*r+c)}}const ms=t=>Math.abs(t)<1e-10?0:t;function tc(t,e,n=""){let s="matrix3d(";for(let i=0;i!==16;i++)s+=ms(e[i]*t.elements[i])+(i!==15?",":")");return n+s}const Fu=(t=>e=>tc(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Iu=(t=>(e,n)=>tc(e,t(n),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function Su(t){return t&&typeof t=="object"&&"current"in t}const ui=P.forwardRef(({children:t,eps:e=.001,style:n,className:s,prepend:i,center:r,fullscreen:a,portal:c,distanceFactor:o,sprite:l=!1,transform:u=!1,occlude:f,onOcclude:h,castShadow:d,receiveShadow:m,material:g,geometry:v,zIndexRange:C=[16777271,0],calculatePosition:B=Eu,as:y="div",wrapperClass:b,pointerEvents:M="auto",...S},I)=>{const{gl:E,camera:w,scene:G,size:W,raycaster:F,events:O,viewport:D}=Yt(),[X]=P.useState(()=>document.createElement(y)),J=P.useRef(),ie=P.useRef(null),Ae=P.useRef(0),z=P.useRef([0,0]),L=P.useRef(null),T=P.useRef(null),R=(c==null?void 0:c.current)||O.connected||E.domElement.parentNode,x=P.useRef(null),j=P.useRef(!1),k=P.useMemo(()=>f&&f!=="blending"||Array.isArray(f)&&f.length&&Su(f[0]),[f]);P.useLayoutEffect(()=>{const le=E.domElement;f&&f==="blending"?(le.style.zIndex=`${Math.floor(C[0]/2)}`,le.style.position="absolute",le.style.pointerEvents="none"):(le.style.zIndex=null,le.style.position=null,le.style.pointerEvents=null)},[f]),P.useLayoutEffect(()=>{if(ie.current){const le=J.current=yl(X);if(G.updateMatrixWorld(),u)X.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const q=B(ie.current,w,W);X.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${q[0]}px,${q[1]}px,0);transform-origin:0 0;`}return R&&(i?R.prepend(X):R.appendChild(X)),()=>{R&&R.removeChild(X),le.unmount()}}},[R,u]),P.useLayoutEffect(()=>{b&&(X.className=b)},[b]);const Q=P.useMemo(()=>u?{position:"absolute",top:0,left:0,width:W.width,height:W.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:r?"translate3d(-50%,-50%,0)":"none",...a&&{top:-W.height/2,left:-W.width/2,width:W.width,height:W.height},...n},[n,r,a,W,u]),V=P.useMemo(()=>({position:"absolute",pointerEvents:M}),[M]);P.useLayoutEffect(()=>{if(j.current=!1,u){var le;(le=J.current)==null||le.render(P.createElement("div",{ref:L,style:Q},P.createElement("div",{ref:T,style:V},P.createElement("div",{ref:I,className:s,style:n,children:t}))))}else{var q;(q=J.current)==null||q.render(P.createElement("div",{ref:I,style:Q,className:s,children:t}))}});const Y=P.useRef(!0);xr(le=>{if(ie.current){w.updateMatrixWorld(),ie.current.updateWorldMatrix(!0,!1);const q=u?z.current:B(ie.current,w,W);if(u||Math.abs(Ae.current-w.zoom)>e||Math.abs(z.current[0]-q[0])>e||Math.abs(z.current[1]-q[1])>e){const ee=_u(ie.current,w);let we=!1;k&&(Array.isArray(f)?we=f.map(ve=>ve.current):f!=="blending"&&(we=[G]));const _e=Y.current;if(we){const ve=Mu(ie.current,w,F,we);Y.current=ve&&!ee}else Y.current=!ee;_e!==Y.current&&(h?h(!Y.current):X.style.display=Y.current?"block":"none");const he=Math.floor(C[0]/2),Be=f?k?[C[0],he]:[he-1,0]:C;if(X.style.zIndex=`${wu(ie.current,w,Be)}`,u){const[ve,ne]=[W.width/2,W.height/2],ge=w.projectionMatrix.elements[5]*ne,{isOrthographicCamera:me,top:$,left:Se,bottom:de,right:ye}=w,ue=Fu(w.matrixWorldInverse),Ke=me?`scale(${ge})translate(${ms(-(ye+Se)/2)}px,${ms(($+de)/2)}px)`:`translateZ(${ge}px)`;let pe=ie.current.matrixWorld;l&&(pe=w.matrixWorldInverse.clone().transpose().copyPosition(pe).scale(ie.current.scale),pe.elements[3]=pe.elements[7]=pe.elements[11]=0,pe.elements[15]=1),X.style.width=W.width+"px",X.style.height=W.height+"px",X.style.perspective=me?"":`${ge}px`,L.current&&T.current&&(L.current.style.transform=`${Ke}${ue}translate(${ve}px,${ne}px)`,T.current.style.transform=Iu(pe,1/((o||10)/400)))}else{const ve=o===void 0?1:Tu(ie.current,w)*o;X.style.transform=`translate3d(${q[0]}px,${q[1]}px,0) scale(${ve})`}z.current=q,Ae.current=w.zoom}}if(!k&&x.current&&!j.current)if(u){if(L.current){const q=L.current.children[0];if(q!=null&&q.clientWidth&&q!=null&&q.clientHeight){const{isOrthographicCamera:ee}=w;if(ee||v)S.scale&&(Array.isArray(S.scale)?S.scale instanceof gt?x.current.scale.copy(S.scale.clone().divideScalar(1)):x.current.scale.set(1/S.scale[0],1/S.scale[1],1/S.scale[2]):x.current.scale.setScalar(1/S.scale));else{const we=(o||10)/400,_e=q.clientWidth*we,he=q.clientHeight*we;x.current.scale.set(_e,he,1)}j.current=!0}}}else{const q=X.children[0];if(q!=null&&q.clientWidth&&q!=null&&q.clientHeight){const ee=1/D.factor,we=q.clientWidth*ee,_e=q.clientHeight*ee;x.current.scale.set(we,_e,1),j.current=!0}x.current.lookAt(le.camera.position)}});const fe=P.useMemo(()=>({vertexShader:u?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[u]);return P.createElement("group",Zt({},S,{ref:ie}),f&&!k&&P.createElement("mesh",{castShadow:d,receiveShadow:m,ref:x},v||P.createElement("planeGeometry",null),g||P.createElement("shaderMaterial",{side:bi,vertexShader:fe.vertexShader,fragmentShader:fe.fragmentShader})))});function Du(t,e,n){return Math.max(e,Math.min(t,n))}const ot={toVector(t,e){return t===void 0&&(t=e),Array.isArray(t)?t:[t,t]},add(t,e){return[t[0]+e[0],t[1]+e[1]]},sub(t,e){return[t[0]-e[0],t[1]-e[1]]},addTo(t,e){t[0]+=e[0],t[1]+=e[1]},subTo(t,e){t[0]-=e[0],t[1]-=e[1]}};function xa(t,e,n){return e===0||Math.abs(e)===1/0?Math.pow(t,n*5):t*e*n/(e+n*t)}function Ga(t,e,n,s=.15){return s===0?Du(t,e,n):t<e?-xa(e-t,n-e,s)+e:t>n?+xa(t-n,n-e,s)+n:t}function Ru(t,[e,n],[s,i]){const[[r,a],[c,o]]=t;return[Ga(e,r,a,s),Ga(n,c,o,i)]}function xu(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gu(t){var e=xu(t,"string");return typeof e=="symbol"?e:String(e)}function pt(t,e,n){return e=Gu(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ua(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,s)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ua(Object(n),!0).forEach(function(s){pt(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ua(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const rc={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function Oa(t){return t?t[0].toUpperCase()+t.slice(1):""}const Uu=["enter","leave"];function Ou(t=!1,e){return t&&!Uu.includes(e)}function ku(t,e="",n=!1){const s=rc[t],i=s&&s[e]||e;return"on"+Oa(t)+Oa(i)+(Ou(n,i)?"Capture":"")}const Lu=["gotpointercapture","lostpointercapture"];function Pu(t){let e=t.substring(2).toLowerCase();const n=!!~e.indexOf("passive");n&&(e=e.replace("passive",""));const s=Lu.includes(e)?"capturecapture":"capture",i=!!~e.indexOf(s);return i&&(e=e.replace("capture","")),{device:e,capture:i,passive:n}}function Hu(t,e=""){const n=rc[t],s=n&&n[e]||e;return t+s}function _i(t){return"touches"in t}function nc(t){return _i(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function Nu(t){return Array.from(t.touches).filter(e=>{var n,s;return e.target===t.currentTarget||((n=t.currentTarget)===null||n===void 0||(s=n.contains)===null||s===void 0?void 0:s.call(n,e.target))})}function Ju(t){return t.type==="touchend"||t.type==="touchcancel"?t.changedTouches:t.targetTouches}function ic(t){return _i(t)?Ju(t)[0]:t}function As(t,e){try{const n=e.clientX-t.clientX,s=e.clientY-t.clientY,i=(e.clientX+t.clientX)/2,r=(e.clientY+t.clientY)/2,a=Math.hypot(n,s);return{angle:-(Math.atan2(n,s)*180)/Math.PI,distance:a,origin:[i,r]}}catch{}return null}function Ku(t){return Nu(t).map(e=>e.identifier)}function ka(t,e){const[n,s]=Array.from(t.touches).filter(i=>e.includes(i.identifier));return As(n,s)}function Xi(t){const e=ic(t);return _i(t)?e.identifier:e.pointerId}function Zr(t){const e=ic(t);return[e.clientX,e.clientY]}const La=40,Pa=800;function sc(t){let{deltaX:e,deltaY:n,deltaMode:s}=t;return s===1?(e*=La,n*=La):s===2&&(e*=Pa,n*=Pa),[e,n]}function ju(t){var e,n;const{scrollX:s,scrollY:i,scrollLeft:r,scrollTop:a}=t.currentTarget;return[(e=s??r)!==null&&e!==void 0?e:0,(n=i??a)!==null&&n!==void 0?n:0]}function Qu(t){const e={};if("buttons"in t&&(e.buttons=t.buttons),"shiftKey"in t){const{shiftKey:n,altKey:s,metaKey:i,ctrlKey:r}=t;Object.assign(e,{shiftKey:n,altKey:s,metaKey:i,ctrlKey:r})}return e}function fi(t,...e){return typeof t=="function"?t(...e):t}function Wu(){}function Xu(...t){return t.length===0?Wu:t.length===1?t[0]:function(){let e;for(const n of t)e=n.apply(this,arguments)||e;return e}}function Ha(t,e){return Object.assign({},e,t||{})}const Vu=32;class ac{constructor(e,n,s){this.ctrl=e,this.args=n,this.key=s,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:n,ingKey:s,args:i}=this;n[s]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=i,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const n=this.state,s=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=e.target,n.currentTarget=e.currentTarget,n.lastOffset=s.from?fi(s.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=e.timeStamp)}computeValues(e){const n=this.state;n._values=e,n.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:n,config:s,shared:i}=this;n.args=this.args;let r=0;if(e&&(n.event=e,s.preventDefault&&e.cancelable&&n.event.preventDefault(),n.type=e.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,Qu(e)),i.down=i.pressed=i.buttons%2===1||i.touches>0,r=e.timeStamp-n.timeStamp,n.timeStamp=e.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const S=n._delta.map(Math.abs);ot.addTo(n._distance,S)}this.axisIntent&&this.axisIntent(e);const[a,c]=n._movement,[o,l]=s.threshold,{_step:u,values:f}=n;if(s.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(a)>=o&&f[0]),u[1]===!1&&(u[1]=Math.abs(c)>=l&&f[1])):(u[0]===!1&&(u[0]=Math.abs(a)>=o&&Math.sign(a)*o),u[1]===!1&&(u[1]=Math.abs(c)>=l&&Math.sign(c)*l)),n.intentional=u[0]!==!1||u[1]!==!1,!n.intentional)return;const h=[0,0];if(s.hasCustomTransform){const[S,I]=f;h[0]=u[0]!==!1?S-u[0]:0,h[1]=u[1]!==!1?I-u[1]:0}else h[0]=u[0]!==!1?a-u[0]:0,h[1]=u[1]!==!1?c-u[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(h);const d=n.offset,m=n._active&&!n._blocked||n.active;m&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=i[this.ingKey]=n._active,e&&(n.first&&("bounds"in s&&(n._bounds=fi(s.bounds,n)),this.setup&&this.setup()),n.movement=h,this.computeOffset()));const[g,v]=n.offset,[[C,B],[y,b]]=n._bounds;n.overflow=[g<C?-1:g>B?1:0,v<y?-1:v>b?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const M=n._active?s.rubberband||[0,0]:[0,0];if(n.offset=Ru(n._bounds,n.offset,M),n.delta=ot.sub(n.offset,d),this.computeMovement(),m&&(!n.last||r>Vu)){n.delta=ot.sub(n.offset,d);const S=n.delta.map(Math.abs);ot.addTo(n.distance,S),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&r>0&&(n.velocity=[S[0]/r,S[1]/r],n.timeDelta=r)}}emit(){const e=this.state,n=this.shared,s=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!s.triggerAllEvents)return;const i=this.handler(lt(lt(lt({},n),e),{},{[this.aliasKey]:e.values}));i!==void 0&&(e.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function Yu([t,e],n){const s=Math.abs(t),i=Math.abs(e);if(s>i&&s>n)return"x";if(i>s&&i>n)return"y"}class kn extends ac{constructor(...e){super(...e),pt(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=ot.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=ot.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const n=this.state,s=this.config;if(!n.axis&&e){const i=typeof s.axisThreshold=="object"?s.axisThreshold[nc(e)]:s.axisThreshold;n.axis=Yu(n._movement,i)}n._blocked=(s.lockDirection||!!s.axis)&&!n.axis||!!s.axis&&s.axis!==n.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const zu=t=>t,Na=.15,oc={enabled(t=!0){return t},eventOptions(t,e,n){return lt(lt({},n.shared.eventOptions),t)},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[Na,Na];case!1:return[0,0];default:return ot.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return ot.toVector(t)},transform(t,e,n){const s=t||n.shared.transform;return this.hasCustomTransform=!!s,s||zu},threshold(t){return ot.toVector(t,0)}},Zu=0,Ur=lt(lt({},oc),{},{axis(t,e,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(t=Zu){return t},bounds(t={}){if(typeof t=="function")return r=>Ur.bounds(t(r));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:e=-1/0,right:n=1/0,top:s=-1/0,bottom:i=1/0}=t;return[[e,n],[s,i]]}}),Ja={ArrowRight:(t,e=1)=>[t*e,0],ArrowLeft:(t,e=1)=>[-1*t*e,0],ArrowUp:(t,e=1)=>[0,-1*t*e],ArrowDown:(t,e=1)=>[0,t*e]};class qu extends kn{constructor(...e){super(...e),pt(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const n=e._bounds.getBoundingClientRect(),s=e.currentTarget.getBoundingClientRect(),i={left:n.left-s.left+e.offset[0],right:n.right-s.right+e.offset[0],top:n.top-s.top+e.offset[1],bottom:n.bottom-s.bottom+e.offset[1]};e._bounds=Ur.bounds(i)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const n=this.config,s=this.state;if(e.buttons!=null&&(Array.isArray(n.pointerButtons)?!n.pointerButtons.includes(e.buttons):n.pointerButtons!==-1&&n.pointerButtons!==e.buttons))return;const i=this.ctrl.setEventIds(e);n.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(i&&i.size>1&&s._pointerActive)&&(this.start(e),this.setupPointer(e),s._pointerId=Xi(e),s._pointerActive=!0,this.computeValues(Zr(e)),this.computeInitial(),n.preventScrollAxis&&nc(e)!=="mouse"?(s._active=!1,this.setupScrollPrevention(e)):n.delay>0?(this.setupDelayTrigger(e),n.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const n=this.state;n._active=!0,n._preventScroll=!0,n._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const n=this.state,s=this.config;if(!n._pointerActive)return;const i=Xi(e);if(n._pointerId!==void 0&&i!==n._pointerId)return;const r=Zr(e);if(document.pointerLockElement===e.target?n._delta=[e.movementX,e.movementY]:(n._delta=ot.sub(r,n._values),this.computeValues(r)),ot.addTo(n._movement,n._delta),this.compute(e),n._delayed&&n.intentional){this.timeoutStore.remove("dragDelay"),n.active=!1,this.startPointerDrag(e);return}if(s.preventScrollAxis&&!n._preventScroll)if(n.axis)if(n.axis===s.preventScrollAxis||s.preventScrollAxis==="xy"){n._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const n=this.state,s=this.config;if(!n._active||!n._pointerActive)return;const i=Xi(e);if(n._pointerId!==void 0&&i!==n._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[r,a]=n._distance;if(n.tap=r<=s.tapsThreshold&&a<=s.tapsThreshold,n.tap&&s.filterTaps)n._force=!0;else{const[c,o]=n._delta,[l,u]=n._movement,[f,h]=s.swipe.velocity,[d,m]=s.swipe.distance,g=s.swipe.duration;if(n.elapsedTime<g){const v=Math.abs(c/n.timeDelta),C=Math.abs(o/n.timeDelta);v>f&&Math.abs(l)>d&&(n.swipe[0]=Math.sign(c)),C>h&&Math.abs(u)>m&&(n.swipe[1]=Math.sign(o))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const n=this.config,s=n.device;n.pointerLock&&e.currentTarget.requestPointerLock(),n.pointerCapture||(this.eventStore.add(this.sharedConfig.window,s,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,s,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,s,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,$u(e);const n=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",n),this.eventStore.add(this.sharedConfig.window,"touch","cancel",n),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const n=Ja[e.key];if(n){const s=this.state,i=e.shiftKey?10:e.altKey?.1:1;this.start(e),s._delta=n(this.config.keyboardDisplacement,i),s._keyboardActive=!0,ot.addTo(s._movement,s._delta),this.compute(e),this.emit()}}keyUp(e){e.key in Ja&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const n=this.config.device;e(n,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(n,"change",this.pointerMove.bind(this)),e(n,"end",this.pointerUp.bind(this)),e(n,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function $u(t){"persist"in t&&typeof t.persist=="function"&&t.persist()}const Ln=typeof window<"u"&&window.document&&window.document.createElement;function cc(){return Ln&&"ontouchstart"in window}function ef(){return cc()||Ln&&window.navigator.maxTouchPoints>1}function tf(){return Ln&&"onpointerdown"in window}function rf(){return Ln&&"exitPointerLock"in window.document}function nf(){try{return"constructor"in GestureEvent}catch{return!1}}const kt={isBrowser:Ln,gesture:nf(),touch:cc(),touchscreen:ef(),pointer:tf(),pointerLock:rf()},sf=250,af=180,of=.5,cf=50,lf=250,uf=10,Ka={mouse:0,touch:0,pen:8},ff=lt(lt({},Ur),{},{device(t,e,{pointer:{touch:n=!1,lock:s=!1,mouse:i=!1}={}}){return this.pointerLock=s&&kt.pointerLock,kt.touch&&n?"touch":this.pointerLock?"mouse":kt.pointer&&!i?"pointer":kt.touch?"touch":"mouse"},preventScrollAxis(t,e,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&t?sf:void 0,!(!kt.touchscreen||n===!1))return t||(n!==void 0?"y":void 0)},pointerCapture(t,e,{pointer:{capture:n=!0,buttons:s=1,keys:i=!0}={}}){return this.pointerButtons=s,this.keys=i,!this.pointerLock&&this.device==="pointer"&&n},threshold(t,e,{filterTaps:n=!1,tapsThreshold:s=3,axis:i=void 0}){const r=ot.toVector(t,n?s:i?1:0);return this.filterTaps=n,this.tapsThreshold=s,r},swipe({velocity:t=of,distance:e=cf,duration:n=lf}={}){return{velocity:this.transform(ot.toVector(t)),distance:this.transform(ot.toVector(e)),duration:n}},delay(t=0){switch(t){case!0:return af;case!1:return 0;default:return t}},axisThreshold(t){return t?lt(lt({},Ka),t):Ka},keyboardDisplacement(t=uf){return t}});function lc(t){const[e,n]=t.overflow,[s,i]=t._delta,[r,a]=t._direction;(e<0&&s>0&&r<0||e>0&&s<0&&r>0)&&(t._movement[0]=t._movementBound[0]),(n<0&&i>0&&a<0||n>0&&i<0&&a>0)&&(t._movement[1]=t._movementBound[1])}const hf=30,df=100;class pf extends ac{constructor(...e){super(...e),pt(this,"ingKey","pinching"),pt(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){const{type:e,movement:n,lastOffset:s}=this.state;e==="wheel"?this.state.offset=ot.add(n,s):this.state.offset=[(1+n[0])*s[0],n[1]+s[1]]}computeMovement(){const{offset:e,lastOffset:n}=this.state;this.state.movement=[e[0]/n[0],e[1]-n[1]]}axisIntent(){const e=this.state,[n,s]=e._movement;if(!e.axis){const i=Math.abs(n)*hf-Math.abs(s);i<0?e.axis="angle":i>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&(this.state.axis==="scale"?e[1]=0:this.state.axis==="angle"&&(e[0]=0))}cancel(){const e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);const n=this.state,s=this.ctrl.touchIds;if(n._active&&n._touchIds.every(r=>s.has(r))||s.size<2)return;this.start(e),n._touchIds=Array.from(s).slice(0,2);const i=ka(e,n._touchIds);i&&this.pinchStart(e,i)}pointerStart(e){if(e.buttons!=null&&e.buttons%2!==1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);const n=this.state,s=n._pointerEvents,i=this.ctrl.pointerIds;if(n._active&&Array.from(s.keys()).every(a=>i.has(a))||(s.size<2&&s.set(e.pointerId,e),n._pointerEvents.size<2))return;this.start(e);const r=As(...Array.from(s.values()));r&&this.pinchStart(e,r)}pinchStart(e,n){const s=this.state;s.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;const n=ka(e,this.state._touchIds);n&&this.pinchMove(e,n)}pointerMove(e){const n=this.state._pointerEvents;if(n.has(e.pointerId)&&n.set(e.pointerId,e),!this.state._active)return;const s=As(...Array.from(n.values()));s&&this.pinchMove(e,s)}pinchMove(e,n){const s=this.state,i=s._values[1],r=n.angle-i;let a=0;Math.abs(r)>270&&(a+=Math.sign(r)),this.computeValues([n.distance,n.angle-360*a]),s.origin=n.origin,s.turns=a,s._movement=[s._values[0]/s._initial[0]-1,s._values[1]-s._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){const n=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch{}n._pointerEvents.has(e.pointerId)&&n._pointerEvents.delete(e.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();const n=this.state;n._active||(this.start(e),this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY];const s=n._movement;n._movement=[e.scale-1,e.rotation],n._delta=ot.sub(n._movement,s),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){const n=this.config.modifierKey;n&&(Array.isArray(n)?!n.find(s=>e[s]):!e[n])||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||e.cancelable&&e.preventDefault();const s=this.state;s._delta=[-sc(e)[1]/df*s.offset[0],0],ot.addTo(s._movement,s._delta),lc(s),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){const n=this.config.device;n&&(e(n,"start",this[n+"Start"].bind(this)),e(n,"change",this[n+"Move"].bind(this)),e(n,"end",this[n+"End"].bind(this)),e(n,"cancel",this[n+"End"].bind(this)),e("lostPointerCapture","",this[n+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}const mf=lt(lt({},oc),{},{device(t,e,{shared:n,pointer:{touch:s=!1}={}}){if(n.target&&!kt.touch&&kt.gesture)return"gesture";if(kt.touch&&s)return"touch";if(kt.touchscreen){if(kt.pointer)return"pointer";if(kt.touch)return"touch"}},bounds(t,e,{scaleBounds:n={},angleBounds:s={}}){const i=a=>{const c=Ha(fi(n,a),{min:-1/0,max:1/0});return[c.min,c.max]},r=a=>{const c=Ha(fi(s,a),{min:-1/0,max:1/0});return[c.min,c.max]};return typeof n!="function"&&typeof s!="function"?[i(),r()]:a=>[i(a),r(a)]},threshold(t,e,n){return this.lockDirection=n.axis==="lock",ot.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey(t){return t===void 0?"ctrlKey":t},pinchOnWheel(t=!0){return t}});class Af extends kn{constructor(...e){super(...e),pt(this,"ingKey","moving")}move(e){this.config.mouseOnly&&e.pointerType!=="mouse"||(this.state._active?this.moveChange(e):this.moveStart(e),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(e){this.start(e),this.computeValues(Zr(e)),this.compute(e),this.computeInitial(),this.emit()}moveChange(e){if(!this.state._active)return;const n=Zr(e),s=this.state;s._delta=ot.sub(n,s._values),ot.addTo(s._movement,s._delta),this.computeValues(n),this.compute(e),this.emit()}moveEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}bind(e){e("pointer","change",this.move.bind(this)),e("pointer","leave",this.moveEnd.bind(this))}}const gf=lt(lt({},Ur),{},{mouseOnly:(t=!0)=>t});class vf extends kn{constructor(...e){super(...e),pt(this,"ingKey","scrolling")}scroll(e){this.state._active||this.start(e),this.scrollChange(e),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(e){e.cancelable&&e.preventDefault();const n=this.state,s=ju(e);n._delta=ot.sub(s,n._values),ot.addTo(n._movement,n._delta),this.computeValues(s),this.compute(e),this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("scroll","",this.scroll.bind(this))}}const Bf=Ur;class Cf extends kn{constructor(...e){super(...e),pt(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){const n=this.state;n._delta=sc(e),ot.addTo(n._movement,n._delta),lc(n),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}}const yf=Ur;class bf extends kn{constructor(...e){super(...e),pt(this,"ingKey","hovering")}enter(e){this.config.mouseOnly&&e.pointerType!=="mouse"||(this.start(e),this.computeValues(Zr(e)),this.compute(e),this.emit())}leave(e){if(this.config.mouseOnly&&e.pointerType!=="mouse")return;const n=this.state;if(!n._active)return;n._active=!1;const s=Zr(e);n._movement=n._delta=ot.sub(s,n._values),this.computeValues(s),this.compute(e),n.delta=n.movement,this.emit()}bind(e){e("pointer","enter",this.enter.bind(this)),e("pointer","leave",this.leave.bind(this))}}const Ef=lt(lt({},Ur),{},{mouseOnly:(t=!0)=>t}),Ns=new Map,gs=new Map;function _f(t){Ns.set(t.key,t.engine),gs.set(t.key,t.resolver)}const Mf={key:"drag",engine:qu,resolver:ff},Tf={key:"hover",engine:bf,resolver:Ef},wf={key:"move",engine:Af,resolver:gf},Ff={key:"pinch",engine:pf,resolver:mf},If={key:"scroll",engine:vf,resolver:Bf},Sf={key:"wheel",engine:Cf,resolver:yf};function Df(t,e){if(t==null)return{};var n={},s=Object.keys(t),i,r;for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Rf(t,e){if(t==null)return{};var n=Df(t,e),s,i;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}const xf={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=kt.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:e=!1}={}){return{passive:t,capture:e}},transform(t){return t}},Gf=["target","eventOptions","window","enabled","transform"];function si(t={},e){const n={};for(const[s,i]of Object.entries(e))switch(typeof i){case"function":n[s]=i.call(n,t[s],s,t);break;case"object":n[s]=si(t[s],i);break;case"boolean":i&&(n[s]=t[s]);break}return n}function Uf(t,e,n={}){const s=t,{target:i,eventOptions:r,window:a,enabled:c,transform:o}=s,l=Rf(s,Gf);if(n.shared=si({target:i,eventOptions:r,window:a,enabled:c,transform:o},xf),e){const u=gs.get(e);n[e]=si(lt({shared:n.shared},l),u)}else for(const u in l){const f=gs.get(u);f&&(n[u]=si(lt({shared:n.shared},l[u]),f))}return n}class uc{constructor(e,n){pt(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=n}add(e,n,s,i,r){const a=this._listeners,c=Hu(n,s),o=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},l=lt(lt({},o),r);e.addEventListener(c,i,l);const u=()=>{e.removeEventListener(c,i,l),a.delete(u)};return a.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class Of{constructor(){pt(this,"_timeouts",new Map)}add(e,n,s=140,...i){this.remove(e),this._timeouts.set(e,window.setTimeout(n,s,...i))}remove(e){const n=this._timeouts.get(e);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}let kf=class{constructor(e){pt(this,"gestures",new Set),pt(this,"_targetEventStore",new uc(this)),pt(this,"gestureEventStores",{}),pt(this,"gestureTimeoutStores",{}),pt(this,"handlers",{}),pt(this,"config",{}),pt(this,"pointerIds",new Set),pt(this,"touchIds",new Set),pt(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),Lf(this,e)}setEventIds(e){if(_i(e))return this.touchIds=new Set(Ku(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,n){this.handlers=e,this.nativeHandlers=n}applyConfig(e,n){this.config=Uf(e,n,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const n=this.config.shared,s={};let i;if(!(n.target&&(i=n.target(),!i))){if(n.enabled){for(const a of this.gestures){const c=this.config[a],o=ja(s,c.eventOptions,!!i);if(c.enabled){const l=Ns.get(a);new l(this,e,a).bind(o)}}const r=ja(s,n.eventOptions,!!i);for(const a in this.nativeHandlers)r(a,"",c=>this.nativeHandlers[a](lt(lt({},this.state.shared),{},{event:c,args:e})),void 0,!0)}for(const r in s)s[r]=Xu(...s[r]);if(!i)return s;for(const r in s){const{device:a,capture:c,passive:o}=Pu(r);this._targetEventStore.add(i,a,"",s[r],{capture:c,passive:o})}}}};function Lr(t,e){t.gestures.add(e),t.gestureEventStores[e]=new uc(t,e),t.gestureTimeoutStores[e]=new Of}function Lf(t,e){e.drag&&Lr(t,"drag"),e.wheel&&Lr(t,"wheel"),e.scroll&&Lr(t,"scroll"),e.move&&Lr(t,"move"),e.pinch&&Lr(t,"pinch"),e.hover&&Lr(t,"hover")}const ja=(t,e,n)=>(s,i,r,a={},c=!1)=>{var o,l;const u=(o=a.capture)!==null&&o!==void 0?o:e.capture,f=(l=a.passive)!==null&&l!==void 0?l:e.passive;let h=c?s:ku(s,i,u);n&&f&&(h+="Passive"),t[h]=t[h]||[],t[h].push(r)},Pf=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function Hf(t){const e={},n={},s=new Set;for(let i in t)Pf.test(i)?(s.add(RegExp.lastMatch),n[i]=t[i]):e[i]=t[i];return[n,e,s]}function Pr(t,e,n,s,i,r){if(!t.has(n)||!Ns.has(s))return;const a=n+"Start",c=n+"End",o=l=>{let u;return l.first&&a in e&&e[a](l),n in e&&(u=e[n](l)),l.last&&c in e&&e[c](l),u};i[s]=o,r[s]=r[s]||{}}function Nf(t,e){const[n,s,i]=Hf(t),r={};return Pr(i,n,"onDrag","drag",r,e),Pr(i,n,"onWheel","wheel",r,e),Pr(i,n,"onScroll","scroll",r,e),Pr(i,n,"onPinch","pinch",r,e),Pr(i,n,"onMove","move",r,e),Pr(i,n,"onHover","hover",r,e),{handlers:r,config:e,nativeHandlers:s}}function Jf(t,e={},n,s){const i=rr.useMemo(()=>new kf(t),[]);if(i.applyHandlers(t,s),i.applyConfig(e,n),rr.useEffect(i.effect.bind(i)),rr.useEffect(()=>i.clean.bind(i),[]),e.target===void 0)return i.bind.bind(i)}function Kf(t){return t.forEach(_f),function(n,s){const{handlers:i,nativeHandlers:r,config:a}=Nf(n,s||{});return Jf(i,a,void 0,r)}}function jf(t,e){return Kf([Mf,Ff,If,Sf,wf,Tf])(t,e)}var Js=Hn(),xe=t=>Pn(t,Js),Ks=Hn();xe.write=t=>Pn(t,Ks);var Mi=Hn();xe.onStart=t=>Pn(t,Mi);var js=Hn();xe.onFrame=t=>Pn(t,js);var Qs=Hn();xe.onFinish=t=>Pn(t,Qs);var Wr=[];xe.setTimeout=(t,e)=>{const n=xe.now()+e,s=()=>{const r=Wr.findIndex(a=>a.cancel==s);~r&&Wr.splice(r,1),Br-=~r?1:0},i={time:n,handler:t,cancel:s};return Wr.splice(fc(n),0,i),Br+=1,hc(),i};var fc=t=>~(~Wr.findIndex(e=>e.time>t)||~Wr.length);xe.cancel=t=>{Mi.delete(t),js.delete(t),Qs.delete(t),Js.delete(t),Ks.delete(t)};xe.sync=t=>{vs=!0,xe.batchedUpdates(t),vs=!1};xe.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function s(...i){e=i,xe.onStart(n)}return s.handler=t,s.cancel=()=>{Mi.delete(n),e=null},s};var Ws=typeof window<"u"?window.requestAnimationFrame:()=>{};xe.use=t=>Ws=t;xe.now=typeof performance<"u"?()=>performance.now():Date.now;xe.batchedUpdates=t=>t();xe.catch=console.error;xe.frameLoop="always";xe.advance=()=>{xe.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):pc()};var vr=-1,Br=0,vs=!1;function Pn(t,e){vs?(e.delete(t),t(0)):(e.add(t),hc())}function hc(){vr<0&&(vr=0,xe.frameLoop!=="demand"&&Ws(dc))}function Qf(){vr=-1}function dc(){~vr&&(Ws(dc),xe.batchedUpdates(pc))}function pc(){const t=vr;vr=xe.now();const e=fc(vr);if(e&&(mc(Wr.splice(0,e),n=>n.handler()),Br-=e),!Br){Qf();return}Mi.flush(),Js.flush(t?Math.min(64,vr-t):16.667),js.flush(),Ks.flush(),Qs.flush()}function Hn(){let t=new Set,e=t;return{add(n){Br+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return Br-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,Br-=e.size,mc(e,s=>s(n)&&t.add(s)),Br+=t.size,e=t)}}}function mc(t,e){t.forEach(n=>{try{e(n)}catch(s){xe.catch(s)}})}var Wf=Object.defineProperty,Xf=(t,e)=>{for(var n in e)Wf(t,n,{get:e[n],enumerable:!0})},qt={};Xf(qt,{assign:()=>Yf,colors:()=>br,createStringInterpolator:()=>Vs,skipAnimation:()=>gc,to:()=>Ac,willAdvance:()=>Ys});function Bs(){}var Vf=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),ce={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function ar(t,e){if(ce.arr(t)){if(!ce.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}var ze=(t,e)=>t.forEach(e);function hr(t,e,n){if(ce.arr(t)){for(let s=0;s<t.length;s++)e.call(n,t[s],`${s}`);return}for(const s in t)t.hasOwnProperty(s)&&e.call(n,t[s],s)}var Nt=t=>ce.und(t)?[]:ce.arr(t)?t:[t];function Cn(t,e){if(t.size){const n=Array.from(t);t.clear(),ze(n,e)}}var gn=(t,...e)=>Cn(t,n=>n(...e)),Xs=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Vs,Ac,br=null,gc=!1,Ys=Bs,Yf=t=>{t.to&&(Ac=t.to),t.now&&(xe.now=t.now),t.colors!==void 0&&(br=t.colors),t.skipAnimation!=null&&(gc=t.skipAnimation),t.createStringInterpolator&&(Vs=t.createStringInterpolator),t.requestAnimationFrame&&xe.use(t.requestAnimationFrame),t.batchedUpdates&&(xe.batchedUpdates=t.batchedUpdates),t.willAdvance&&(Ys=t.willAdvance),t.frameLoop&&(xe.frameLoop=t.frameLoop)},yn=new Set,Lt=[],Vi=[],hi=0,Ti={get idle(){return!yn.size&&!Lt.length},start(t){hi>t.priority?(yn.add(t),xe.onStart(zf)):(vc(t),xe(Cs))},advance:Cs,sort(t){if(hi)xe.onFrame(()=>Ti.sort(t));else{const e=Lt.indexOf(t);~e&&(Lt.splice(e,1),Bc(t))}},clear(){Lt=[],yn.clear()}};function zf(){yn.forEach(vc),yn.clear(),xe(Cs)}function vc(t){Lt.includes(t)||Bc(t)}function Bc(t){Lt.splice(Zf(Lt,e=>e.priority>t.priority),0,t)}function Cs(t){const e=Vi;for(let n=0;n<Lt.length;n++){const s=Lt[n];hi=s.priority,s.idle||(Ys(s),s.advance(t),s.idle||e.push(s))}return hi=0,Vi=Lt,Vi.length=0,Lt=e,Lt.length>0}function Zf(t,e){const n=t.findIndex(e);return n<0?t.length:n}var qf=(t,e,n)=>Math.min(Math.max(n,t),e),$f={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},Vt="[-+]?\\d*\\.?\\d+",di=Vt+"%";function wi(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var eh=new RegExp("rgb"+wi(Vt,Vt,Vt)),th=new RegExp("rgba"+wi(Vt,Vt,Vt,Vt)),rh=new RegExp("hsl"+wi(Vt,di,di)),nh=new RegExp("hsla"+wi(Vt,di,di,Vt)),ih=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,sh=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,ah=/^#([0-9a-fA-F]{6})$/,oh=/^#([0-9a-fA-F]{8})$/;function ch(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=ah.exec(t))?parseInt(e[1]+"ff",16)>>>0:br&&br[t]!==void 0?br[t]:(e=eh.exec(t))?(Hr(e[1])<<24|Hr(e[2])<<16|Hr(e[3])<<8|255)>>>0:(e=th.exec(t))?(Hr(e[1])<<24|Hr(e[2])<<16|Hr(e[3])<<8|Xa(e[4]))>>>0:(e=ih.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=oh.exec(t))?parseInt(e[1],16)>>>0:(e=sh.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=rh.exec(t))?(Qa(Wa(e[1]),zn(e[2]),zn(e[3]))|255)>>>0:(e=nh.exec(t))?(Qa(Wa(e[1]),zn(e[2]),zn(e[3]))|Xa(e[4]))>>>0:null}function Yi(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Qa(t,e,n){const s=n<.5?n*(1+e):n+e-n*e,i=2*n-s,r=Yi(i,s,t+1/3),a=Yi(i,s,t),c=Yi(i,s,t-1/3);return Math.round(r*255)<<24|Math.round(a*255)<<16|Math.round(c*255)<<8}function Hr(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function Wa(t){return(parseFloat(t)%360+360)%360/360}function Xa(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function zn(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function Va(t){let e=ch(t);if(e===null)return t;e=e||0;const n=(e&4278190080)>>>24,s=(e&16711680)>>>16,i=(e&65280)>>>8,r=(e&255)/255;return`rgba(${n}, ${s}, ${i}, ${r})`}var wn=(t,e,n)=>{if(ce.fun(t))return t;if(ce.arr(t))return wn({range:t,output:e,extrapolate:n});if(ce.str(t.output[0]))return Vs(t);const s=t,i=s.output,r=s.range||[0,1],a=s.extrapolateLeft||s.extrapolate||"extend",c=s.extrapolateRight||s.extrapolate||"extend",o=s.easing||(l=>l);return l=>{const u=uh(l,r);return lh(l,r[u],r[u+1],i[u],i[u+1],o,a,c,s.map)}};function lh(t,e,n,s,i,r,a,c,o){let l=o?o(t):t;if(l<e){if(a==="identity")return l;a==="clamp"&&(l=e)}if(l>n){if(c==="identity")return l;c==="clamp"&&(l=n)}return s===i?s:e===n?t<=e?s:i:(e===-1/0?l=-l:n===1/0?l=l-e:l=(l-e)/(n-e),l=r(l),s===-1/0?l=-l:i===1/0?l=l+s:l=l*(i-s)+s,l)}function uh(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}var fh=(t,e="end")=>n=>{n=e==="end"?Math.min(n,.999):Math.max(n,.001);const s=n*t,i=e==="end"?Math.floor(s):Math.ceil(s);return qf(0,1,i/t)},pi=1.70158,Zn=pi*1.525,Ya=pi+1,za=2*Math.PI/3,Za=2*Math.PI/4.5,qn=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,hh={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>Ya*t*t*t-pi*t*t,easeOutBack:t=>1+Ya*Math.pow(t-1,3)+pi*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((Zn+1)*2*t-Zn)/2:(Math.pow(2*t-2,2)*((Zn+1)*(t*2-2)+Zn)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*za),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*za)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*Za))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*Za)/2+1,easeInBounce:t=>1-qn(1-t),easeOutBounce:qn,easeInOutBounce:t=>t<.5?(1-qn(1-2*t))/2:(1+qn(2*t-1))/2,steps:fh},Fn=Symbol.for("FluidValue.get"),qr=Symbol.for("FluidValue.observers"),tr=t=>!!(t&&t[Fn]),Ot=t=>t&&t[Fn]?t[Fn]():t,qa=t=>t[qr]||null;function dh(t,e){t.eventObserved?t.eventObserved(e):t(e)}function mi(t,e){const n=t[qr];n&&n.forEach(s=>{dh(s,e)})}var ph=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");mh(this,t)}},mh=(t,e)=>Cc(t,Fn,e);function Nn(t,e){if(t[Fn]){let n=t[qr];n||Cc(t,qr,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function Ai(t,e){const n=t[qr];if(n&&n.has(e)){const s=n.size-1;s?n.delete(e):t[qr]=null,t.observerRemoved&&t.observerRemoved(s,e)}}var Cc=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),ai=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Ah=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,$a=new RegExp(`(${ai.source})(%|[a-z]+)`,"i"),gh=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,Fi=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,yc=t=>{const[e,n]=vh(t);if(!e||Xs())return t;const s=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(s)return s.trim();if(n&&n.startsWith("--")){const i=window.getComputedStyle(document.documentElement).getPropertyValue(n);return i||t}else{if(n&&Fi.test(n))return yc(n);if(n)return n}return t},vh=t=>{const e=Fi.exec(t);if(!e)return[,];const[,n,s]=e;return[n,s]},zi,Bh=(t,e,n,s,i)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(s)}, ${i})`,bc=t=>{zi||(zi=br?new RegExp(`(${Object.keys(br).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(r=>Ot(r).replace(Fi,yc).replace(Ah,Va).replace(zi,Va)),n=e.map(r=>r.match(ai).map(Number)),i=n[0].map((r,a)=>n.map(c=>{if(!(a in c))throw Error('The arity of each "output" value must be equal');return c[a]})).map(r=>wn({...t,output:r}));return r=>{var o;const a=!$a.test(e[0])&&((o=e.find(l=>$a.test(l)))==null?void 0:o.replace(ai,""));let c=0;return e[0].replace(ai,()=>`${i[c++](r)}${a||""}`).replace(gh,Bh)}},zs="react-spring: ",Ec=t=>{const e=t;let n=!1;if(typeof e!="function")throw new TypeError(`${zs}once requires a function parameter`);return(...s)=>{n||(e(...s),n=!0)}},Ch=Ec(console.warn);function yh(){Ch(`${zs}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var bh=Ec(console.warn);function Eh(){bh(`${zs}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function Ii(t){return ce.str(t)&&(t[0]=="#"||/\d/.test(t)||!Xs()&&Fi.test(t)||t in(br||{}))}var Zs=Xs()?P.useEffect:P.useLayoutEffect,_h=()=>{const t=P.useRef(!1);return Zs(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function _c(){const t=P.useState()[1],e=_h();return()=>{e.current&&t(Math.random())}}function Mh(t,e){const[n]=P.useState(()=>({inputs:e,result:t()})),s=P.useRef(),i=s.current;let r=i;return r?r.inputs&&Th(e,r.inputs)||(r={inputs:e,result:t()}):r=n,P.useEffect(()=>{s.current=r,i==n&&(n.inputs=n.result=void 0)},[r]),r.result}function Th(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var Mc=t=>P.useEffect(t,wh),wh=[];function eo(t){const e=P.useRef();return P.useEffect(()=>{e.current=t}),e.current}var In=Symbol.for("Animated:node"),Fh=t=>!!t&&t[In]===t,er=t=>t&&t[In],qs=(t,e)=>Vf(t,In,e),Si=t=>t&&t[In]&&t[In].getPayload(),Tc=class{constructor(){qs(this,this)}getPayload(){return this.payload||[]}},Jn=class extends Tc{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,ce.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new Jn(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,e){return ce.num(t)&&(this.lastPosition=t,e&&(t=Math.round(t/e)*e,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,ce.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},Sn=class extends Jn{constructor(t){super(0),this._string=null,this._toString=wn({output:[t,t]})}static create(t){return new Sn(t)}getValue(){const t=this._string;return t??(this._string=this._toString(this._value))}setValue(t){if(ce.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=wn({output:[this.getValue(),t]})),this._value=0,super.reset()}},gi={dependencies:null},$s=class extends Tc{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return hr(this.source,(n,s)=>{Fh(n)?e[s]=n.getValue(t):tr(n)?e[s]=Ot(n):t||(e[s]=n)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&ze(this.payload,t=>t.reset())}_makePayload(t){if(t){const e=new Set;return hr(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){gi.dependencies&&tr(t)&&gi.dependencies.add(t);const e=Si(t);e&&ze(e,n=>this.add(n))}},wc=class extends $s{constructor(t){super(t)}static create(t){return new wc(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){const e=this.getPayload();return t.length==e.length?e.map((n,s)=>n.setValue(t[s])).some(Boolean):(super.setValue(t.map(Ih)),!0)}};function Ih(t){return(Ii(t)?Sn:Jn).create(t)}function ys(t){const e=er(t);return e?e.constructor:ce.arr(t)?wc:Ii(t)?Sn:Jn}var to=(t,e)=>{const n=!ce.fun(t)||t.prototype&&t.prototype.isReactComponent;return P.forwardRef((s,i)=>{const r=P.useRef(null),a=n&&P.useCallback(m=>{r.current=Rh(i,m)},[i]),[c,o]=Dh(s,e),l=_c(),u=()=>{const m=r.current;if(n&&!m)return;(m?e.applyAnimatedValues(m,c.getValue(!0)):!1)===!1&&l()},f=new Sh(u,o),h=P.useRef();Zs(()=>(h.current=f,ze(o,m=>Nn(m,f)),()=>{h.current&&(ze(h.current.deps,m=>Ai(m,h.current)),xe.cancel(h.current.update))})),P.useEffect(u,[]),Mc(()=>()=>{const m=h.current;ze(m.deps,g=>Ai(g,m))});const d=e.getComponentProps(c.getValue());return P.createElement(t,{...d,ref:a})})},Sh=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){t.type=="change"&&xe.write(this.update)}};function Dh(t,e){const n=new Set;return gi.dependencies=n,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new $s(t),gi.dependencies=null,[t,n]}function Rh(t,e){return t&&(ce.fun(t)?t(e):t.current=e),e}var ro=Symbol.for("AnimatedComponent"),xh=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=i=>new $s(i),getComponentProps:s=i=>i}={})=>{const i={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:s},r=a=>{const c=no(a)||"Anonymous";return ce.str(a)?a=r[a]||(r[a]=to(a,i)):a=a[ro]||(a[ro]=to(a,i)),a.displayName=`Animated(${c})`,a};return hr(t,(a,c)=>{ce.arr(t)&&(c=no(a)),r[c]=r(a)}),{animated:r}},no=t=>ce.str(t)?t:t&&ce.str(t.displayName)?t.displayName:ce.fun(t)&&t.name||null;function Tr(t,...e){return ce.fun(t)?t(...e):t}var bn=(t,e)=>t===!0||!!(e&&t&&(ce.fun(t)?t(e):Nt(t).includes(e))),Fc=(t,e)=>ce.obj(t)?e&&t[e]:t,Ic=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,Gh=t=>t,ea=(t,e=Gh)=>{let n=Uh;t.default&&t.default!==!0&&(t=t.default,n=Object.keys(t));const s={};for(const i of n){const r=e(t[i],i);ce.und(r)||(s[i]=r)}return s},Uh=["config","onProps","onStart","onChange","onPause","onResume","onRest"],Oh={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function kh(t){const e={};let n=0;if(hr(t,(s,i)=>{Oh[i]||(e[i]=s,n++)}),n)return e}function Sc(t){const e=kh(t);if(e){const n={to:e};return hr(t,(s,i)=>i in e||(n[i]=s)),n}return{...t}}function Dn(t){return t=Ot(t),ce.arr(t)?t.map(Dn):Ii(t)?qt.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function Lh(t){for(const e in t)return!0;return!1}function bs(t){return ce.fun(t)||ce.arr(t)&&ce.obj(t[0])}function Ph(t,e){var n;(n=t.ref)==null||n.delete(t),e==null||e.delete(t)}function Hh(t,e){var n;e&&t.ref!==e&&((n=t.ref)==null||n.delete(t),e.add(t),t.ref=e)}var Nh={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},Es={...Nh.default,mass:1,damping:1,easing:hh.linear,clamp:!1},Jh=class{constructor(){this.velocity=0,Object.assign(this,Es)}};function Kh(t,e,n){n&&(n={...n},io(n,e),e={...n,...e}),io(t,e),Object.assign(t,e);for(const a in Es)t[a]==null&&(t[a]=Es[a]);let{frequency:s,damping:i}=t;const{mass:r}=t;return ce.und(s)||(s<.01&&(s=.01),i<0&&(i=0),t.tension=Math.pow(2*Math.PI/s,2)*r,t.friction=4*Math.PI*i*r/s),t}function io(t,e){if(!ce.und(e.decay))t.duration=void 0;else{const n=!ce.und(e.tension)||!ce.und(e.friction);(n||!ce.und(e.frequency)||!ce.und(e.damping)||!ce.und(e.mass))&&(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}}var so=[],jh=class{constructor(){this.changed=!1,this.values=so,this.toValues=null,this.fromValues=so,this.config=new Jh,this.immediate=!1}};function Dc(t,{key:e,props:n,defaultProps:s,state:i,actions:r}){return new Promise((a,c)=>{let o,l,u=bn(n.cancel??(s==null?void 0:s.cancel),e);if(u)d();else{ce.und(n.pause)||(i.paused=bn(n.pause,e));let m=s==null?void 0:s.pause;m!==!0&&(m=i.paused||bn(m,e)),o=Tr(n.delay||0,e),m?(i.resumeQueue.add(h),r.pause()):(r.resume(),h())}function f(){i.resumeQueue.add(h),i.timeouts.delete(l),l.cancel(),o=l.time-xe.now()}function h(){o>0&&!qt.skipAnimation?(i.delayed=!0,l=xe.setTimeout(d,o),i.pauseQueue.add(f),i.timeouts.add(l)):d()}function d(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(f),i.timeouts.delete(l),t<=(i.cancelId||0)&&(u=!0);try{r.start({...n,callId:t,cancel:u},a)}catch(m){c(m)}}})}var ta=(t,e)=>e.length==1?e[0]:e.some(n=>n.cancelled)?Xr(t.get()):e.every(n=>n.noop)?Rc(t.get()):Xt(t.get(),e.every(n=>n.finished)),Rc=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),Xt=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),Xr=t=>({value:t,cancelled:!0,finished:!1});function xc(t,e,n,s){const{callId:i,parentId:r,onRest:a}=e,{asyncTo:c,promise:o}=n;return!r&&t===c&&!e.reset?o:n.promise=(async()=>{n.asyncId=i,n.asyncTo=t;const l=ea(e,(v,C)=>C==="onRest"?void 0:v);let u,f;const h=new Promise((v,C)=>(u=v,f=C)),d=v=>{const C=i<=(n.cancelId||0)&&Xr(s)||i!==n.asyncId&&Xt(s,!1);if(C)throw v.result=C,f(v),v},m=(v,C)=>{const B=new ao,y=new oo;return(async()=>{if(qt.skipAnimation)throw Rn(n),y.result=Xt(s,!1),f(y),y;d(B);const b=ce.obj(v)?{...v}:{...C,to:v};b.parentId=i,hr(l,(S,I)=>{ce.und(b[I])&&(b[I]=S)});const M=await s.start(b);return d(B),n.paused&&await new Promise(S=>{n.resumeQueue.add(S)}),M})()};let g;if(qt.skipAnimation)return Rn(n),Xt(s,!1);try{let v;ce.arr(t)?v=(async C=>{for(const B of C)await m(B)})(t):v=Promise.resolve(t(m,s.stop.bind(s))),await Promise.all([v.then(u),h]),g=Xt(s.get(),!0,!1)}catch(v){if(v instanceof ao)g=v.result;else if(v instanceof oo)g=v.result;else throw v}finally{i==n.asyncId&&(n.asyncId=r,n.asyncTo=r?c:void 0,n.promise=r?o:void 0)}return ce.fun(a)&&xe.batchedUpdates(()=>{a(g,s,s.item)}),g})()}function Rn(t,e){Cn(t.timeouts,n=>n.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}var ao=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},oo=class extends Error{constructor(){super("SkipAnimationSignal")}},_s=t=>t instanceof ra,Qh=1,ra=class extends ph{constructor(){super(...arguments),this.id=Qh++,this._priority=0}get priority(){return this._priority}set priority(t){this._priority!=t&&(this._priority=t,this._onPriorityChange(t))}get(){const t=er(this);return t&&t.getValue()}to(...t){return qt.to(this,t)}interpolate(...t){return yh(),qt.to(this,t)}toJSON(){return this.get()}observerAdded(t){t==1&&this._attach()}observerRemoved(t){t==0&&this._detach()}_attach(){}_detach(){}_onChange(t,e=!1){mi(this,{type:"change",parent:this,value:t,idle:e})}_onPriorityChange(t){this.idle||Ti.sort(this),mi(this,{type:"priority",parent:this,priority:t})}},Rr=Symbol.for("SpringPhase"),Gc=1,Ms=2,Ts=4,Zi=t=>(t[Rr]&Gc)>0,mr=t=>(t[Rr]&Ms)>0,cn=t=>(t[Rr]&Ts)>0,co=(t,e)=>e?t[Rr]|=Ms|Gc:t[Rr]&=~Ms,lo=(t,e)=>e?t[Rr]|=Ts:t[Rr]&=~Ts,Wh=class extends ra{constructor(t,e){if(super(),this.animation=new jh,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!ce.und(t)||!ce.und(e)){const n=ce.obj(t)?{...t}:{...e,from:t};ce.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(mr(this)||this._state.asyncTo)||cn(this)}get goal(){return Ot(this.animation.to)}get velocity(){const t=er(this);return t instanceof Jn?t.lastVelocity||0:t.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return Zi(this)}get isAnimating(){return mr(this)}get isPaused(){return cn(this)}get isDelayed(){return this._state.delayed}advance(t){let e=!0,n=!1;const s=this.animation;let{toValues:i}=s;const{config:r}=s,a=Si(s.to);!a&&tr(s.to)&&(i=Nt(Ot(s.to))),s.values.forEach((l,u)=>{if(l.done)return;const f=l.constructor==Sn?1:a?a[u].lastPosition:i[u];let h=s.immediate,d=f;if(!h){if(d=l.lastPosition,r.tension<=0){l.done=!0;return}let m=l.elapsedTime+=t;const g=s.fromValues[u],v=l.v0!=null?l.v0:l.v0=ce.arr(r.velocity)?r.velocity[u]:r.velocity;let C;const B=r.precision||(g==f?.005:Math.min(1,Math.abs(f-g)*.001));if(ce.und(r.duration))if(r.decay){const y=r.decay===!0?.998:r.decay,b=Math.exp(-(1-y)*m);d=g+v/(1-y)*(1-b),h=Math.abs(l.lastPosition-d)<=B,C=v*b}else{C=l.lastVelocity==null?v:l.lastVelocity;const y=r.restVelocity||B/10,b=r.clamp?0:r.bounce,M=!ce.und(b),S=g==f?l.v0>0:g<f;let I,E=!1;const w=1,G=Math.ceil(t/w);for(let W=0;W<G&&(I=Math.abs(C)>y,!(!I&&(h=Math.abs(f-d)<=B,h)));++W){M&&(E=d==f||d>f==S,E&&(C=-C*b,d=f));const F=-r.tension*1e-6*(d-f),O=-r.friction*.001*C,D=(F+O)/r.mass;C=C+D*w,d=d+C*w}}else{let y=1;r.duration>0&&(this._memoizedDuration!==r.duration&&(this._memoizedDuration=r.duration,l.durationProgress>0&&(l.elapsedTime=r.duration*l.durationProgress,m=l.elapsedTime+=t)),y=(r.progress||0)+m/this._memoizedDuration,y=y>1?1:y<0?0:y,l.durationProgress=y),d=g+r.easing(y)*(f-g),C=(d-l.lastPosition)/t,h=y==1}l.lastVelocity=C,Number.isNaN(d)&&(console.warn("Got NaN while animating:",this),h=!0)}a&&!a[u].done&&(h=!1),h?l.done=!0:e=!1,l.setValue(d,r.round)&&(n=!0)});const c=er(this),o=c.getValue();if(e){const l=Ot(s.to);(o!==l||n)&&!r.decay?(c.setValue(l),this._onChange(l)):n&&r.decay&&this._onChange(o),this._stop()}else n&&this._onChange(o)}set(t){return xe.batchedUpdates(()=>{this._stop(),this._focus(t),this._set(t)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(mr(this)){const{to:t,config:e}=this.animation;xe.batchedUpdates(()=>{this._onStart(),e.decay||this._set(t,!1),this._stop()})}return this}update(t){return(this.queue||(this.queue=[])).push(t),this}start(t,e){let n;return ce.und(t)?(n=this.queue||[],this.queue=[]):n=[ce.obj(t)?t:{...e,to:t}],Promise.all(n.map(s=>this._update(s))).then(s=>ta(this,s))}stop(t){const{to:e}=this.animation;return this._focus(this.get()),Rn(this._state,t&&this._lastCallId),xe.batchedUpdates(()=>this._stop(e,t)),this}reset(){this._update({reset:!0})}eventObserved(t){t.type=="change"?this._start():t.type=="priority"&&(this.priority=t.priority+1)}_prepareNode(t){const e=this.key||"";let{to:n,from:s}=t;n=ce.obj(n)?n[e]:n,(n==null||bs(n))&&(n=void 0),s=ce.obj(s)?s[e]:s,s==null&&(s=void 0);const i={to:n,from:s};return Zi(this)||(t.reverse&&([n,s]=[s,n]),s=Ot(s),ce.und(s)?er(this)||this._set(n):this._set(s)),i}_update({...t},e){const{key:n,defaultProps:s}=this;t.default&&Object.assign(s,ea(t,(a,c)=>/^on/.test(c)?Fc(a,n):a)),fo(this,t,"onProps"),un(this,"onProps",t,this);const i=this._prepareNode(t);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const r=this._state;return Dc(++this._lastCallId,{key:n,props:t,defaultProps:s,state:r,actions:{pause:()=>{cn(this)||(lo(this,!0),gn(r.pauseQueue),un(this,"onPause",Xt(this,ln(this,this.animation.to)),this))},resume:()=>{cn(this)&&(lo(this,!1),mr(this)&&this._resume(),gn(r.resumeQueue),un(this,"onResume",Xt(this,ln(this,this.animation.to)),this))},start:this._merge.bind(this,i)}}).then(a=>{if(t.loop&&a.finished&&!(e&&a.noop)){const c=Uc(t);if(c)return this._update(c,!0)}return a})}_merge(t,e,n){if(e.cancel)return this.stop(!0),n(Xr(this));const s=!ce.und(t.to),i=!ce.und(t.from);if(s||i)if(e.callId>this._lastToId)this._lastToId=e.callId;else return n(Xr(this));const{key:r,defaultProps:a,animation:c}=this,{to:o,from:l}=c;let{to:u=o,from:f=l}=t;i&&!s&&(!e.default||ce.und(u))&&(u=f),e.reverse&&([u,f]=[f,u]);const h=!ar(f,l);h&&(c.from=f),f=Ot(f);const d=!ar(u,o);d&&this._focus(u);const m=bs(e.to),{config:g}=c,{decay:v,velocity:C}=g;(s||i)&&(g.velocity=0),e.config&&!m&&Kh(g,Tr(e.config,r),e.config!==a.config?Tr(a.config,r):void 0);let B=er(this);if(!B||ce.und(u))return n(Xt(this,!0));const y=ce.und(e.reset)?i&&!e.default:!ce.und(f)&&bn(e.reset,r),b=y?f:this.get(),M=Dn(u),S=ce.num(M)||ce.arr(M)||Ii(M),I=!m&&(!S||bn(a.immediate||e.immediate,r));if(d){const W=ys(u);if(W!==B.constructor)if(I)B=this._set(M);else throw Error(`Cannot animate between ${B.constructor.name} and ${W.name}, as the "to" prop suggests`)}const E=B.constructor;let w=tr(u),G=!1;if(!w){const W=y||!Zi(this)&&h;(d||W)&&(G=ar(Dn(b),M),w=!G),(!ar(c.immediate,I)&&!I||!ar(g.decay,v)||!ar(g.velocity,C))&&(w=!0)}if(G&&mr(this)&&(c.changed&&!y?w=!0:w||this._stop(o)),!m&&((w||tr(o))&&(c.values=B.getPayload(),c.toValues=tr(u)?null:E==Sn?[1]:Nt(M)),c.immediate!=I&&(c.immediate=I,!I&&!y&&this._set(o)),w)){const{onRest:W}=c;ze(Vh,O=>fo(this,e,O));const F=Xt(this,ln(this,o));gn(this._pendingCalls,F),this._pendingCalls.add(n),c.changed&&xe.batchedUpdates(()=>{var O;c.changed=!y,W==null||W(F,this),y?Tr(a.onRest,F):(O=c.onStart)==null||O.call(c,F,this)})}y&&this._set(b),m?n(xc(e.to,e,this._state,this)):w?this._start():mr(this)&&!d?this._pendingCalls.add(n):n(Rc(b))}_focus(t){const e=this.animation;t!==e.to&&(qa(this)&&this._detach(),e.to=t,qa(this)&&this._attach())}_attach(){let t=0;const{to:e}=this.animation;tr(e)&&(Nn(e,this),_s(e)&&(t=e.priority+1)),this.priority=t}_detach(){const{to:t}=this.animation;tr(t)&&Ai(t,this)}_set(t,e=!0){const n=Ot(t);if(!ce.und(n)){const s=er(this);if(!s||!ar(n,s.getValue())){const i=ys(n);!s||s.constructor!=i?qs(this,i.create(n)):s.setValue(n),s&&xe.batchedUpdates(()=>{this._onChange(n,e)})}}return er(this)}_onStart(){const t=this.animation;t.changed||(t.changed=!0,un(this,"onStart",Xt(this,ln(this,t.to)),this))}_onChange(t,e){e||(this._onStart(),Tr(this.animation.onChange,t,this)),Tr(this.defaultProps.onChange,t,this),super._onChange(t,e)}_start(){const t=this.animation;er(this).reset(Ot(t.to)),t.immediate||(t.fromValues=t.values.map(e=>e.lastPosition)),mr(this)||(co(this,!0),cn(this)||this._resume())}_resume(){qt.skipAnimation?this.finish():Ti.start(this)}_stop(t,e){if(mr(this)){co(this,!1);const n=this.animation;ze(n.values,i=>{i.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),mi(this,{type:"idle",parent:this});const s=e?Xr(this.get()):Xt(this.get(),ln(this,t??n.to));gn(this._pendingCalls,s),n.changed&&(n.changed=!1,un(this,"onRest",s,this))}}};function ln(t,e){const n=Dn(e),s=Dn(t.get());return ar(s,n)}function Uc(t,e=t.loop,n=t.to){const s=Tr(e);if(s){const i=s!==!0&&Sc(s),r=(i||t).reverse,a=!i||i.reset;return xn({...t,loop:e,default:!1,pause:void 0,to:!r||bs(n)?n:void 0,from:a?t.from:void 0,reset:a,...i})}}function xn(t){const{to:e,from:n}=t=Sc(t),s=new Set;return ce.obj(e)&&uo(e,s),ce.obj(n)&&uo(n,s),t.keys=s.size?Array.from(s):null,t}function Xh(t){const e=xn(t);return ce.und(e.default)&&(e.default=ea(e)),e}function uo(t,e){hr(t,(n,s)=>n!=null&&e.add(s))}var Vh=["onStart","onRest","onChange","onPause","onResume"];function fo(t,e,n){t.animation[n]=e[n]!==Ic(e,n)?Fc(e[n],t.key):void 0}function un(t,e,...n){var s,i,r,a;(i=(s=t.animation)[e])==null||i.call(s,...n),(a=(r=t.defaultProps)[e])==null||a.call(r,...n)}var Yh=["onStart","onChange","onRest"],zh=1,Zh=class{constructor(t,e){this.id=zh++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),e&&(this._flush=e),t&&this.start({default:!0,...t})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(t=>t.idle&&!t.isDelayed&&!t.isPaused)}get item(){return this._item}set item(t){this._item=t}get(){const t={};return this.each((e,n)=>t[n]=e.get()),t}set(t){for(const e in t){const n=t[e];ce.und(n)||this.springs[e].set(n)}}update(t){return t&&this.queue.push(xn(t)),this}start(t){let{queue:e}=this;return t?e=Nt(t).map(xn):this.queue=[],this._flush?this._flush(this,e):(Hc(this,e),ws(this,e))}stop(t,e){if(t!==!!t&&(e=t),e){const n=this.springs;ze(Nt(e),s=>n[s].stop(!!t))}else Rn(this._state,this._lastAsyncId),this.each(n=>n.stop(!!t));return this}pause(t){if(ce.und(t))this.start({pause:!0});else{const e=this.springs;ze(Nt(t),n=>e[n].pause())}return this}resume(t){if(ce.und(t))this.start({pause:!1});else{const e=this.springs;ze(Nt(t),n=>e[n].resume())}return this}each(t){hr(this.springs,t)}_onFrame(){const{onStart:t,onChange:e,onRest:n}=this._events,s=this._active.size>0,i=this._changed.size>0;(s&&!this._started||i&&!this._started)&&(this._started=!0,Cn(t,([c,o])=>{o.value=this.get(),c(o,this,this._item)}));const r=!s&&this._started,a=i||r&&n.size?this.get():null;i&&e.size&&Cn(e,([c,o])=>{o.value=a,c(o,this,this._item)}),r&&(this._started=!1,Cn(n,([c,o])=>{o.value=a,c(o,this,this._item)}))}eventObserved(t){if(t.type=="change")this._changed.add(t.parent),t.idle||this._active.add(t.parent);else if(t.type=="idle")this._active.delete(t.parent);else return;xe.onFrame(this._onFrame)}};function ws(t,e){return Promise.all(e.map(n=>Oc(t,n))).then(n=>ta(t,n))}async function Oc(t,e,n){const{keys:s,to:i,from:r,loop:a,onRest:c,onResolve:o}=e,l=ce.obj(e.default)&&e.default;a&&(e.loop=!1),i===!1&&(e.to=null),r===!1&&(e.from=null);const u=ce.arr(i)||ce.fun(i)?i:void 0;u?(e.to=void 0,e.onRest=void 0,l&&(l.onRest=void 0)):ze(Yh,g=>{const v=e[g];if(ce.fun(v)){const C=t._events[g];e[g]=({finished:B,cancelled:y})=>{const b=C.get(v);b?(B||(b.finished=!1),y&&(b.cancelled=!0)):C.set(v,{value:null,finished:B||!1,cancelled:y||!1})},l&&(l[g]=e[g])}});const f=t._state;e.pause===!f.paused?(f.paused=e.pause,gn(e.pause?f.pauseQueue:f.resumeQueue)):f.paused&&(e.pause=!0);const h=(s||Object.keys(t.springs)).map(g=>t.springs[g].start(e)),d=e.cancel===!0||Ic(e,"cancel")===!0;(u||d&&f.asyncId)&&h.push(Dc(++t._lastAsyncId,{props:e,state:f,actions:{pause:Bs,resume:Bs,start(g,v){d?(Rn(f,t._lastAsyncId),v(Xr(t))):(g.onRest=c,v(xc(u,g,f,t)))}}})),f.paused&&await new Promise(g=>{f.resumeQueue.add(g)});const m=ta(t,await Promise.all(h));if(a&&m.finished&&!(n&&m.noop)){const g=Uc(e,a,i);if(g)return Hc(t,[g]),Oc(t,g,!0)}return o&&xe.batchedUpdates(()=>o(m,t,t.item)),m}function ho(t,e){const n={...t.springs};return e&&ze(Nt(e),s=>{ce.und(s.keys)&&(s=xn(s)),ce.obj(s.to)||(s={...s,to:void 0}),Pc(n,s,i=>Lc(i))}),kc(t,n),n}function kc(t,e){hr(e,(n,s)=>{t.springs[s]||(t.springs[s]=n,Nn(n,t))})}function Lc(t,e){const n=new Wh;return n.key=t,e&&Nn(n,e),n}function Pc(t,e,n){e.keys&&ze(e.keys,s=>{(t[s]||(t[s]=n(s)))._prepareNode(e)})}function Hc(t,e){ze(e,n=>{Pc(t.springs,n,s=>Lc(s,t))})}var Di=({children:t,...e})=>{const n=P.useContext(vi),s=e.pause||!!n.pause,i=e.immediate||!!n.immediate;e=Mh(()=>({pause:s,immediate:i}),[s,i]);const{Provider:r}=vi;return P.createElement(r,{value:e},t)},vi=qh(Di,{});Di.Provider=vi.Provider;Di.Consumer=vi.Consumer;function qh(t,e){return Object.assign(t,P.createContext(e)),t.Provider._context=t,t.Consumer._context=t,t}var $h=()=>{const t=[],e=function(s){Eh();const i=[];return ze(t,(r,a)=>{if(ce.und(s))i.push(r.start());else{const c=n(s,r,a);c&&i.push(r.start(c))}}),i};e.current=t,e.add=function(s){t.includes(s)||t.push(s)},e.delete=function(s){const i=t.indexOf(s);~i&&t.splice(i,1)},e.pause=function(){return ze(t,s=>s.pause(...arguments)),this},e.resume=function(){return ze(t,s=>s.resume(...arguments)),this},e.set=function(s){ze(t,(i,r)=>{const a=ce.fun(s)?s(r,i):s;a&&i.set(a)})},e.start=function(s){const i=[];return ze(t,(r,a)=>{if(ce.und(s))i.push(r.start());else{const c=this._getProps(s,r,a);c&&i.push(r.start(c))}}),i},e.stop=function(){return ze(t,s=>s.stop(...arguments)),this},e.update=function(s){return ze(t,(i,r)=>i.update(this._getProps(s,i,r))),this};const n=function(s,i,r){return ce.fun(s)?s(r,i):s};return e._getProps=n,e};function ed(t,e,n){const s=ce.fun(e)&&e;s&&!n&&(n=[]);const i=P.useMemo(()=>s||arguments.length==3?$h():void 0,[]),r=P.useRef(0),a=_c(),c=P.useMemo(()=>({ctrls:[],queue:[],flush(C,B){const y=ho(C,B);return r.current>0&&!c.queue.length&&!Object.keys(y).some(M=>!C.springs[M])?ws(C,B):new Promise(M=>{kc(C,y),c.queue.push(()=>{M(ws(C,B))}),a()})}}),[]),o=P.useRef([...c.ctrls]),l=[],u=eo(t)||0;P.useMemo(()=>{ze(o.current.slice(t,u),C=>{Ph(C,i),C.stop(!0)}),o.current.length=t,f(u,t)},[t]),P.useMemo(()=>{f(0,Math.min(u,t))},n);function f(C,B){for(let y=C;y<B;y++){const b=o.current[y]||(o.current[y]=new Zh(null,c.flush)),M=s?s(y,b):e[y];M&&(l[y]=Xh(M))}}const h=o.current.map((C,B)=>ho(C,l[B])),d=P.useContext(Di),m=eo(d),g=d!==m&&Lh(d);Zs(()=>{r.current++,c.ctrls=o.current;const{queue:C}=c;C.length&&(c.queue=[],ze(C,B=>B())),ze(o.current,(B,y)=>{i==null||i.add(B),g&&B.start({default:d});const b=l[y];b&&(Hh(B,b.ref),B.ref?B.queue.push(b):B.start(b))})}),Mc(()=>()=>{ze(c.ctrls,C=>C.stop(!0))});const v=h.map(C=>({...C}));return i?[v,i]:v}function td(t,e){const n=ce.fun(t),[[s],i]=ed(1,n?t:[t],n?[]:e);return n||arguments.length==2?[s,i]:s}var rd=class extends ra{constructor(t,e){super(),this.source=t,this.idle=!0,this._active=new Set,this.calc=wn(...e);const n=this._get(),s=ys(n);qs(this,s.create(n))}advance(t){const e=this._get(),n=this.get();ar(e,n)||(er(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&po(this._active)&&qi(this)}_get(){const t=ce.arr(this.source)?this.source.map(Ot):Nt(Ot(this.source));return this.calc(...t)}_start(){this.idle&&!po(this._active)&&(this.idle=!1,ze(Si(this),t=>{t.done=!1}),qt.skipAnimation?(xe.batchedUpdates(()=>this.advance()),qi(this)):Ti.start(this))}_attach(){let t=1;ze(Nt(this.source),e=>{tr(e)&&Nn(e,this),_s(e)&&(e.idle||this._active.add(e),t=Math.max(t,e.priority+1))}),this.priority=t,this._start()}_detach(){ze(Nt(this.source),t=>{tr(t)&&Ai(t,this)}),this._active.clear(),qi(this)}eventObserved(t){t.type=="change"?t.idle?this.advance():(this._active.add(t.parent),this._start()):t.type=="idle"?this._active.delete(t.parent):t.type=="priority"&&(this.priority=Nt(this.source).reduce((e,n)=>Math.max(e,(_s(n)?n.priority:0)+1),0))}};function nd(t){return t.idle!==!1}function po(t){return!t.size||Array.from(t).every(nd)}function qi(t){t.idle||(t.idle=!0,ze(Si(t),e=>{e.done=!0}),mi(t,{type:"idle",parent:t}))}qt.assign({createStringInterpolator:bc,to:(t,e)=>new rd(t,e)});var id=["primitive"].concat(Object.keys(bl).filter(t=>/^[A-Z]/.test(t)).map(t=>t[0].toLowerCase()+t.slice(1)));qt.assign({createStringInterpolator:bc,colors:$f,frameLoop:"demand"});El(()=>{xe.advance()});var sd=xh(id,{applyAnimatedValues:us}),ad=sd.animated;function od({enabled:t=!0,snap:e,global:n,domElement:s,cursor:i=!0,children:r,speed:a=1,rotation:c=[0,0,0],zoom:o=1,polar:l=[0,Math.PI/2],azimuth:u=[-1/0,1/0],config:f={mass:1,tension:170,friction:26}}){const h=Yt(S=>S.events),d=Yt(S=>S.gl),m=s||h.connected||d.domElement,{size:g}=Yt(),v=P.useMemo(()=>[c[0]+l[0],c[0]+l[1]],[c[0],l[0],l[1]]),C=P.useMemo(()=>[c[1]+u[0],c[1]+u[1]],[c[1],u[0],u[1]]),B=P.useMemo(()=>[Kr.clamp(c[0],...v),Kr.clamp(c[1],...C),c[2]],[c[0],c[1],c[2],v,C]),[y,b]=td(()=>({scale:1,rotation:B,config:f}));P.useEffect(()=>void b.start({scale:1,rotation:B,config:f}),[B]),P.useEffect(()=>{if(n&&i&&t)return m.style.cursor="grab",d.domElement.style.cursor="",()=>{m.style.cursor="default",d.domElement.style.cursor="default"}},[n,i,m,t]);const M=jf({onHover:({last:S})=>{i&&!n&&t&&(m.style.cursor=S?"auto":"grab")},onDrag:({down:S,delta:[I,E],memo:[w,G]=y.rotation.animation.to||B})=>{if(!t)return[E,I];i&&(m.style.cursor=S?"grabbing":"grab"),I=Kr.clamp(G+I/g.width*Math.PI*a,...C),E=Kr.clamp(w+E/g.height*Math.PI*a,...v);const W=e&&!S&&typeof e!="boolean"?e:f;return b.start({scale:S&&E>v[1]/2?o:1,rotation:e&&!S?B:[E,I,0],config:F=>F==="scale"?{...W,friction:W.friction*3}:W}),[E,I]}},{target:n?m:void 0});return P.createElement(ad.group,Zt({},M==null?void 0:M(),y),r)}const na=parseInt(No.replace(/\D+/g,""));function mo(t,e){if(e===_l)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===fs||e===Jo){let n=t.getIndex();if(n===null){const a=[],c=t.getAttribute("position");if(c!==void 0){for(let o=0;o<c.count;o++)a.push(o);t.setIndex(a),n=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const s=n.count-2,i=[];if(n)if(e===fs)for(let a=1;a<=s;a++)i.push(n.getX(0)),i.push(n.getX(a)),i.push(n.getX(a+1));else for(let a=0;a<s;a++)a%2===0?(i.push(n.getX(a)),i.push(n.getX(a+1)),i.push(n.getX(a+2))):(i.push(n.getX(a+2)),i.push(n.getX(a+1)),i.push(n.getX(a)));i.length/3!==s&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=t.clone();return r.setIndex(i),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}var Pt=Uint8Array,Cr=Uint16Array,Fs=Uint32Array,Nc=new Pt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Jc=new Pt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cd=new Pt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Kc=function(t,e){for(var n=new Cr(31),s=0;s<31;++s)n[s]=e+=1<<t[s-1];for(var i=new Fs(n[30]),s=1;s<30;++s)for(var r=n[s];r<n[s+1];++r)i[r]=r-n[s]<<5|s;return[n,i]},jc=Kc(Nc,2),Qc=jc[0],ld=jc[1];Qc[28]=258,ld[258]=28;var ud=Kc(Jc,0),fd=ud[0],Is=new Cr(32768);for(var at=0;at<32768;++at){var Ar=(at&43690)>>>1|(at&21845)<<1;Ar=(Ar&52428)>>>2|(Ar&13107)<<2,Ar=(Ar&61680)>>>4|(Ar&3855)<<4,Is[at]=((Ar&65280)>>>8|(Ar&255)<<8)>>>1}var En=function(t,e,n){for(var s=t.length,i=0,r=new Cr(e);i<s;++i)++r[t[i]-1];var a=new Cr(e);for(i=0;i<e;++i)a[i]=a[i-1]+r[i-1]<<1;var c;if(n){c=new Cr(1<<e);var o=15-e;for(i=0;i<s;++i)if(t[i])for(var l=i<<4|t[i],u=e-t[i],f=a[t[i]-1]++<<u,h=f|(1<<u)-1;f<=h;++f)c[Is[f]>>>o]=l}else for(c=new Cr(s),i=0;i<s;++i)t[i]&&(c[i]=Is[a[t[i]-1]++]>>>15-t[i]);return c},Kn=new Pt(288);for(var at=0;at<144;++at)Kn[at]=8;for(var at=144;at<256;++at)Kn[at]=9;for(var at=256;at<280;++at)Kn[at]=7;for(var at=280;at<288;++at)Kn[at]=8;var Wc=new Pt(32);for(var at=0;at<32;++at)Wc[at]=5;var hd=En(Kn,9,1),dd=En(Wc,5,1),$i=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},Wt=function(t,e,n){var s=e/8|0;return(t[s]|t[s+1]<<8)>>(e&7)&n},es=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},pd=function(t){return(t/8|0)+(t&7&&1)},md=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var s=new(t instanceof Cr?Cr:t instanceof Fs?Fs:Pt)(n-e);return s.set(t.subarray(e,n)),s},Ad=function(t,e,n){var s=t.length;if(!s||n&&!n.l&&s<5)return e||new Pt(0);var i=!e||n,r=!n||n.i;n||(n={}),e||(e=new Pt(s*3));var a=function(Q){var V=e.length;if(Q>V){var Y=new Pt(Math.max(V*2,Q));Y.set(e),e=Y}},c=n.f||0,o=n.p||0,l=n.b||0,u=n.l,f=n.d,h=n.m,d=n.n,m=s*8;do{if(!u){n.f=c=Wt(t,o,1);var g=Wt(t,o+1,3);if(o+=3,g)if(g==1)u=hd,f=dd,h=9,d=5;else if(g==2){var y=Wt(t,o,31)+257,b=Wt(t,o+10,15)+4,M=y+Wt(t,o+5,31)+1;o+=14;for(var S=new Pt(M),I=new Pt(19),E=0;E<b;++E)I[cd[E]]=Wt(t,o+E*3,7);o+=b*3;for(var w=$i(I),G=(1<<w)-1,W=En(I,w,1),E=0;E<M;){var F=W[Wt(t,o,G)];o+=F&15;var v=F>>>4;if(v<16)S[E++]=v;else{var O=0,D=0;for(v==16?(D=3+Wt(t,o,3),o+=2,O=S[E-1]):v==17?(D=3+Wt(t,o,7),o+=3):v==18&&(D=11+Wt(t,o,127),o+=7);D--;)S[E++]=O}}var X=S.subarray(0,y),J=S.subarray(y);h=$i(X),d=$i(J),u=En(X,h,1),f=En(J,d,1)}else throw"invalid block type";else{var v=pd(o)+4,C=t[v-4]|t[v-3]<<8,B=v+C;if(B>s){if(r)throw"unexpected EOF";break}i&&a(l+C),e.set(t.subarray(v,B),l),n.b=l+=C,n.p=o=B*8;continue}if(o>m){if(r)throw"unexpected EOF";break}}i&&a(l+131072);for(var ie=(1<<h)-1,Ae=(1<<d)-1,z=o;;z=o){var O=u[es(t,o)&ie],L=O>>>4;if(o+=O&15,o>m){if(r)throw"unexpected EOF";break}if(!O)throw"invalid length/literal";if(L<256)e[l++]=L;else if(L==256){z=o,u=null;break}else{var T=L-254;if(L>264){var E=L-257,R=Nc[E];T=Wt(t,o,(1<<R)-1)+Qc[E],o+=R}var x=f[es(t,o)&Ae],j=x>>>4;if(!x)throw"invalid distance";o+=x&15;var J=fd[j];if(j>3){var R=Jc[j];J+=es(t,o)&(1<<R)-1,o+=R}if(o>m){if(r)throw"unexpected EOF";break}i&&a(l+131072);for(var k=l+T;l<k;l+=4)e[l]=e[l-J],e[l+1]=e[l+1-J],e[l+2]=e[l+2-J],e[l+3]=e[l+3-J];l=k}}n.l=u,n.p=z,n.b=l,u&&(c=1,n.m=h,n.d=f,n.n=d)}while(!c);return l==e.length?e:md(e,0,l)},gd=new Pt(0),vd=function(t){if((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(t[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function $n(t,e){return Ad((vd(t),t.subarray(2,-4)),e)}var Bd=typeof TextDecoder<"u"&&new TextDecoder,Cd=0;try{Bd.decode(gd,{stream:!0}),Cd=1}catch{}const yd=t=>t&&t.isCubeTexture;class bd extends Gr{constructor(e,n){var s,i;const r=yd(e),c=((i=r?(s=e.image[0])==null?void 0:s.width:e.image.width)!=null?i:1024)/4,o=Math.floor(Math.log2(c)),l=Math.pow(2,o),u=3*Math.max(l,16*7),f=4*l,h=[r?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/u}`,`#define CUBEUV_TEXEL_HEIGHT ${1/f}`,`#define CUBEUV_MAX_MIP ${o}.0`],d=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,m=h.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${na>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,g={map:{value:e},height:{value:(n==null?void 0:n.height)||15},radius:{value:(n==null?void 0:n.radius)||100}},v=new Ml(1,16),C=new ks({uniforms:g,fragmentShader:m,vertexShader:d,side:bi});super(v,C)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}function Bi(t){if(typeof TextDecoder<"u")return new TextDecoder().decode(t);let e="";for(let n=0,s=t.length;n<s;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch{return e}}const Fr="srgb",fr="srgb-linear",Ao=3001,Ed=3e3;class ia extends Ls{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new Fd(n)}),this.register(function(n){return new Id(n)}),this.register(function(n){return new Ld(n)}),this.register(function(n){return new Pd(n)}),this.register(function(n){return new Hd(n)}),this.register(function(n){return new Dd(n)}),this.register(function(n){return new Rd(n)}),this.register(function(n){return new xd(n)}),this.register(function(n){return new Gd(n)}),this.register(function(n){return new wd(n)}),this.register(function(n){return new Ud(n)}),this.register(function(n){return new Sd(n)}),this.register(function(n){return new kd(n)}),this.register(function(n){return new Od(n)}),this.register(function(n){return new Md(n)}),this.register(function(n){return new Nd(n)}),this.register(function(n){return new Jd(n)})}load(e,n,s,i){const r=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const l=vn.extractUrlBase(e);a=vn.resolveURL(l,this.path)}else a=vn.extractUrlBase(e);this.manager.itemStart(e);const c=function(l){i?i(l):console.error(l),r.manager.itemError(e),r.manager.itemEnd(e)},o=new yr(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{r.parse(l,a,function(u){n(u),r.manager.itemEnd(e)},c)}catch(u){c(u)}},s,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,s,i){let r;const a={},c={};if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Bi(new Uint8Array(e.slice(0,4)))===Xc){try{a[Ne.KHR_BINARY_GLTF]=new Kd(e)}catch(u){i&&i(u);return}r=JSON.parse(a[Ne.KHR_BINARY_GLTF].content)}else r=JSON.parse(Bi(new Uint8Array(e)));else r=e;if(r.asset===void 0||r.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const o=new rp(r,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});o.fileLoader.setRequestHeader(this.requestHeader);for(let l=0;l<this.pluginCallbacks.length;l++){const u=this.pluginCallbacks[l](o);u.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[u.name]=u,a[u.name]=!0}if(r.extensionsUsed)for(let l=0;l<r.extensionsUsed.length;++l){const u=r.extensionsUsed[l],f=r.extensionsRequired||[];switch(u){case Ne.KHR_MATERIALS_UNLIT:a[u]=new Td;break;case Ne.KHR_DRACO_MESH_COMPRESSION:a[u]=new jd(r,this.dracoLoader);break;case Ne.KHR_TEXTURE_TRANSFORM:a[u]=new Qd;break;case Ne.KHR_MESH_QUANTIZATION:a[u]=new Wd;break;default:f.indexOf(u)>=0&&c[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}o.setExtensions(a),o.setPlugins(c),o.parse(s,i)}parseAsync(e,n){const s=this;return new Promise(function(i,r){s.parse(e,n,i,r)})}}function _d(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const Ne={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Md{constructor(e){this.parser=e,this.name=Ne.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let s=0,i=n.length;s<i;s++){const r=n[s];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const n=this.parser,s="light:"+e;let i=n.cache.get(s);if(i)return i;const r=n.json,o=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let l;const u=new zt(16777215);o.color!==void 0&&u.setRGB(o.color[0],o.color[1],o.color[2],fr);const f=o.range!==void 0?o.range:0;switch(o.type){case"directional":l=new Fl(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new wl(u),l.distance=f;break;case"spot":l=new Tl(u),l.distance=f,o.spot=o.spot||{},o.spot.innerConeAngle=o.spot.innerConeAngle!==void 0?o.spot.innerConeAngle:0,o.spot.outerConeAngle=o.spot.outerConeAngle!==void 0?o.spot.outerConeAngle:Math.PI/4,l.angle=o.spot.outerConeAngle,l.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return l.position.set(0,0,0),l.decay=2,or(l,o),o.intensity!==void 0&&(l.intensity=o.intensity),l.name=n.createUniqueName(o.name||"light_"+e),i=Promise.resolve(l),n.cache.add(s,i),i}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,s=this.parser,r=s.json.nodes[e],c=(r.extensions&&r.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(o){return s._getNodeRef(n.cache,c,o)})}}class Td{constructor(){this.name=Ne.KHR_MATERIALS_UNLIT}getMaterialType(){return wr}extendParams(e,n,s){const i=[];e.color=new zt(1,1,1),e.opacity=1;const r=n.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const a=r.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],fr),e.opacity=a[3]}r.baseColorTexture!==void 0&&i.push(s.assignTexture(e,"map",r.baseColorTexture,Fr))}return Promise.all(i)}}class wd{constructor(e){this.parser=e,this.name=Ne.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name].emissiveStrength;return r!==void 0&&(n.emissiveIntensity=r),Promise.resolve()}}class Fd{constructor(e){this.parser=e,this.name=Ne.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const s=this.parser.json.materials[e];return!s.extensions||!s.extensions[this.name]?null:nr}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],a=i.extensions[this.name];if(a.clearcoatFactor!==void 0&&(n.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&r.push(s.assignTexture(n,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&r.push(s.assignTexture(n,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(r.push(s.assignTexture(n,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const c=a.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new Sr(c,c)}return Promise.all(r)}}class Id{constructor(e){this.parser=e,this.name=Ne.KHR_MATERIALS_DISPERSION}getMaterialType(e){const s=this.parser.json.materials[e];return!s.extensions||!s.extensions[this.name]?null:nr}extendMaterialParams(e,n){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name];return n.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class Sd{constructor(e){this.parser=e,this.name=Ne.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const s=this.parser.json.materials[e];return!s.extensions||!s.extensions[this.name]?null:nr}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],a=i.extensions[this.name];return a.iridescenceFactor!==void 0&&(n.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&r.push(s.assignTexture(n,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(n.iridescenceIOR=a.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&r.push(s.assignTexture(n,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(r)}}class Dd{constructor(e){this.parser=e,this.name=Ne.KHR_MATERIALS_SHEEN}getMaterialType(e){const s=this.parser.json.materials[e];return!s.extensions||!s.extensions[this.name]?null:nr}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[];n.sheenColor=new zt(0,0,0),n.sheenRoughness=0,n.sheen=1;const a=i.extensions[this.name];if(a.sheenColorFactor!==void 0){const c=a.sheenColorFactor;n.sheenColor.setRGB(c[0],c[1],c[2],fr)}return a.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&r.push(s.assignTexture(n,"sheenColorMap",a.sheenColorTexture,Fr)),a.sheenRoughnessTexture!==void 0&&r.push(s.assignTexture(n,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(r)}}class Rd{constructor(e){this.parser=e,this.name=Ne.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const s=this.parser.json.materials[e];return!s.extensions||!s.extensions[this.name]?null:nr}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],a=i.extensions[this.name];return a.transmissionFactor!==void 0&&(n.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&r.push(s.assignTexture(n,"transmissionMap",a.transmissionTexture)),Promise.all(r)}}class xd{constructor(e){this.parser=e,this.name=Ne.KHR_MATERIALS_VOLUME}getMaterialType(e){const s=this.parser.json.materials[e];return!s.extensions||!s.extensions[this.name]?null:nr}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],a=i.extensions[this.name];n.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&r.push(s.assignTexture(n,"thicknessMap",a.thicknessTexture)),n.attenuationDistance=a.attenuationDistance||1/0;const c=a.attenuationColor||[1,1,1];return n.attenuationColor=new zt().setRGB(c[0],c[1],c[2],fr),Promise.all(r)}}class Gd{constructor(e){this.parser=e,this.name=Ne.KHR_MATERIALS_IOR}getMaterialType(e){const s=this.parser.json.materials[e];return!s.extensions||!s.extensions[this.name]?null:nr}extendMaterialParams(e,n){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name];return n.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class Ud{constructor(e){this.parser=e,this.name=Ne.KHR_MATERIALS_SPECULAR}getMaterialType(e){const s=this.parser.json.materials[e];return!s.extensions||!s.extensions[this.name]?null:nr}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],a=i.extensions[this.name];n.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&r.push(s.assignTexture(n,"specularIntensityMap",a.specularTexture));const c=a.specularColorFactor||[1,1,1];return n.specularColor=new zt().setRGB(c[0],c[1],c[2],fr),a.specularColorTexture!==void 0&&r.push(s.assignTexture(n,"specularColorMap",a.specularColorTexture,Fr)),Promise.all(r)}}class Od{constructor(e){this.parser=e,this.name=Ne.EXT_MATERIALS_BUMP}getMaterialType(e){const s=this.parser.json.materials[e];return!s.extensions||!s.extensions[this.name]?null:nr}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],a=i.extensions[this.name];return n.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&r.push(s.assignTexture(n,"bumpMap",a.bumpTexture)),Promise.all(r)}}class kd{constructor(e){this.parser=e,this.name=Ne.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const s=this.parser.json.materials[e];return!s.extensions||!s.extensions[this.name]?null:nr}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],a=i.extensions[this.name];return a.anisotropyStrength!==void 0&&(n.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(n.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&r.push(s.assignTexture(n,"anisotropyMap",a.anisotropyTexture)),Promise.all(r)}}class Ld{constructor(e){this.parser=e,this.name=Ne.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,s=n.json,i=s.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const r=i.extensions[this.name],a=n.options.ktx2Loader;if(!a){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,r.source,a)}}class Pd{constructor(e){this.parser=e,this.name=Ne.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,s=this.parser,i=s.json,r=i.textures[e];if(!r.extensions||!r.extensions[n])return null;const a=r.extensions[n],c=i.images[a.source];let o=s.textureLoader;if(c.uri){const l=s.options.manager.getHandler(c.uri);l!==null&&(o=l)}return this.detectSupport().then(function(l){if(l)return s.loadTextureImage(e,a.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return s.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Hd{constructor(e){this.parser=e,this.name=Ne.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,s=this.parser,i=s.json,r=i.textures[e];if(!r.extensions||!r.extensions[n])return null;const a=r.extensions[n],c=i.images[a.source];let o=s.textureLoader;if(c.uri){const l=s.options.manager.getHandler(c.uri);l!==null&&(o=l)}return this.detectSupport().then(function(l){if(l)return s.loadTextureImage(e,a.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return s.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Nd{constructor(e){this.name=Ne.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,s=n.bufferViews[e];if(s.extensions&&s.extensions[this.name]){const i=s.extensions[this.name],r=this.parser.getDependency("buffer",i.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(c){const o=i.byteOffset||0,l=i.byteLength||0,u=i.count,f=i.byteStride,h=new Uint8Array(c,o,l);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(u,f,h,i.mode,i.filter).then(function(d){return d.buffer}):a.ready.then(function(){const d=new ArrayBuffer(u*f);return a.decodeGltfBuffer(new Uint8Array(d),u,f,h,i.mode,i.filter),d})})}else return null}}class Jd{constructor(e){this.name=Ne.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,s=n.nodes[e];if(!s.extensions||!s.extensions[this.name]||s.mesh===void 0)return null;const i=n.meshes[s.mesh];for(const l of i.primitives)if(l.mode!==Ut.TRIANGLES&&l.mode!==Ut.TRIANGLE_STRIP&&l.mode!==Ut.TRIANGLE_FAN&&l.mode!==void 0)return null;const a=s.extensions[this.name].attributes,c=[],o={};for(const l in a)c.push(this.parser.getDependency("accessor",a[l]).then(u=>(o[l]=u,o[l])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(l=>{const u=l.pop(),f=u.isGroup?u.children:[u],h=l[0].count,d=[];for(const m of f){const g=new zr,v=new gt,C=new zo,B=new gt(1,1,1),y=new Il(m.geometry,m.material,h);for(let b=0;b<h;b++)o.TRANSLATION&&v.fromBufferAttribute(o.TRANSLATION,b),o.ROTATION&&C.fromBufferAttribute(o.ROTATION,b),o.SCALE&&B.fromBufferAttribute(o.SCALE,b),y.setMatrixAt(b,g.compose(v,C,B));for(const b in o)if(b==="_COLOR_0"){const M=o[b];y.instanceColor=new Ko(M.array,M.itemSize,M.normalized)}else b!=="TRANSLATION"&&b!=="ROTATION"&&b!=="SCALE"&&m.geometry.setAttribute(b,o[b]);jo.prototype.copy.call(y,m),this.parser.assignFinalMaterial(y),d.push(y)}return u.isGroup?(u.clear(),u.add(...d),u):d[0]}))}}const Xc="glTF",fn=12,go={JSON:1313821514,BIN:5130562};class Kd{constructor(e){this.name=Ne.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,fn);if(this.header={magic:Bi(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==Xc)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-fn,i=new DataView(e,fn);let r=0;for(;r<s;){const a=i.getUint32(r,!0);r+=4;const c=i.getUint32(r,!0);if(r+=4,c===go.JSON){const o=new Uint8Array(e,fn+r,a);this.content=Bi(o)}else if(c===go.BIN){const o=fn+r;this.body=e.slice(o,o+a)}r+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class jd{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ne.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const s=this.json,i=this.dracoLoader,r=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,c={},o={},l={};for(const u in a){const f=Ss[u]||u.toLowerCase();c[f]=a[u]}for(const u in e.attributes){const f=Ss[u]||u.toLowerCase();if(a[u]!==void 0){const h=s.accessors[e.attributes[u]],d=Vr[h.componentType];l[f]=d.name,o[f]=h.normalized===!0}}return n.getDependency("bufferView",r).then(function(u){return new Promise(function(f,h){i.decodeDracoFile(u,function(d){for(const m in d.attributes){const g=d.attributes[m],v=o[m];v!==void 0&&(g.normalized=v)}f(d)},c,l,fr,h)})})}}class Qd{constructor(){this.name=Ne.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class Wd{constructor(){this.name=Ne.KHR_MESH_QUANTIZATION}}class Vc extends Zl{constructor(e,n,s,i){super(e,n,s,i)}copySampleValue_(e){const n=this.resultBuffer,s=this.sampleValues,i=this.valueSize,r=e*i*3+i;for(let a=0;a!==i;a++)n[a]=s[r+a];return n}interpolate_(e,n,s,i){const r=this.resultBuffer,a=this.sampleValues,c=this.valueSize,o=c*2,l=c*3,u=i-n,f=(s-n)/u,h=f*f,d=h*f,m=e*l,g=m-l,v=-2*d+3*h,C=d-h,B=1-v,y=C-h+f;for(let b=0;b!==c;b++){const M=a[g+b+c],S=a[g+b+o]*u,I=a[m+b+c],E=a[m+b]*u;r[b]=B*M+y*S+v*I+C*E}return r}}const Xd=new zo;class Vd extends Vc{interpolate_(e,n,s,i){const r=super.interpolate_(e,n,s,i);return Xd.fromArray(r).normalize().toArray(r),r}}const Ut={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Vr={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},vo={9728:Kl,9729:Ft,9984:jl,9985:Ql,9986:Wl,9987:Qo},Bo={33071:cr,33648:Xl,10497:hs},ts={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ss={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...na>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},gr={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Yd={CUBICSPLINE:void 0,LINEAR:Yo,STEP:Vl},rs={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function zd(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new Xo({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Yl})),t.DefaultMaterial}function Er(t,e,n){for(const s in n.extensions)t[s]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[s]=n.extensions[s])}function or(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Zd(t,e,n){let s=!1,i=!1,r=!1;for(let l=0,u=e.length;l<u;l++){const f=e[l];if(f.POSITION!==void 0&&(s=!0),f.NORMAL!==void 0&&(i=!0),f.COLOR_0!==void 0&&(r=!0),s&&i&&r)break}if(!s&&!i&&!r)return Promise.resolve(t);const a=[],c=[],o=[];for(let l=0,u=e.length;l<u;l++){const f=e[l];if(s){const h=f.POSITION!==void 0?n.getDependency("accessor",f.POSITION):t.attributes.position;a.push(h)}if(i){const h=f.NORMAL!==void 0?n.getDependency("accessor",f.NORMAL):t.attributes.normal;c.push(h)}if(r){const h=f.COLOR_0!==void 0?n.getDependency("accessor",f.COLOR_0):t.attributes.color;o.push(h)}}return Promise.all([Promise.all(a),Promise.all(c),Promise.all(o)]).then(function(l){const u=l[0],f=l[1],h=l[2];return s&&(t.morphAttributes.position=u),i&&(t.morphAttributes.normal=f),r&&(t.morphAttributes.color=h),t.morphTargetsRelative=!0,t})}function qd(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let n=0,s=e.weights.length;n<s;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let s=0,i=n.length;s<i;s++)t.morphTargetDictionary[n[s]]=s}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function $d(t){let e;const n=t.extensions&&t.extensions[Ne.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+ns(n.attributes):e=t.indices+":"+ns(t.attributes)+":"+t.mode,t.targets!==void 0)for(let s=0,i=t.targets.length;s<i;s++)e+=":"+ns(t.targets[s]);return e}function ns(t){let e="";const n=Object.keys(t).sort();for(let s=0,i=n.length;s<i;s++)e+=n[s]+":"+t[n[s]]+";";return e}function Ds(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function ep(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const tp=new zr;class rp{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new _d,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let s=!1,i=!1,r=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(s=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,r=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||s||i&&r<98?this.textureLoader=new Sl(this.options.manager):this.textureLoader=new Dl(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new yr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const s=this,i=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([s.getDependencies("scene"),s.getDependencies("animation"),s.getDependencies("camera")])}).then(function(a){const c={scene:a[0][i.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:i.asset,parser:s,userData:{}};return Er(r,c,i),or(c,i),Promise.all(s._invokeAll(function(o){return o.afterRoot&&o.afterRoot(c)})).then(function(){for(const o of c.scenes)o.updateMatrixWorld();e(c)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],s=this.json.meshes||[];for(let i=0,r=n.length;i<r;i++){const a=n[i].joints;for(let c=0,o=a.length;c<o;c++)e[a[c]].isBone=!0}for(let i=0,r=e.length;i<r;i++){const a=e[i];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(s[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,s){if(e.refs[n]<=1)return s;const i=s.clone(),r=(a,c)=>{const o=this.associations.get(a);o!=null&&this.associations.set(c,o);for(const[l,u]of a.children.entries())r(u,c.children[l])};return r(s,i),i.name+="_instance_"+e.uses[n]++,i}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let s=0;s<n.length;s++){const i=e(n[s]);if(i)return i}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const s=[];for(let i=0;i<n.length;i++){const r=e(n[i]);r&&s.push(r)}return s}getDependency(e,n){const s=e+":"+n;let i=this.cache.get(s);if(!i){switch(e){case"scene":i=this.loadScene(n);break;case"node":i=this._invokeOne(function(r){return r.loadNode&&r.loadNode(n)});break;case"mesh":i=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(n)});break;case"accessor":i=this.loadAccessor(n);break;case"bufferView":i=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(n)});break;case"buffer":i=this.loadBuffer(n);break;case"material":i=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(n)});break;case"texture":i=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(n)});break;case"skin":i=this.loadSkin(n);break;case"animation":i=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(n)});break;case"camera":i=this.loadCamera(n);break;default:if(i=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,n)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(s,i)}return i}getDependencies(e){let n=this.cache.get(e);if(!n){const s=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(i.map(function(r,a){return s.getDependency(e,a)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],s=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[Ne.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(r,a){s.load(vn.resolveURL(n.uri,i.path),r,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(s){const i=n.byteLength||0,r=n.byteOffset||0;return s.slice(r,r+i)})}loadAccessor(e){const n=this,s=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const a=ts[i.type],c=Vr[i.componentType],o=i.normalized===!0,l=new c(i.count*a);return Promise.resolve(new Bn(l,a,o))}const r=[];return i.bufferView!==void 0?r.push(this.getDependency("bufferView",i.bufferView)):r.push(null),i.sparse!==void 0&&(r.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(r).then(function(a){const c=a[0],o=ts[i.type],l=Vr[i.componentType],u=l.BYTES_PER_ELEMENT,f=u*o,h=i.byteOffset||0,d=i.bufferView!==void 0?s.bufferViews[i.bufferView].byteStride:void 0,m=i.normalized===!0;let g,v;if(d&&d!==f){const C=Math.floor(h/d),B="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+C+":"+i.count;let y=n.cache.get(B);y||(g=new l(c,C*d,i.count*d/u),y=new Rl(g,d/u),n.cache.add(B,y)),v=new zl(y,o,h%d/u,m)}else c===null?g=new l(i.count*o):g=new l(c,h,i.count*o),v=new Bn(g,o,m);if(i.sparse!==void 0){const C=ts.SCALAR,B=Vr[i.sparse.indices.componentType],y=i.sparse.indices.byteOffset||0,b=i.sparse.values.byteOffset||0,M=new B(a[1],y,i.sparse.count*C),S=new l(a[2],b,i.sparse.count*o);c!==null&&(v=new Bn(v.array.slice(),v.itemSize,v.normalized));for(let I=0,E=M.length;I<E;I++){const w=M[I];if(v.setX(w,S[I*o]),o>=2&&v.setY(w,S[I*o+1]),o>=3&&v.setZ(w,S[I*o+2]),o>=4&&v.setW(w,S[I*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return v})}loadTexture(e){const n=this.json,s=this.options,r=n.textures[e].source,a=n.images[r];let c=this.textureLoader;if(a.uri){const o=s.manager.getHandler(a.uri);o!==null&&(c=o)}return this.loadTextureImage(e,r,c)}loadTextureImage(e,n,s){const i=this,r=this.json,a=r.textures[e],c=r.images[n],o=(c.uri||c.bufferView)+":"+a.sampler;if(this.textureCache[o])return this.textureCache[o];const l=this.loadImageSource(n,s).then(function(u){u.flipY=!1,u.name=a.name||c.name||"",u.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(u.name=c.uri);const h=(r.samplers||{})[a.sampler]||{};return u.magFilter=vo[h.magFilter]||Ft,u.minFilter=vo[h.minFilter]||Qo,u.wrapS=Bo[h.wrapS]||hs,u.wrapT=Bo[h.wrapT]||hs,i.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[o]=l,l}loadImageSource(e,n){const s=this,i=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const a=i.images[e],c=self.URL||self.webkitURL;let o=a.uri||"",l=!1;if(a.bufferView!==void 0)o=s.getDependency("bufferView",a.bufferView).then(function(f){l=!0;const h=new Blob([f],{type:a.mimeType});return o=c.createObjectURL(h),o});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(o).then(function(f){return new Promise(function(h,d){let m=h;n.isImageBitmapLoader===!0&&(m=function(g){const v=new lr(g);v.needsUpdate=!0,h(v)}),n.load(vn.resolveURL(f,r.path),m,void 0,d)})}).then(function(f){return l===!0&&c.revokeObjectURL(o),or(f,a),f.userData.mimeType=a.mimeType||ep(a.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),f});return this.sourceCache[e]=u,u}assignTexture(e,n,s,i){const r=this;return this.getDependency("texture",s.index).then(function(a){if(!a)return null;if(s.texCoord!==void 0&&s.texCoord>0&&(a=a.clone(),a.channel=s.texCoord),r.extensions[Ne.KHR_TEXTURE_TRANSFORM]){const c=s.extensions!==void 0?s.extensions[Ne.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const o=r.associations.get(a);a=r.extensions[Ne.KHR_TEXTURE_TRANSFORM].extendTexture(a,c),r.associations.set(a,o)}}return i!==void 0&&(typeof i=="number"&&(i=i===Ao?Fr:fr),"colorSpace"in a?a.colorSpace=i:a.encoding=i===Fr?Ao:Ed),e[n]=a,a})}assignFinalMaterial(e){const n=e.geometry;let s=e.material;const i=n.attributes.tangent===void 0,r=n.attributes.color!==void 0,a=n.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+s.uuid;let o=this.cache.get(c);o||(o=new Wo,Qi.prototype.copy.call(o,s),o.color.copy(s.color),o.map=s.map,o.sizeAttenuation=!1,this.cache.add(c,o)),s=o}else if(e.isLine){const c="LineBasicMaterial:"+s.uuid;let o=this.cache.get(c);o||(o=new xl,Qi.prototype.copy.call(o,s),o.color.copy(s.color),o.map=s.map,this.cache.add(c,o)),s=o}if(i||r||a){let c="ClonedMaterial:"+s.uuid+":";i&&(c+="derivative-tangents:"),r&&(c+="vertex-colors:"),a&&(c+="flat-shading:");let o=this.cache.get(c);o||(o=s.clone(),r&&(o.vertexColors=!0),a&&(o.flatShading=!0),i&&(o.normalScale&&(o.normalScale.y*=-1),o.clearcoatNormalScale&&(o.clearcoatNormalScale.y*=-1)),this.cache.add(c,o),this.associations.set(o,this.associations.get(s))),s=o}e.material=s}getMaterialType(){return Xo}loadMaterial(e){const n=this,s=this.json,i=this.extensions,r=s.materials[e];let a;const c={},o=r.extensions||{},l=[];if(o[Ne.KHR_MATERIALS_UNLIT]){const f=i[Ne.KHR_MATERIALS_UNLIT];a=f.getMaterialType(),l.push(f.extendParams(c,r,n))}else{const f=r.pbrMetallicRoughness||{};if(c.color=new zt(1,1,1),c.opacity=1,Array.isArray(f.baseColorFactor)){const h=f.baseColorFactor;c.color.setRGB(h[0],h[1],h[2],fr),c.opacity=h[3]}f.baseColorTexture!==void 0&&l.push(n.assignTexture(c,"map",f.baseColorTexture,Fr)),c.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,c.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(l.push(n.assignTexture(c,"metalnessMap",f.metallicRoughnessTexture)),l.push(n.assignTexture(c,"roughnessMap",f.metallicRoughnessTexture))),a=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,c)})))}r.doubleSided===!0&&(c.side=bi);const u=r.alphaMode||rs.OPAQUE;if(u===rs.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,u===rs.MASK&&(c.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&a!==wr&&(l.push(n.assignTexture(c,"normalMap",r.normalTexture)),c.normalScale=new Sr(1,1),r.normalTexture.scale!==void 0)){const f=r.normalTexture.scale;c.normalScale.set(f,f)}if(r.occlusionTexture!==void 0&&a!==wr&&(l.push(n.assignTexture(c,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&a!==wr){const f=r.emissiveFactor;c.emissive=new zt().setRGB(f[0],f[1],f[2],fr)}return r.emissiveTexture!==void 0&&a!==wr&&l.push(n.assignTexture(c,"emissiveMap",r.emissiveTexture,Fr)),Promise.all(l).then(function(){const f=new a(c);return r.name&&(f.name=r.name),or(f,r),n.associations.set(f,{materials:e}),r.extensions&&Er(i,f,r),f})}createUniqueName(e){const n=Gl.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,s=this.extensions,i=this.primitiveCache;function r(c){return s[Ne.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,n).then(function(o){return Co(o,c,n)})}const a=[];for(let c=0,o=e.length;c<o;c++){const l=e[c],u=$d(l),f=i[u];if(f)a.push(f.promise);else{let h;l.extensions&&l.extensions[Ne.KHR_DRACO_MESH_COMPRESSION]?h=r(l):h=Co(new Vo,l,n),i[u]={primitive:l,promise:h},a.push(h)}}return Promise.all(a)}loadMesh(e){const n=this,s=this.json,i=this.extensions,r=s.meshes[e],a=r.primitives,c=[];for(let o=0,l=a.length;o<l;o++){const u=a[o].material===void 0?zd(this.cache):this.getDependency("material",a[o].material);c.push(u)}return c.push(n.loadGeometries(a)),Promise.all(c).then(function(o){const l=o.slice(0,o.length-1),u=o[o.length-1],f=[];for(let d=0,m=u.length;d<m;d++){const g=u[d],v=a[d];let C;const B=l[d];if(v.mode===Ut.TRIANGLES||v.mode===Ut.TRIANGLE_STRIP||v.mode===Ut.TRIANGLE_FAN||v.mode===void 0)C=r.isSkinnedMesh===!0?new Ul(g,B):new Gr(g,B),C.isSkinnedMesh===!0&&C.normalizeSkinWeights(),v.mode===Ut.TRIANGLE_STRIP?C.geometry=mo(C.geometry,Jo):v.mode===Ut.TRIANGLE_FAN&&(C.geometry=mo(C.geometry,fs));else if(v.mode===Ut.LINES)C=new Ol(g,B);else if(v.mode===Ut.LINE_STRIP)C=new kl(g,B);else if(v.mode===Ut.LINE_LOOP)C=new Ll(g,B);else if(v.mode===Ut.POINTS)C=new Pl(g,B);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+v.mode);Object.keys(C.geometry.morphAttributes).length>0&&qd(C,r),C.name=n.createUniqueName(r.name||"mesh_"+e),or(C,r),v.extensions&&Er(i,C,v),n.assignFinalMaterial(C),f.push(C)}for(let d=0,m=f.length;d<m;d++)n.associations.set(f[d],{meshes:e,primitives:d});if(f.length===1)return r.extensions&&Er(i,f[0],r),f[0];const h=new Wi;r.extensions&&Er(i,h,r),n.associations.set(h,{meshes:e});for(let d=0,m=f.length;d<m;d++)h.add(f[d]);return h})}loadCamera(e){let n;const s=this.json.cameras[e],i=s[s.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return s.type==="perspective"?n=new Os(Kr.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):s.type==="orthographic"&&(n=new Ei(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),s.name&&(n.name=this.createUniqueName(s.name)),or(n,s),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],s=[];for(let i=0,r=n.joints.length;i<r;i++)s.push(this._loadNodeShallow(n.joints[i]));return n.inverseBindMatrices!==void 0?s.push(this.getDependency("accessor",n.inverseBindMatrices)):s.push(null),Promise.all(s).then(function(i){const r=i.pop(),a=i,c=[],o=[];for(let l=0,u=a.length;l<u;l++){const f=a[l];if(f){c.push(f);const h=new zr;r!==null&&h.fromArray(r.array,l*16),o.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[l])}return new Hl(c,o)})}loadAnimation(e){const n=this.json,s=this,i=n.animations[e],r=i.name?i.name:"animation_"+e,a=[],c=[],o=[],l=[],u=[];for(let f=0,h=i.channels.length;f<h;f++){const d=i.channels[f],m=i.samplers[d.sampler],g=d.target,v=g.node,C=i.parameters!==void 0?i.parameters[m.input]:m.input,B=i.parameters!==void 0?i.parameters[m.output]:m.output;g.node!==void 0&&(a.push(this.getDependency("node",v)),c.push(this.getDependency("accessor",C)),o.push(this.getDependency("accessor",B)),l.push(m),u.push(g))}return Promise.all([Promise.all(a),Promise.all(c),Promise.all(o),Promise.all(l),Promise.all(u)]).then(function(f){const h=f[0],d=f[1],m=f[2],g=f[3],v=f[4],C=[];for(let B=0,y=h.length;B<y;B++){const b=h[B],M=d[B],S=m[B],I=g[B],E=v[B];if(b===void 0)continue;b.updateMatrix&&b.updateMatrix();const w=s._createAnimationTracks(b,M,S,I,E);if(w)for(let G=0;G<w.length;G++)C.push(w[G])}return new Nl(r,void 0,C)})}createNodeMesh(e){const n=this.json,s=this,i=n.nodes[e];return i.mesh===void 0?null:s.getDependency("mesh",i.mesh).then(function(r){const a=s._getNodeRef(s.meshCache,i.mesh,r);return i.weights!==void 0&&a.traverse(function(c){if(c.isMesh)for(let o=0,l=i.weights.length;o<l;o++)c.morphTargetInfluences[o]=i.weights[o]}),a})}loadNode(e){const n=this.json,s=this,i=n.nodes[e],r=s._loadNodeShallow(e),a=[],c=i.children||[];for(let l=0,u=c.length;l<u;l++)a.push(s.getDependency("node",c[l]));const o=i.skin===void 0?Promise.resolve(null):s.getDependency("skin",i.skin);return Promise.all([r,Promise.all(a),o]).then(function(l){const u=l[0],f=l[1],h=l[2];h!==null&&u.traverse(function(d){d.isSkinnedMesh&&d.bind(h,tp)});for(let d=0,m=f.length;d<m;d++)u.add(f[d]);return u})}_loadNodeShallow(e){const n=this.json,s=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=n.nodes[e],a=r.name?i.createUniqueName(r.name):"",c=[],o=i._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return o&&c.push(o),r.camera!==void 0&&c.push(i.getDependency("camera",r.camera).then(function(l){return i._getNodeRef(i.cameraCache,r.camera,l)})),i._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){c.push(l)}),this.nodeCache[e]=Promise.all(c).then(function(l){let u;if(r.isBone===!0?u=new Jl:l.length>1?u=new Wi:l.length===1?u=l[0]:u=new jo,u!==l[0])for(let f=0,h=l.length;f<h;f++)u.add(l[f]);if(r.name&&(u.userData.name=r.name,u.name=a),or(u,r),r.extensions&&Er(s,u,r),r.matrix!==void 0){const f=new zr;f.fromArray(r.matrix),u.applyMatrix4(f)}else r.translation!==void 0&&u.position.fromArray(r.translation),r.rotation!==void 0&&u.quaternion.fromArray(r.rotation),r.scale!==void 0&&u.scale.fromArray(r.scale);return i.associations.has(u)||i.associations.set(u,{}),i.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const n=this.extensions,s=this.json.scenes[e],i=this,r=new Wi;s.name&&(r.name=i.createUniqueName(s.name)),or(r,s),s.extensions&&Er(n,r,s);const a=s.nodes||[],c=[];for(let o=0,l=a.length;o<l;o++)c.push(i.getDependency("node",a[o]));return Promise.all(c).then(function(o){for(let u=0,f=o.length;u<f;u++)r.add(o[u]);const l=u=>{const f=new Map;for(const[h,d]of i.associations)(h instanceof Qi||h instanceof lr)&&f.set(h,d);return u.traverse(h=>{const d=i.associations.get(h);d!=null&&f.set(h,d)}),f};return i.associations=l(r),r})}_createAnimationTracks(e,n,s,i,r){const a=[],c=e.name?e.name:e.uuid,o=[];gr[r.path]===gr.weights?e.traverse(function(h){h.morphTargetInfluences&&o.push(h.name?h.name:h.uuid)}):o.push(c);let l;switch(gr[r.path]){case gr.weights:l=Fa;break;case gr.rotation:l=Ia;break;case gr.position:case gr.scale:l=wa;break;default:switch(s.itemSize){case 1:l=Fa;break;case 2:case 3:default:l=wa;break}break}const u=i.interpolation!==void 0?Yd[i.interpolation]:Yo,f=this._getArrayFromAccessor(s);for(let h=0,d=o.length;h<d;h++){const m=new l(o[h]+"."+gr[r.path],n.array,f,u);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(m),a.push(m)}return a}_getArrayFromAccessor(e){let n=e.array;if(e.normalized){const s=Ds(n.constructor),i=new Float32Array(n.length);for(let r=0,a=n.length;r<a;r++)i[r]=n[r]*s;n=i}return n}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(s){const i=this instanceof Ia?Vd:Vc;return new i(this.times,this.values,this.getValueSize()/3,s)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function np(t,e,n){const s=e.attributes,i=new Ps;if(s.POSITION!==void 0){const c=n.json.accessors[s.POSITION],o=c.min,l=c.max;if(o!==void 0&&l!==void 0){if(i.set(new gt(o[0],o[1],o[2]),new gt(l[0],l[1],l[2])),c.normalized){const u=Ds(Vr[c.componentType]);i.min.multiplyScalar(u),i.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const c=new gt,o=new gt;for(let l=0,u=r.length;l<u;l++){const f=r[l];if(f.POSITION!==void 0){const h=n.json.accessors[f.POSITION],d=h.min,m=h.max;if(d!==void 0&&m!==void 0){if(o.setX(Math.max(Math.abs(d[0]),Math.abs(m[0]))),o.setY(Math.max(Math.abs(d[1]),Math.abs(m[1]))),o.setZ(Math.max(Math.abs(d[2]),Math.abs(m[2]))),h.normalized){const g=Ds(Vr[h.componentType]);o.multiplyScalar(g)}c.max(o)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(c)}t.boundingBox=i;const a=new Zo;i.getCenter(a.center),a.radius=i.min.distanceTo(i.max)/2,t.boundingSphere=a}function Co(t,e,n){const s=e.attributes,i=[];function r(a,c){return n.getDependency("accessor",a).then(function(o){t.setAttribute(c,o)})}for(const a in s){const c=Ss[a]||a.toLowerCase();c in t.attributes||i.push(r(s[a],c))}if(e.indices!==void 0&&!t.index){const a=n.getDependency("accessor",e.indices).then(function(c){t.setIndex(c)});i.push(a)}return or(t,e),np(t,e,n),Promise.all(i).then(function(){return e.targets!==void 0?Zd(t,e.targets,n):t})}class ip extends qo{constructor(e){super(e),this.type=Ht}parse(e){const a=function(E,w){switch(E){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(w||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(w||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(w||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(w||""))}},u=`
`,f=function(E,w,G){w=w||1024;let F=E.pos,O=-1,D=0,X="",J=String.fromCharCode.apply(null,new Uint16Array(E.subarray(F,F+128)));for(;0>(O=J.indexOf(u))&&D<w&&F<E.byteLength;)X+=J,D+=J.length,F+=128,J+=String.fromCharCode.apply(null,new Uint16Array(E.subarray(F,F+128)));return-1<O?(E.pos+=D+O+1,X+J.slice(0,O)):!1},h=function(E){const w=/^#\?(\S+)/,G=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,W=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,F=/^\s*FORMAT=(\S+)\s*$/,O=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,D={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let X,J;for((E.pos>=E.byteLength||!(X=f(E)))&&a(1,"no header found"),(J=X.match(w))||a(3,"bad initial token"),D.valid|=1,D.programtype=J[1],D.string+=X+`
`;X=f(E),X!==!1;){if(D.string+=X+`
`,X.charAt(0)==="#"){D.comments+=X+`
`;continue}if((J=X.match(G))&&(D.gamma=parseFloat(J[1])),(J=X.match(W))&&(D.exposure=parseFloat(J[1])),(J=X.match(F))&&(D.valid|=2,D.format=J[1]),(J=X.match(O))&&(D.valid|=4,D.height=parseInt(J[1],10),D.width=parseInt(J[2],10)),D.valid&2&&D.valid&4)break}return D.valid&2||a(3,"missing format specifier"),D.valid&4||a(3,"missing image size specifier"),D},d=function(E,w,G){const W=w;if(W<8||W>32767||E[0]!==2||E[1]!==2||E[2]&128)return new Uint8Array(E);W!==(E[2]<<8|E[3])&&a(3,"wrong scanline width");const F=new Uint8Array(4*w*G);F.length||a(4,"unable to allocate buffer space");let O=0,D=0;const X=4*W,J=new Uint8Array(4),ie=new Uint8Array(X);let Ae=G;for(;Ae>0&&D<E.byteLength;){D+4>E.byteLength&&a(1),J[0]=E[D++],J[1]=E[D++],J[2]=E[D++],J[3]=E[D++],(J[0]!=2||J[1]!=2||(J[2]<<8|J[3])!=W)&&a(3,"bad rgbe scanline format");let z=0,L;for(;z<X&&D<E.byteLength;){L=E[D++];const R=L>128;if(R&&(L-=128),(L===0||z+L>X)&&a(3,"bad scanline data"),R){const x=E[D++];for(let j=0;j<L;j++)ie[z++]=x}else ie.set(E.subarray(D,D+L),z),z+=L,D+=L}const T=W;for(let R=0;R<T;R++){let x=0;F[O]=ie[R+x],x+=W,F[O+1]=ie[R+x],x+=W,F[O+2]=ie[R+x],x+=W,F[O+3]=ie[R+x],O+=4}Ae--}return F},m=function(E,w,G,W){const F=E[w+3],O=Math.pow(2,F-128)/255;G[W+0]=E[w+0]*O,G[W+1]=E[w+1]*O,G[W+2]=E[w+2]*O,G[W+3]=1},g=function(E,w,G,W){const F=E[w+3],O=Math.pow(2,F-128)/255;G[W+0]=jr.toHalfFloat(Math.min(E[w+0]*O,65504)),G[W+1]=jr.toHalfFloat(Math.min(E[w+1]*O,65504)),G[W+2]=jr.toHalfFloat(Math.min(E[w+2]*O,65504)),G[W+3]=jr.toHalfFloat(1)},v=new Uint8Array(e);v.pos=0;const C=h(v),B=C.width,y=C.height,b=d(v.subarray(v.pos),B,y);let M,S,I;switch(this.type){case ur:I=b.length/4;const E=new Float32Array(I*4);for(let G=0;G<I;G++)m(b,G*4,E,G*4);M=E,S=ur;break;case Ht:I=b.length/4;const w=new Uint16Array(I*4);for(let G=0;G<I;G++)g(b,G*4,w,G*4);M=w,S=Ht;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:B,height:y,data:M,header:C.string,gamma:C.gamma,exposure:C.exposure,type:S}}setDataType(e){return this.type=e,this}load(e,n,s,i){function r(a,c){switch(a.type){case ur:case Ht:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=Ft,a.magFilter=Ft,a.generateMipmaps=!1,a.flipY=!0;break}n&&n(a,c)}return super.load(e,r,s,i)}}const hn=na>=152;class sp extends qo{constructor(e){super(e),this.type=Ht}parse(e){const w=Math.pow(2.7182818,2.2);function G(p,A){for(var _=0,U=0;U<65536;++U)(U==0||p[U>>3]&1<<(U&7))&&(A[_++]=U);for(var N=_-1;_<65536;)A[_++]=0;return N}function W(p){for(var A=0;A<16384;A++)p[A]={},p[A].len=0,p[A].lit=0,p[A].p=null}const F={l:0,c:0,lc:0};function O(p,A,_,U,N){for(;_<p;)A=A<<8|Te(U,N),_+=8;_-=p,F.l=A>>_&(1<<p)-1,F.c=A,F.lc=_}const D=new Array(59);function X(p){for(var A=0;A<=58;++A)D[A]=0;for(var A=0;A<65537;++A)D[p[A]]+=1;for(var _=0,A=58;A>0;--A){var U=_+D[A]>>1;D[A]=_,_=U}for(var A=0;A<65537;++A){var N=p[A];N>0&&(p[A]=N|D[N]++<<6)}}function J(p,A,_,U,N,K,re){for(var te=_,se=0,ae=0;N<=K;N++){if(te.value-_.value>U)return!1;O(6,se,ae,p,te);var oe=F.l;if(se=F.c,ae=F.lc,re[N]=oe,oe==63){if(te.value-_.value>U)throw"Something wrong with hufUnpackEncTable";O(8,se,ae,p,te);var H=F.l+6;if(se=F.c,ae=F.lc,N+H>K+1)throw"Something wrong with hufUnpackEncTable";for(;H--;)re[N++]=0;N--}else if(oe>=59){var H=oe-59+2;if(N+H>K+1)throw"Something wrong with hufUnpackEncTable";for(;H--;)re[N++]=0;N--}}X(re)}function ie(p){return p&63}function Ae(p){return p>>6}function z(p,A,_,U){for(;A<=_;A++){var N=Ae(p[A]),K=ie(p[A]);if(N>>K)throw"Invalid table entry";if(K>14){var re=U[N>>K-14];if(re.len)throw"Invalid table entry";if(re.lit++,re.p){var te=re.p;re.p=new Array(re.lit);for(var se=0;se<re.lit-1;++se)re.p[se]=te[se]}else re.p=new Array(1);re.p[re.lit-1]=A}else if(K)for(var ae=0,se=1<<14-K;se>0;se--){var re=U[(N<<14-K)+ae];if(re.len||re.p)throw"Invalid table entry";re.len=K,re.lit=A,ae++}}return!0}const L={c:0,lc:0};function T(p,A,_,U){p=p<<8|Te(_,U),A+=8,L.c=p,L.lc=A}const R={c:0,lc:0};function x(p,A,_,U,N,K,re,te,se,ae){if(p==A){U<8&&(T(_,U,N,re),_=L.c,U=L.lc),U-=8;var oe=_>>U,oe=new Uint8Array([oe])[0];if(se.value+oe>ae)return!1;for(var H=te[se.value-1];oe-- >0;)te[se.value++]=H}else if(se.value<ae)te[se.value++]=p;else return!1;R.c=_,R.lc=U}function j(p){return p&65535}function k(p){var A=j(p);return A>32767?A-65536:A}const Q={a:0,b:0};function V(p,A){var _=k(p),U=k(A),N=U,K=_+(N&1)+(N>>1),re=K,te=K-N;Q.a=re,Q.b=te}function Y(p,A){var _=j(p),U=j(A),N=_-(U>>1)&65535,K=U+N-32768&65535;Q.a=K,Q.b=N}function fe(p,A,_,U,N,K,re){for(var te=re<16384,se=_>N?N:_,ae=1,oe;ae<=se;)ae<<=1;for(ae>>=1,oe=ae,ae>>=1;ae>=1;){for(var H=0,qe=H+K*(N-oe),Ee=K*ae,Ce=K*oe,Ie=U*ae,ke=U*oe,Qe,We,ct,Ct;H<=qe;H+=Ce){for(var Xe=H,Rt=H+U*(_-oe);Xe<=Rt;Xe+=ke){var $e=Xe+Ie,ht=Xe+Ee,Et=ht+Ie;te?(V(p[Xe+A],p[ht+A]),Qe=Q.a,ct=Q.b,V(p[$e+A],p[Et+A]),We=Q.a,Ct=Q.b,V(Qe,We),p[Xe+A]=Q.a,p[$e+A]=Q.b,V(ct,Ct),p[ht+A]=Q.a,p[Et+A]=Q.b):(Y(p[Xe+A],p[ht+A]),Qe=Q.a,ct=Q.b,Y(p[$e+A],p[Et+A]),We=Q.a,Ct=Q.b,Y(Qe,We),p[Xe+A]=Q.a,p[$e+A]=Q.b,Y(ct,Ct),p[ht+A]=Q.a,p[Et+A]=Q.b)}if(_&ae){var ht=Xe+Ee;te?V(p[Xe+A],p[ht+A]):Y(p[Xe+A],p[ht+A]),Qe=Q.a,p[ht+A]=Q.b,p[Xe+A]=Qe}}if(N&ae)for(var Xe=H,Rt=H+U*(_-oe);Xe<=Rt;Xe+=ke){var $e=Xe+Ie;te?V(p[Xe+A],p[$e+A]):Y(p[Xe+A],p[$e+A]),Qe=Q.a,p[$e+A]=Q.b,p[Xe+A]=Qe}oe=ae,ae>>=1}return H}function le(p,A,_,U,N,K,re,te,se,ae){for(var oe=0,H=0,qe=te,Ee=Math.trunc(N.value+(K+7)/8);N.value<Ee;)for(T(oe,H,_,N),oe=L.c,H=L.lc;H>=14;){var Ce=oe>>H-14&16383,Ie=A[Ce];if(Ie.len)H-=Ie.len,x(Ie.lit,re,oe,H,_,U,N,se,ae,qe),oe=R.c,H=R.lc;else{if(!Ie.p)throw"hufDecode issues";var ke;for(ke=0;ke<Ie.lit;ke++){for(var Qe=ie(p[Ie.p[ke]]);H<Qe&&N.value<Ee;)T(oe,H,_,N),oe=L.c,H=L.lc;if(H>=Qe&&Ae(p[Ie.p[ke]])==(oe>>H-Qe&(1<<Qe)-1)){H-=Qe,x(Ie.p[ke],re,oe,H,_,U,N,se,ae,qe),oe=R.c,H=R.lc;break}}if(ke==Ie.lit)throw"hufDecode issues"}}var We=8-K&7;for(oe>>=We,H-=We;H>0;){var Ie=A[oe<<14-H&16383];if(Ie.len)H-=Ie.len,x(Ie.lit,re,oe,H,_,U,N,se,ae,qe),oe=R.c,H=R.lc;else throw"hufDecode issues"}return!0}function q(p,A,_,U,N,K){var re={value:0},te=_.value,se=Fe(A,_),ae=Fe(A,_);_.value+=4;var oe=Fe(A,_);if(_.value+=4,se<0||se>=65537||ae<0||ae>=65537)throw"Something wrong with HUF_ENCSIZE";var H=new Array(65537),qe=new Array(16384);W(qe);var Ee=U-(_.value-te);if(J(p,A,_,Ee,se,ae,H),oe>8*(U-(_.value-te)))throw"Something wrong with hufUncompress";z(H,se,ae,qe),le(H,qe,p,A,_,oe,ae,K,N,re)}function ee(p,A,_){for(var U=0;U<_;++U)A[U]=p[A[U]]}function we(p){for(var A=1;A<p.length;A++){var _=p[A-1]+p[A]-128;p[A]=_}}function _e(p,A){for(var _=0,U=Math.floor((p.length+1)/2),N=0,K=p.length-1;!(N>K||(A[N++]=p[_++],N>K));)A[N++]=p[U++]}function he(p){for(var A=p.byteLength,_=new Array,U=0,N=new DataView(p);A>0;){var K=N.getInt8(U++);if(K<0){var re=-K;A-=re+1;for(var te=0;te<re;te++)_.push(N.getUint8(U++))}else{var re=K;A-=2;for(var se=N.getUint8(U++),te=0;te<re+1;te++)_.push(se)}}return _}function Be(p,A,_,U,N,K){var $e=new DataView(K.buffer),re=_[p.idx[0]].width,te=_[p.idx[0]].height,se=3,ae=Math.floor(re/8),oe=Math.ceil(re/8),H=Math.ceil(te/8),qe=re-(oe-1)*8,Ee=te-(H-1)*8,Ce={value:0},Ie=new Array(se),ke=new Array(se),Qe=new Array(se),We=new Array(se),ct=new Array(se);for(let Ve=0;Ve<se;++Ve)ct[Ve]=A[p.idx[Ve]],Ie[Ve]=Ve<1?0:Ie[Ve-1]+oe*H,ke[Ve]=new Float32Array(64),Qe[Ve]=new Uint16Array(64),We[Ve]=new Uint16Array(oe*64);for(let Ve=0;Ve<H;++Ve){var Ct=8;Ve==H-1&&(Ct=Ee);var Xe=8;for(let rt=0;rt<oe;++rt){rt==oe-1&&(Xe=qe);for(let Le=0;Le<se;++Le)Qe[Le].fill(0),Qe[Le][0]=N[Ie[Le]++],ve(Ce,U,Qe[Le]),ne(Qe[Le],ke[Le]),ge(ke[Le]);me(ke);for(let Le=0;Le<se;++Le)$(ke[Le],We[Le],rt*64)}let dt=0;for(let rt=0;rt<se;++rt){const Le=_[p.idx[rt]].type;for(let Mt=8*Ve;Mt<8*Ve+Ct;++Mt){dt=ct[rt][Mt];for(let Gt=0;Gt<ae;++Gt){const At=Gt*64+(Mt&7)*8;$e.setUint16(dt+0*2*Le,We[rt][At+0],!0),$e.setUint16(dt+1*2*Le,We[rt][At+1],!0),$e.setUint16(dt+2*2*Le,We[rt][At+2],!0),$e.setUint16(dt+3*2*Le,We[rt][At+3],!0),$e.setUint16(dt+4*2*Le,We[rt][At+4],!0),$e.setUint16(dt+5*2*Le,We[rt][At+5],!0),$e.setUint16(dt+6*2*Le,We[rt][At+6],!0),$e.setUint16(dt+7*2*Le,We[rt][At+7],!0),dt+=8*2*Le}}if(ae!=oe)for(let Mt=8*Ve;Mt<8*Ve+Ct;++Mt){const Gt=ct[rt][Mt]+8*ae*2*Le,At=ae*64+(Mt&7)*8;for(let Kt=0;Kt<Xe;++Kt)$e.setUint16(Gt+Kt*2*Le,We[rt][At+Kt],!0)}}}for(var Rt=new Uint16Array(re),$e=new DataView(K.buffer),ht=0;ht<se;++ht){_[p.idx[ht]].decoded=!0;var Et=_[p.idx[ht]].type;if(_[ht].type==2)for(var sr=0;sr<te;++sr){const Ve=ct[ht][sr];for(var mt=0;mt<re;++mt)Rt[mt]=$e.getUint16(Ve+mt*2*Et,!0);for(var mt=0;mt<re;++mt)$e.setFloat32(Ve+mt*2*Et,Z(Rt[mt]),!0)}}}function ve(p,A,_){for(var U,N=1;N<64;)U=A[p.value],U==65280?N=64:U>>8==255?N+=U&255:(_[N]=U,N++),p.value++}function ne(p,A){A[0]=Z(p[0]),A[1]=Z(p[1]),A[2]=Z(p[5]),A[3]=Z(p[6]),A[4]=Z(p[14]),A[5]=Z(p[15]),A[6]=Z(p[27]),A[7]=Z(p[28]),A[8]=Z(p[2]),A[9]=Z(p[4]),A[10]=Z(p[7]),A[11]=Z(p[13]),A[12]=Z(p[16]),A[13]=Z(p[26]),A[14]=Z(p[29]),A[15]=Z(p[42]),A[16]=Z(p[3]),A[17]=Z(p[8]),A[18]=Z(p[12]),A[19]=Z(p[17]),A[20]=Z(p[25]),A[21]=Z(p[30]),A[22]=Z(p[41]),A[23]=Z(p[43]),A[24]=Z(p[9]),A[25]=Z(p[11]),A[26]=Z(p[18]),A[27]=Z(p[24]),A[28]=Z(p[31]),A[29]=Z(p[40]),A[30]=Z(p[44]),A[31]=Z(p[53]),A[32]=Z(p[10]),A[33]=Z(p[19]),A[34]=Z(p[23]),A[35]=Z(p[32]),A[36]=Z(p[39]),A[37]=Z(p[45]),A[38]=Z(p[52]),A[39]=Z(p[54]),A[40]=Z(p[20]),A[41]=Z(p[22]),A[42]=Z(p[33]),A[43]=Z(p[38]),A[44]=Z(p[46]),A[45]=Z(p[51]),A[46]=Z(p[55]),A[47]=Z(p[60]),A[48]=Z(p[21]),A[49]=Z(p[34]),A[50]=Z(p[37]),A[51]=Z(p[47]),A[52]=Z(p[50]),A[53]=Z(p[56]),A[54]=Z(p[59]),A[55]=Z(p[61]),A[56]=Z(p[35]),A[57]=Z(p[36]),A[58]=Z(p[48]),A[59]=Z(p[49]),A[60]=Z(p[57]),A[61]=Z(p[58]),A[62]=Z(p[62]),A[63]=Z(p[63])}function ge(p){const A=.5*Math.cos(.7853975),_=.5*Math.cos(3.14159/16),U=.5*Math.cos(3.14159/8),N=.5*Math.cos(3*3.14159/16),K=.5*Math.cos(5*3.14159/16),re=.5*Math.cos(3*3.14159/8),te=.5*Math.cos(7*3.14159/16);for(var se=new Array(4),ae=new Array(4),oe=new Array(4),H=new Array(4),qe=0;qe<8;++qe){var Ee=qe*8;se[0]=U*p[Ee+2],se[1]=re*p[Ee+2],se[2]=U*p[Ee+6],se[3]=re*p[Ee+6],ae[0]=_*p[Ee+1]+N*p[Ee+3]+K*p[Ee+5]+te*p[Ee+7],ae[1]=N*p[Ee+1]-te*p[Ee+3]-_*p[Ee+5]-K*p[Ee+7],ae[2]=K*p[Ee+1]-_*p[Ee+3]+te*p[Ee+5]+N*p[Ee+7],ae[3]=te*p[Ee+1]-K*p[Ee+3]+N*p[Ee+5]-_*p[Ee+7],oe[0]=A*(p[Ee+0]+p[Ee+4]),oe[3]=A*(p[Ee+0]-p[Ee+4]),oe[1]=se[0]+se[3],oe[2]=se[1]-se[2],H[0]=oe[0]+oe[1],H[1]=oe[3]+oe[2],H[2]=oe[3]-oe[2],H[3]=oe[0]-oe[1],p[Ee+0]=H[0]+ae[0],p[Ee+1]=H[1]+ae[1],p[Ee+2]=H[2]+ae[2],p[Ee+3]=H[3]+ae[3],p[Ee+4]=H[3]-ae[3],p[Ee+5]=H[2]-ae[2],p[Ee+6]=H[1]-ae[1],p[Ee+7]=H[0]-ae[0]}for(var Ce=0;Ce<8;++Ce)se[0]=U*p[16+Ce],se[1]=re*p[16+Ce],se[2]=U*p[48+Ce],se[3]=re*p[48+Ce],ae[0]=_*p[8+Ce]+N*p[24+Ce]+K*p[40+Ce]+te*p[56+Ce],ae[1]=N*p[8+Ce]-te*p[24+Ce]-_*p[40+Ce]-K*p[56+Ce],ae[2]=K*p[8+Ce]-_*p[24+Ce]+te*p[40+Ce]+N*p[56+Ce],ae[3]=te*p[8+Ce]-K*p[24+Ce]+N*p[40+Ce]-_*p[56+Ce],oe[0]=A*(p[Ce]+p[32+Ce]),oe[3]=A*(p[Ce]-p[32+Ce]),oe[1]=se[0]+se[3],oe[2]=se[1]-se[2],H[0]=oe[0]+oe[1],H[1]=oe[3]+oe[2],H[2]=oe[3]-oe[2],H[3]=oe[0]-oe[1],p[0+Ce]=H[0]+ae[0],p[8+Ce]=H[1]+ae[1],p[16+Ce]=H[2]+ae[2],p[24+Ce]=H[3]+ae[3],p[32+Ce]=H[3]-ae[3],p[40+Ce]=H[2]-ae[2],p[48+Ce]=H[1]-ae[1],p[56+Ce]=H[0]-ae[0]}function me(p){for(var A=0;A<64;++A){var _=p[0][A],U=p[1][A],N=p[2][A];p[0][A]=_+1.5747*N,p[1][A]=_-.1873*U-.4682*N,p[2][A]=_+1.8556*U}}function $(p,A,_){for(var U=0;U<64;++U)A[_+U]=jr.toHalfFloat(Se(p[U]))}function Se(p){return p<=1?Math.sign(p)*Math.pow(Math.abs(p),2.2):Math.sign(p)*Math.pow(w,Math.abs(p)-1)}function de(p){return new DataView(p.array.buffer,p.offset.value,p.size)}function ye(p){var A=p.viewer.buffer.slice(p.offset.value,p.offset.value+p.size),_=new Uint8Array(he(A)),U=new Uint8Array(_.length);return we(_),_e(_,U),new DataView(U.buffer)}function ue(p){var A=p.array.slice(p.offset.value,p.offset.value+p.size),_=$n(A),U=new Uint8Array(_.length);return we(_),_e(_,U),new DataView(U.buffer)}function Ke(p){for(var A=p.viewer,_={value:p.offset.value},U=new Uint16Array(p.width*p.scanlineBlockSize*(p.channels*p.type)),N=new Uint8Array(8192),K=0,re=new Array(p.channels),te=0;te<p.channels;te++)re[te]={},re[te].start=K,re[te].end=re[te].start,re[te].nx=p.width,re[te].ny=p.lines,re[te].size=p.type,K+=re[te].nx*re[te].ny*re[te].size;var se=Je(A,_),ae=Je(A,_);if(ae>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(se<=ae)for(var te=0;te<ae-se+1;te++)N[te+se]=Ze(A,_);var oe=new Uint16Array(65536),H=G(N,oe),qe=Fe(A,_);q(p.array,A,_,qe,U,K);for(var te=0;te<p.channels;++te)for(var Ee=re[te],Ce=0;Ce<re[te].size;++Ce)fe(U,Ee.start+Ce,Ee.nx,Ee.size,Ee.ny,Ee.nx*Ee.size,H);ee(oe,U,K);for(var Ie=0,ke=new Uint8Array(U.buffer.byteLength),Qe=0;Qe<p.lines;Qe++)for(var We=0;We<p.channels;We++){var Ee=re[We],ct=Ee.nx*Ee.size,Ct=new Uint8Array(U.buffer,Ee.end*2,ct*2);ke.set(Ct,Ie),Ie+=ct*2,Ee.end+=ct}return new DataView(ke.buffer)}function pe(p){var A=p.array.slice(p.offset.value,p.offset.value+p.size),_=$n(A);const U=p.lines*p.channels*p.width,N=p.type==1?new Uint16Array(U):new Uint32Array(U);let K=0,re=0;const te=new Array(4);for(let se=0;se<p.lines;se++)for(let ae=0;ae<p.channels;ae++){let oe=0;switch(p.type){case 1:te[0]=K,te[1]=te[0]+p.width,K=te[1]+p.width;for(let H=0;H<p.width;++H){const qe=_[te[0]++]<<8|_[te[1]++];oe+=qe,N[re]=oe,re++}break;case 2:te[0]=K,te[1]=te[0]+p.width,te[2]=te[1]+p.width,K=te[2]+p.width;for(let H=0;H<p.width;++H){const qe=_[te[0]++]<<24|_[te[1]++]<<16|_[te[2]++]<<8;oe+=qe,N[re]=oe,re++}break}}return new DataView(N.buffer)}function be(p){var A=p.viewer,_={value:p.offset.value},U=new Uint8Array(p.width*p.lines*(p.channels*p.type*2)),N={version:He(A,_),unknownUncompressedSize:He(A,_),unknownCompressedSize:He(A,_),acCompressedSize:He(A,_),dcCompressedSize:He(A,_),rleCompressedSize:He(A,_),rleUncompressedSize:He(A,_),rleRawSize:He(A,_),totalAcUncompressedCount:He(A,_),totalDcUncompressedCount:He(A,_),acCompression:He(A,_)};if(N.version<2)throw"EXRLoader.parse: "+Dt.compression+" version "+N.version+" is unsupported";for(var K=new Array,re=Je(A,_)-2;re>0;){var te=Me(A.buffer,_),se=Ze(A,_),ae=se>>2&3,oe=(se>>4)-1,H=new Int8Array([oe])[0],qe=Ze(A,_);K.push({name:te,index:H,type:qe,compression:ae}),re-=te.length+3}for(var Ee=Dt.channels,Ce=new Array(p.channels),Ie=0;Ie<p.channels;++Ie){var ke=Ce[Ie]={},Qe=Ee[Ie];ke.name=Qe.name,ke.compression=0,ke.decoded=!1,ke.type=Qe.pixelType,ke.pLinear=Qe.pLinear,ke.width=p.width,ke.height=p.lines}for(var We={idx:new Array(3)},ct=0;ct<p.channels;++ct)for(var ke=Ce[ct],Ie=0;Ie<K.length;++Ie){var Ct=K[Ie];ke.name==Ct.name&&(ke.compression=Ct.compression,Ct.index>=0&&(We.idx[Ct.index]=ct),ke.offset=ct)}if(N.acCompressedSize>0)switch(N.acCompression){case 0:var $e=new Uint16Array(N.totalAcUncompressedCount);q(p.array,A,_,N.acCompressedSize,$e,N.totalAcUncompressedCount);break;case 1:var Xe=p.array.slice(_.value,_.value+N.totalAcUncompressedCount),Rt=$n(Xe),$e=new Uint16Array(Rt.buffer);_.value+=N.totalAcUncompressedCount;break}if(N.dcCompressedSize>0){var ht={array:p.array,offset:_,size:N.dcCompressedSize},Et=new Uint16Array(ue(ht).buffer);_.value+=N.dcCompressedSize}if(N.rleRawSize>0){var Xe=p.array.slice(_.value,_.value+N.rleCompressedSize),Rt=$n(Xe),sr=he(Rt.buffer);_.value+=N.rleCompressedSize}for(var mt=0,Ve=new Array(Ce.length),Ie=0;Ie<Ve.length;++Ie)Ve[Ie]=new Array;for(var dt=0;dt<p.lines;++dt)for(var rt=0;rt<Ce.length;++rt)Ve[rt].push(mt),mt+=Ce[rt].width*p.type*2;Be(We,Ve,Ce,$e,Et,U);for(var Ie=0;Ie<Ce.length;++Ie){var ke=Ce[Ie];if(!ke.decoded)switch(ke.compression){case 2:for(var Le=0,Mt=0,dt=0;dt<p.lines;++dt){for(var Gt=Ve[Ie][Le],At=0;At<ke.width;++At){for(var Kt=0;Kt<2*ke.type;++Kt)U[Gt++]=sr[Mt+Kt*ke.width*ke.height];Mt++}Le++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(U.buffer)}function Me(p,A){for(var _=new Uint8Array(p),U=0;_[A.value+U]!=0;)U+=1;var N=new TextDecoder().decode(_.slice(A.value,A.value+U));return A.value=A.value+U+1,N}function Ge(p,A,_){var U=new TextDecoder().decode(new Uint8Array(p).slice(A.value,A.value+_));return A.value=A.value+_,U}function et(p,A){var _=Ue(p,A),U=Fe(p,A);return[_,U]}function st(p,A){var _=Fe(p,A),U=Fe(p,A);return[_,U]}function Ue(p,A){var _=p.getInt32(A.value,!0);return A.value=A.value+4,_}function Fe(p,A){var _=p.getUint32(A.value,!0);return A.value=A.value+4,_}function Te(p,A){var _=p[A.value];return A.value=A.value+1,_}function Ze(p,A){var _=p.getUint8(A.value);return A.value=A.value+1,_}const He=function(p,A){let _;return"getBigInt64"in DataView.prototype?_=Number(p.getBigInt64(A.value,!0)):_=p.getUint32(A.value+4,!0)+Number(p.getUint32(A.value,!0)<<32),A.value+=8,_};function je(p,A){var _=p.getFloat32(A.value,!0);return A.value+=4,_}function tt(p,A){return jr.toHalfFloat(je(p,A))}function Z(p){var A=(p&31744)>>10,_=p&1023;return(p>>15?-1:1)*(A?A===31?_?NaN:1/0:Math.pow(2,A-15)*(1+_/1024):6103515625e-14*(_/1024))}function Je(p,A){var _=p.getUint16(A.value,!0);return A.value+=2,_}function $t(p,A){return Z(Je(p,A))}function Ye(p,A,_,U){for(var N=_.value,K=[];_.value<N+U-1;){var re=Me(A,_),te=Ue(p,_),se=Ze(p,_);_.value+=3;var ae=Ue(p,_),oe=Ue(p,_);K.push({name:re,pixelType:te,pLinear:se,xSampling:ae,ySampling:oe})}return _.value+=1,K}function Pe(p,A){var _=je(p,A),U=je(p,A),N=je(p,A),K=je(p,A),re=je(p,A),te=je(p,A),se=je(p,A),ae=je(p,A);return{redX:_,redY:U,greenX:N,greenY:K,blueX:re,blueY:te,whiteX:se,whiteY:ae}}function ut(p,A){var _=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],U=Ze(p,A);return _[U]}function nt(p,A){var _=Fe(p,A),U=Fe(p,A),N=Fe(p,A),K=Fe(p,A);return{xMin:_,yMin:U,xMax:N,yMax:K}}function Oe(p,A){var _=["INCREASING_Y"],U=Ze(p,A);return _[U]}function it(p,A){var _=je(p,A),U=je(p,A);return[_,U]}function yt(p,A){var _=je(p,A),U=je(p,A),N=je(p,A);return[_,U,N]}function vt(p,A,_,U,N){if(U==="string"||U==="stringvector"||U==="iccProfile")return Ge(A,_,N);if(U==="chlist")return Ye(p,A,_,N);if(U==="chromaticities")return Pe(p,_);if(U==="compression")return ut(p,_);if(U==="box2i")return nt(p,_);if(U==="lineOrder")return Oe(p,_);if(U==="float")return je(p,_);if(U==="v2f")return it(p,_);if(U==="v3f")return yt(p,_);if(U==="int")return Ue(p,_);if(U==="rational")return et(p,_);if(U==="timecode")return st(p,_);if(U==="preview")return _.value+=N,"skipped";_.value+=N}function ft(p,A,_){const U={};if(p.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";U.version=p.getUint8(4);const N=p.getUint8(5);U.spec={singleTile:!!(N&2),longName:!!(N&4),deepFormat:!!(N&8),multiPart:!!(N&16)},_.value=8;for(var K=!0;K;){var re=Me(A,_);if(re==0)K=!1;else{var te=Me(A,_),se=Fe(p,_),ae=vt(p,A,_,te,se);ae===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${te}'.`):U[re]=ae}}if(N&-5)throw console.error("EXRHeader:",U),"THREE.EXRLoader: provided file is currently unsupported.";return U}function It(p,A,_,U,N){const K={size:0,viewer:A,array:_,offset:U,width:p.dataWindow.xMax-p.dataWindow.xMin+1,height:p.dataWindow.yMax-p.dataWindow.yMin+1,channels:p.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:p.channels[0].pixelType,uncompress:null,getter:null,format:null,[hn?"colorSpace":"encoding"]:null};switch(p.compression){case"NO_COMPRESSION":K.lines=1,K.uncompress=de;break;case"RLE_COMPRESSION":K.lines=1,K.uncompress=ye;break;case"ZIPS_COMPRESSION":K.lines=1,K.uncompress=ue;break;case"ZIP_COMPRESSION":K.lines=16,K.uncompress=ue;break;case"PIZ_COMPRESSION":K.lines=32,K.uncompress=Ke;break;case"PXR24_COMPRESSION":K.lines=16,K.uncompress=pe;break;case"DWAA_COMPRESSION":K.lines=32,K.uncompress=be;break;case"DWAB_COMPRESSION":K.lines=256,K.uncompress=be;break;default:throw"EXRLoader.parse: "+p.compression+" is unsupported"}if(K.scanlineBlockSize=K.lines,K.type==1)switch(N){case ur:K.getter=$t,K.inputSize=2;break;case Ht:K.getter=Je,K.inputSize=2;break}else if(K.type==2)switch(N){case ur:K.getter=je,K.inputSize=4;break;case Ht:K.getter=tt,K.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+K.type+" for "+p.compression+".";K.blockCount=(p.dataWindow.yMax+1)/K.scanlineBlockSize;for(var re=0;re<K.blockCount;re++)He(A,U);K.outputChannels=K.channels==3?4:K.channels;const te=K.width*K.height*K.outputChannels;switch(N){case ur:K.byteArray=new Float32Array(te),K.channels<K.outputChannels&&K.byteArray.fill(1,0,te);break;case Ht:K.byteArray=new Uint16Array(te),K.channels<K.outputChannels&&K.byteArray.fill(15360,0,te);break;default:console.error("THREE.EXRLoader: unsupported type: ",N);break}return K.bytesPerLine=K.width*K.inputSize*K.channels,K.outputChannels==4?K.format=Tn:K.format=ql,hn?K.colorSpace="srgb-linear":K.encoding=3e3,K}const St=new DataView(e),Jt=new Uint8Array(e),_t={value:0},Dt=ft(St,e,_t),Re=It(Dt,St,Jt,_t,this.type),Bt={value:0},ir={R:0,G:1,B:2,A:3,Y:0};for(let p=0;p<Re.height/Re.scanlineBlockSize;p++){const A=Fe(St,_t);Re.size=Fe(St,_t),Re.lines=A+Re.scanlineBlockSize>Re.height?Re.height-A:Re.scanlineBlockSize;const U=Re.size<Re.lines*Re.bytesPerLine?Re.uncompress(Re):de(Re);_t.value+=Re.size;for(let N=0;N<Re.scanlineBlockSize;N++){const K=N+p*Re.scanlineBlockSize;if(K>=Re.height)break;for(let re=0;re<Re.channels;re++){const te=ir[Dt.channels[re].name];for(let se=0;se<Re.width;se++){Bt.value=(N*(Re.channels*Re.width)+re*Re.width+se)*Re.inputSize;const ae=(Re.height-1-K)*(Re.width*Re.outputChannels)+se*Re.outputChannels+te;Re.byteArray[ae]=Re.getter(U,Bt)}}}}return{header:Dt,width:Re.width,height:Re.height,data:Re.byteArray,format:Re.format,[hn?"colorSpace":"encoding"]:Re[hn?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,n,s,i){function r(a,c){hn?a.colorSpace=c.colorSpace:a.encoding=c.encoding,a.minFilter=Ft,a.magFilter=Ft,a.generateMipmaps=!1,a.flipY=!1,n&&n(a,c)}return super.load(e,r,s,i)}}const is=new WeakMap;class ap extends Ls{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,n,s,i){const r=new yr(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,a=>{const c={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(a,c).then(n).catch(i)},s,i)}decodeDracoFile(e,n,s,i){const r={attributeIDs:s||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!s};this.decodeGeometry(e,r).then(n)}decodeGeometry(e,n){for(const o in n.attributeTypes){const l=n.attributeTypes[o];l.BYTES_PER_ELEMENT!==void 0&&(n.attributeTypes[o]=l.name)}const s=JSON.stringify(n);if(is.has(e)){const o=is.get(e);if(o.key===s)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const r=this.workerNextTaskID++,a=e.byteLength,c=this._getWorker(r,a).then(o=>(i=o,new Promise((l,u)=>{i._callbacks[r]={resolve:l,reject:u},i.postMessage({type:"decode",id:r,taskConfig:n,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return c.catch(()=>!0).then(()=>{i&&r&&this._releaseTask(i,r)}),is.set(e,{key:s,promise:c}),c}_createGeometry(e){const n=new Vo;e.index&&n.setIndex(new Bn(e.index.array,1));for(let s=0;s<e.attributes.length;s++){const i=e.attributes[s],r=i.name,a=i.array,c=i.itemSize;n.setAttribute(r,new Bn(a,c))}return n}_loadLibrary(e,n){const s=new yr(this.manager);return s.setPath(this.decoderPath),s.setResponseType(n),s.setWithCredentials(this.withCredentials),new Promise((i,r)=>{s.load(e,i,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(s=>{const i=s[0];e||(this.decoderConfig.wasmBinary=s[1]);const r=op.toString(),a=["/* draco decoder */",i,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(r){const a=r.data;switch(a.type){case"decode":i._callbacks[a.id].resolve(a);break;case"error":i._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,r){return i._taskLoad>r._taskLoad?-1:1});const s=this.workerPool[this.workerPool.length-1];return s._taskCosts[e]=n,s._taskLoad+=n,s})}_releaseTask(e,n){e._taskLoad-=e._taskCosts[n],delete e._callbacks[n],delete e._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function op(){let t,e;onmessage=function(a){const c=a.data;switch(c.type){case"init":t=c.decoderConfig,e=new Promise(function(u){t.onModuleLoaded=function(f){u({draco:f})},DracoDecoderModule(t)});break;case"decode":const o=c.buffer,l=c.taskConfig;e.then(u=>{const f=u.draco,h=new f.Decoder,d=new f.DecoderBuffer;d.Init(new Int8Array(o),o.byteLength);try{const m=n(f,h,d,l),g=m.attributes.map(v=>v.array.buffer);m.index&&g.push(m.index.array.buffer),self.postMessage({type:"decode",id:c.id,geometry:m},g)}catch(m){console.error(m),self.postMessage({type:"error",id:c.id,error:m.message})}finally{f.destroy(d),f.destroy(h)}});break}};function n(a,c,o,l){const u=l.attributeIDs,f=l.attributeTypes;let h,d;const m=c.GetEncodedGeometryType(o);if(m===a.TRIANGULAR_MESH)h=new a.Mesh,d=c.DecodeBufferToMesh(o,h);else if(m===a.POINT_CLOUD)h=new a.PointCloud,d=c.DecodeBufferToPointCloud(o,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!d.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+d.error_msg());const g={index:null,attributes:[]};for(const v in u){const C=self[f[v]];let B,y;if(l.useUniqueIDs)y=u[v],B=c.GetAttributeByUniqueId(h,y);else{if(y=c.GetAttributeId(h,a[u[v]]),y===-1)continue;B=c.GetAttribute(h,y)}g.attributes.push(i(a,c,h,v,C,B))}return m===a.TRIANGULAR_MESH&&(g.index=s(a,c,h)),a.destroy(h),g}function s(a,c,o){const u=o.num_faces()*3,f=u*4,h=a._malloc(f);c.GetTrianglesUInt32Array(o,f,h);const d=new Uint32Array(a.HEAPF32.buffer,h,u).slice();return a._free(h),{array:d,itemSize:1}}function i(a,c,o,l,u,f){const h=f.num_components(),m=o.num_points()*h,g=m*u.BYTES_PER_ELEMENT,v=r(a,u),C=a._malloc(g);c.GetAttributeDataArrayForAllPoints(o,f,v,g,C);const B=new u(a.HEAPF32.buffer,C,m).slice();return a._free(C),{name:l,array:B,itemSize:h}}function r(a,c){switch(c){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}let ei;const ss=()=>{if(ei)return ei;const t="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",e="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",n=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),s=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let i=t;WebAssembly.validate(n)&&(i=e);let r;const a=WebAssembly.instantiate(c(i),{}).then(f=>{r=f.instance,r.exports.__wasm_call_ctors()});function c(f){const h=new Uint8Array(f.length);for(let m=0;m<f.length;++m){const g=f.charCodeAt(m);h[m]=g>96?g-71:g>64?g-65:g>47?g+4:g>46?63:62}let d=0;for(let m=0;m<f.length;++m)h[d++]=h[m]<60?s[h[m]]:(h[m]-60)*64+h[++m];return h.buffer.slice(0,d)}function o(f,h,d,m,g,v){const C=r.exports.sbrk,B=d+3&-4,y=C(B*m),b=C(g.length),M=new Uint8Array(r.exports.memory.buffer);M.set(g,b);const S=f(y,d,m,b,g.length);if(S===0&&v&&v(y,B,m),h.set(M.subarray(y,y+d*m)),C(y-C(0)),S!==0)throw new Error(`Malformed buffer data: ${S}`)}const l={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},u={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return ei={ready:a,supported:!0,decodeVertexBuffer(f,h,d,m,g){o(r.exports.meshopt_decodeVertexBuffer,f,h,d,m,r.exports[l[g]])},decodeIndexBuffer(f,h,d,m){o(r.exports.meshopt_decodeIndexBuffer,f,h,d,m)},decodeIndexSequence(f,h,d,m){o(r.exports.meshopt_decodeIndexSequence,f,h,d,m)},decodeGltfBuffer(f,h,d,m,g,v){o(r.exports[u[g]],f,h,d,m,r.exports[l[v]])}},ei};function cp(){var t=Object.create(null);function e(i,r){var a=i.id,c=i.name,o=i.dependencies;o===void 0&&(o=[]);var l=i.init;l===void 0&&(l=function(){});var u=i.getTransferables;if(u===void 0&&(u=null),!t[a])try{o=o.map(function(h){return h&&h.isWorkerModule&&(e(h,function(d){if(d instanceof Error)throw d}),h=t[h.id].value),h}),l=s("<"+c+">.init",l),u&&(u=s("<"+c+">.getTransferables",u));var f=null;typeof l=="function"?f=l.apply(void 0,o):console.error("worker module init function failed to rehydrate"),t[a]={id:a,value:f,getTransferables:u},r(f)}catch(h){h&&h.noLog||console.error(h),r(h)}}function n(i,r){var a,c=i.id,o=i.args;(!t[c]||typeof t[c].value!="function")&&r(new Error("Worker module "+c+": not found or its 'init' did not return a function"));try{var l=(a=t[c]).value.apply(a,o);l&&typeof l.then=="function"?l.then(u,function(f){return r(f instanceof Error?f:new Error(""+f))}):u(l)}catch(f){r(f)}function u(f){try{var h=t[c].getTransferables&&t[c].getTransferables(f);(!h||!Array.isArray(h)||!h.length)&&(h=void 0),r(f,h)}catch(d){console.error(d),r(d)}}}function s(i,r){var a=void 0;self.troikaDefine=function(o){return a=o};var c=URL.createObjectURL(new Blob(["/** "+i.replace(/\*/g,"")+` **/

troikaDefine(
`+r+`
)`],{type:"application/javascript"}));try{importScripts(c)}catch(o){console.error(o)}return URL.revokeObjectURL(c),delete self.troikaDefine,a}self.addEventListener("message",function(i){var r=i.data,a=r.messageId,c=r.action,o=r.data;try{c==="registerModule"&&e(o,function(l){l instanceof Error?postMessage({messageId:a,success:!1,error:l.message}):postMessage({messageId:a,success:!0,result:{isCallable:typeof l=="function"}})}),c==="callModule"&&n(o,function(l,u){l instanceof Error?postMessage({messageId:a,success:!1,error:l.message}):postMessage({messageId:a,success:!0,result:l},u||void 0)})}catch(l){postMessage({messageId:a,success:!1,error:l.stack})}})}function lp(t){var e=function(){for(var n=[],s=arguments.length;s--;)n[s]=arguments[s];return e._getInitResult().then(function(i){if(typeof i=="function")return i.apply(void 0,n);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var n=t.dependencies,s=t.init;n=Array.isArray(n)?n.map(function(r){return r&&(r=r.onMainThread||r,r._getInitResult&&(r=r._getInitResult())),r}):[];var i=Promise.all(n).then(function(r){return s.apply(null,r)});return e._getInitResult=function(){return i},i},e}var Yc=function(){var t=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),t=!0}catch(n){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+n.message+"]")}return Yc=function(){return t},t},up=0,fp=0,as=!1,_n=Object.create(null),Mn=Object.create(null),Rs=Object.create(null);function $r(t){if((!t||typeof t.init!="function")&&!as)throw new Error("requires `options.init` function");var e=t.dependencies,n=t.init,s=t.getTransferables,i=t.workerId,r=lp(t);i==null&&(i="#default");var a="workerModule"+ ++up,c=t.name||a,o=null;e=e&&e.map(function(u){return typeof u=="function"&&!u.workerModuleData&&(as=!0,u=$r({workerId:i,name:"<"+c+"> function dependency: "+u.name,init:`function(){return (
`+oi(u)+`
)}`}),as=!1),u&&u.workerModuleData&&(u=u.workerModuleData),u});function l(){for(var u=[],f=arguments.length;f--;)u[f]=arguments[f];if(!Yc())return r.apply(void 0,u);if(!o){o=yo(i,"registerModule",l.workerModuleData);var h=function(){o=null,Mn[i].delete(h)};(Mn[i]||(Mn[i]=new Set)).add(h)}return o.then(function(d){var m=d.isCallable;if(m)return yo(i,"callModule",{id:a,args:u});throw new Error("Worker module function was called but `init` did not return a callable function")})}return l.workerModuleData={isWorkerModule:!0,id:a,name:c,dependencies:e,init:oi(n),getTransferables:s&&oi(s)},l.onMainThread=r,l}function hp(t){Mn[t]&&Mn[t].forEach(function(e){e()}),_n[t]&&(_n[t].terminate(),delete _n[t])}function oi(t){var e=t.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function dp(t){var e=_n[t];if(!e){var n=oi(cp);e=_n[t]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+t.replace(/\*/g,"")+` **/

;(`+n+")()"],{type:"application/javascript"}))),e.onmessage=function(s){var i=s.data,r=i.messageId,a=Rs[r];if(!a)throw new Error("WorkerModule response with empty or unknown messageId");delete Rs[r],a(i)}}return e}function yo(t,e,n){return new Promise(function(s,i){var r=++fp;Rs[r]=function(a){a.success?s(a.result):i(new Error("Error in worker "+e+" call: "+a.error))},dp(t).postMessage({messageId:r,action:e,data:n})})}function zc(){var t=function(e){function n(z,L,T,R,x,j,k,Q){var V=1-k;Q.x=V*V*z+2*V*k*T+k*k*x,Q.y=V*V*L+2*V*k*R+k*k*j}function s(z,L,T,R,x,j,k,Q,V,Y){var fe=1-V;Y.x=fe*fe*fe*z+3*fe*fe*V*T+3*fe*V*V*x+V*V*V*k,Y.y=fe*fe*fe*L+3*fe*fe*V*R+3*fe*V*V*j+V*V*V*Q}function i(z,L){for(var T=/([MLQCZ])([^MLQCZ]*)/g,R,x,j,k,Q;R=T.exec(z);){var V=R[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(Y){return parseFloat(Y)});switch(R[1]){case"M":k=x=V[0],Q=j=V[1];break;case"L":(V[0]!==k||V[1]!==Q)&&L("L",k,Q,k=V[0],Q=V[1]);break;case"Q":{L("Q",k,Q,k=V[2],Q=V[3],V[0],V[1]);break}case"C":{L("C",k,Q,k=V[4],Q=V[5],V[0],V[1],V[2],V[3]);break}case"Z":(k!==x||Q!==j)&&L("L",k,Q,x,j);break}}}function r(z,L,T){T===void 0&&(T=16);var R={x:0,y:0};i(z,function(x,j,k,Q,V,Y,fe,le,q){switch(x){case"L":L(j,k,Q,V);break;case"Q":{for(var ee=j,we=k,_e=1;_e<T;_e++)n(j,k,Y,fe,Q,V,_e/(T-1),R),L(ee,we,R.x,R.y),ee=R.x,we=R.y;break}case"C":{for(var he=j,Be=k,ve=1;ve<T;ve++)s(j,k,Y,fe,le,q,Q,V,ve/(T-1),R),L(he,Be,R.x,R.y),he=R.x,Be=R.y;break}}})}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",c="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",o=new WeakMap,l={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(z,L){var T=z.getContext?z.getContext("webgl",l):z,R=o.get(T);if(!R){let fe=function(he){var Be=j[he];if(!Be&&(Be=j[he]=T.getExtension(he),!Be))throw new Error(he+" not supported");return Be},le=function(he,Be){var ve=T.createShader(Be);return T.shaderSource(ve,he),T.compileShader(ve),ve},q=function(he,Be,ve,ne){if(!k[he]){var ge={},me={},$=T.createProgram();T.attachShader($,le(Be,T.VERTEX_SHADER)),T.attachShader($,le(ve,T.FRAGMENT_SHADER)),T.linkProgram($),k[he]={program:$,transaction:function(de){T.useProgram($),de({setUniform:function(ue,Ke){for(var pe=[],be=arguments.length-2;be-- >0;)pe[be]=arguments[be+2];var Me=me[Ke]||(me[Ke]=T.getUniformLocation($,Ke));T["uniform"+ue].apply(T,[Me].concat(pe))},setAttribute:function(ue,Ke,pe,be,Me){var Ge=ge[ue];Ge||(Ge=ge[ue]={buf:T.createBuffer(),loc:T.getAttribLocation($,ue),data:null}),T.bindBuffer(T.ARRAY_BUFFER,Ge.buf),T.vertexAttribPointer(Ge.loc,Ke,T.FLOAT,!1,0,0),T.enableVertexAttribArray(Ge.loc),x?T.vertexAttribDivisor(Ge.loc,be):fe("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Ge.loc,be),Me!==Ge.data&&(T.bufferData(T.ARRAY_BUFFER,Me,pe),Ge.data=Me)}})}}}k[he].transaction(ne)},ee=function(he,Be){V++;try{T.activeTexture(T.TEXTURE0+V);var ve=Q[he];ve||(ve=Q[he]=T.createTexture(),T.bindTexture(T.TEXTURE_2D,ve),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.NEAREST),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.NEAREST)),T.bindTexture(T.TEXTURE_2D,ve),Be(ve,V)}finally{V--}},we=function(he,Be,ve){var ne=T.createFramebuffer();Y.push(ne),T.bindFramebuffer(T.FRAMEBUFFER,ne),T.activeTexture(T.TEXTURE0+Be),T.bindTexture(T.TEXTURE_2D,he),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_2D,he,0);try{ve(ne)}finally{T.deleteFramebuffer(ne),T.bindFramebuffer(T.FRAMEBUFFER,Y[--Y.length-1]||null)}},_e=function(){j={},k={},Q={},V=-1,Y.length=0};var x=typeof WebGL2RenderingContext<"u"&&T instanceof WebGL2RenderingContext,j={},k={},Q={},V=-1,Y=[];T.canvas.addEventListener("webglcontextlost",function(he){_e(),he.preventDefault()},!1),o.set(T,R={gl:T,isWebGL2:x,getExtension:fe,withProgram:q,withTexture:ee,withTextureFramebuffer:we,handleContextLoss:_e})}L(R)}function f(z,L,T,R,x,j,k,Q){k===void 0&&(k=15),Q===void 0&&(Q=null),u(z,function(V){var Y=V.gl,fe=V.withProgram,le=V.withTexture;le("copy",function(q,ee){Y.texImage2D(Y.TEXTURE_2D,0,Y.RGBA,x,j,0,Y.RGBA,Y.UNSIGNED_BYTE,L),fe("copy",a,c,function(we){var _e=we.setUniform,he=we.setAttribute;he("aUV",2,Y.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),_e("1i","image",ee),Y.bindFramebuffer(Y.FRAMEBUFFER,Q||null),Y.disable(Y.BLEND),Y.colorMask(k&8,k&4,k&2,k&1),Y.viewport(T,R,x,j),Y.scissor(T,R,x,j),Y.drawArrays(Y.TRIANGLES,0,3)})})})}function h(z,L,T){var R=z.width,x=z.height;u(z,function(j){var k=j.gl,Q=new Uint8Array(R*x*4);k.readPixels(0,0,R,x,k.RGBA,k.UNSIGNED_BYTE,Q),z.width=L,z.height=T,f(k,Q,0,0,R,x)})}var d=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:f,resizeWebGLCanvasWithoutClearing:h});function m(z,L,T,R,x,j){j===void 0&&(j=1);var k=new Uint8Array(z*L),Q=R[2]-R[0],V=R[3]-R[1],Y=[];r(T,function(he,Be,ve,ne){Y.push({x1:he,y1:Be,x2:ve,y2:ne,minX:Math.min(he,ve),minY:Math.min(Be,ne),maxX:Math.max(he,ve),maxY:Math.max(Be,ne)})}),Y.sort(function(he,Be){return he.maxX-Be.maxX});for(var fe=0;fe<z;fe++)for(var le=0;le<L;le++){var q=we(R[0]+Q*(fe+.5)/z,R[1]+V*(le+.5)/L),ee=Math.pow(1-Math.abs(q)/x,j)/2;q<0&&(ee=1-ee),ee=Math.max(0,Math.min(255,Math.round(ee*255))),k[le*z+fe]=ee}return k;function we(he,Be){for(var ve=1/0,ne=1/0,ge=Y.length;ge--;){var me=Y[ge];if(me.maxX+ne<=he)break;if(he+ne>me.minX&&Be-ne<me.maxY&&Be+ne>me.minY){var $=C(he,Be,me.x1,me.y1,me.x2,me.y2);$<ve&&(ve=$,ne=Math.sqrt(ve))}}return _e(he,Be)&&(ne=-ne),ne}function _e(he,Be){for(var ve=0,ne=Y.length;ne--;){var ge=Y[ne];if(ge.maxX<=he)break;var me=ge.y1>Be!=ge.y2>Be&&he<(ge.x2-ge.x1)*(Be-ge.y1)/(ge.y2-ge.y1)+ge.x1;me&&(ve+=ge.y1<ge.y2?1:-1)}return ve!==0}}function g(z,L,T,R,x,j,k,Q,V,Y){j===void 0&&(j=1),Q===void 0&&(Q=0),V===void 0&&(V=0),Y===void 0&&(Y=0),v(z,L,T,R,x,j,k,null,Q,V,Y)}function v(z,L,T,R,x,j,k,Q,V,Y,fe){j===void 0&&(j=1),V===void 0&&(V=0),Y===void 0&&(Y=0),fe===void 0&&(fe=0);for(var le=m(z,L,T,R,x,j),q=new Uint8Array(le.length*4),ee=0;ee<le.length;ee++)q[ee*4+fe]=le[ee];f(k,q,V,Y,z,L,1<<3-fe,Q)}function C(z,L,T,R,x,j){var k=x-T,Q=j-R,V=k*k+Q*Q,Y=V?Math.max(0,Math.min(1,((z-T)*k+(L-R)*Q)/V)):0,fe=z-(T+Y*k),le=L-(R+Y*Q);return fe*fe+le*le}var B=Object.freeze({__proto__:null,generate:m,generateIntoCanvas:g,generateIntoFramebuffer:v}),y="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",b="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",M="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",S=new Float32Array([0,0,2,0,0,2]),I=null,E=!1,w={},G=new WeakMap;function W(z){if(!E&&!X(z))throw new Error("WebGL generation not supported")}function F(z,L,T,R,x,j,k){if(j===void 0&&(j=1),k===void 0&&(k=null),!k&&(k=I,!k)){var Q=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!Q)throw new Error("OffscreenCanvas or DOM canvas not supported");k=I=Q.getContext("webgl",{depth:!1})}W(k);var V=new Uint8Array(z*L*4);u(k,function(q){var ee=q.gl,we=q.withTexture,_e=q.withTextureFramebuffer;we("readable",function(he,Be){ee.texImage2D(ee.TEXTURE_2D,0,ee.RGBA,z,L,0,ee.RGBA,ee.UNSIGNED_BYTE,null),_e(he,Be,function(ve){D(z,L,T,R,x,j,ee,ve,0,0,0),ee.readPixels(0,0,z,L,ee.RGBA,ee.UNSIGNED_BYTE,V)})})});for(var Y=new Uint8Array(z*L),fe=0,le=0;fe<V.length;fe+=4)Y[le++]=V[fe];return Y}function O(z,L,T,R,x,j,k,Q,V,Y){j===void 0&&(j=1),Q===void 0&&(Q=0),V===void 0&&(V=0),Y===void 0&&(Y=0),D(z,L,T,R,x,j,k,null,Q,V,Y)}function D(z,L,T,R,x,j,k,Q,V,Y,fe){j===void 0&&(j=1),V===void 0&&(V=0),Y===void 0&&(Y=0),fe===void 0&&(fe=0),W(k);var le=[];r(T,function(q,ee,we,_e){le.push(q,ee,we,_e)}),le=new Float32Array(le),u(k,function(q){var ee=q.gl,we=q.isWebGL2,_e=q.getExtension,he=q.withProgram,Be=q.withTexture,ve=q.withTextureFramebuffer,ne=q.handleContextLoss;if(Be("rawDistances",function(ge,me){(z!==ge._lastWidth||L!==ge._lastHeight)&&ee.texImage2D(ee.TEXTURE_2D,0,ee.RGBA,ge._lastWidth=z,ge._lastHeight=L,0,ee.RGBA,ee.UNSIGNED_BYTE,null),he("main",y,b,function($){var Se=$.setAttribute,de=$.setUniform,ye=!we&&_e("ANGLE_instanced_arrays"),ue=!we&&_e("EXT_blend_minmax");Se("aUV",2,ee.STATIC_DRAW,0,S),Se("aLineSegment",4,ee.DYNAMIC_DRAW,1,le),de.apply(void 0,["4f","uGlyphBounds"].concat(R)),de("1f","uMaxDistance",x),de("1f","uExponent",j),ve(ge,me,function(Ke){ee.enable(ee.BLEND),ee.colorMask(!0,!0,!0,!0),ee.viewport(0,0,z,L),ee.scissor(0,0,z,L),ee.blendFunc(ee.ONE,ee.ONE),ee.blendEquationSeparate(ee.FUNC_ADD,we?ee.MAX:ue.MAX_EXT),ee.clear(ee.COLOR_BUFFER_BIT),we?ee.drawArraysInstanced(ee.TRIANGLES,0,3,le.length/4):ye.drawArraysInstancedANGLE(ee.TRIANGLES,0,3,le.length/4)})}),he("post",a,M,function($){$.setAttribute("aUV",2,ee.STATIC_DRAW,0,S),$.setUniform("1i","tex",me),ee.bindFramebuffer(ee.FRAMEBUFFER,Q),ee.disable(ee.BLEND),ee.colorMask(fe===0,fe===1,fe===2,fe===3),ee.viewport(V,Y,z,L),ee.scissor(V,Y,z,L),ee.drawArrays(ee.TRIANGLES,0,3)})}),ee.isContextLost())throw ne(),new Error("webgl context lost")})}function X(z){var L=!z||z===I?w:z.canvas||z,T=G.get(L);if(T===void 0){E=!0;var R=null;try{var x=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],j=F(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,z);T=j&&x.length===j.length&&j.every(function(k,Q){return k===x[Q]}),T||(R="bad trial run results",console.info(x,j))}catch(k){T=!1,R=k.message}R&&console.warn("WebGL SDF generation not supported:",R),E=!1,G.set(L,T)}return T}var J=Object.freeze({__proto__:null,generate:F,generateIntoCanvas:O,generateIntoFramebuffer:D,isSupported:X});function ie(z,L,T,R,x,j){x===void 0&&(x=Math.max(R[2]-R[0],R[3]-R[1])/2),j===void 0&&(j=1);try{return F.apply(J,arguments)}catch(k){return console.info("WebGL SDF generation failed, falling back to JS",k),m.apply(B,arguments)}}function Ae(z,L,T,R,x,j,k,Q,V,Y){x===void 0&&(x=Math.max(R[2]-R[0],R[3]-R[1])/2),j===void 0&&(j=1),Q===void 0&&(Q=0),V===void 0&&(V=0),Y===void 0&&(Y=0);try{return O.apply(J,arguments)}catch(fe){return console.info("WebGL SDF generation failed, falling back to JS",fe),g.apply(B,arguments)}}return e.forEachPathCommand=i,e.generate=ie,e.generateIntoCanvas=Ae,e.javascript=B,e.pathToLineSegments=r,e.webgl=J,e.webglUtils=d,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}function pp(){var t=function(e){var n={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},s={},i={};s.L=1,i[1]="L",Object.keys(n).forEach(function(ne,ge){s[ne]=1<<ge+1,i[s[ne]]=ne}),Object.freeze(s);var r=s.LRI|s.RLI|s.FSI,a=s.L|s.R|s.AL,c=s.B|s.S|s.WS|s.ON|s.FSI|s.LRI|s.RLI|s.PDI,o=s.BN|s.RLE|s.LRE|s.RLO|s.LRO|s.PDF,l=s.S|s.WS|s.B|r|s.PDI|o,u=null;function f(){if(!u){u=new Map;var ne=function(me){if(n.hasOwnProperty(me)){var $=0;n[me].split(",").forEach(function(Se){var de=Se.split("+"),ye=de[0],ue=de[1];ye=parseInt(ye,36),ue=ue?parseInt(ue,36):0,u.set($+=ye,s[me]);for(var Ke=0;Ke<ue;Ke++)u.set(++$,s[me])})}};for(var ge in n)ne(ge)}}function h(ne){return f(),u.get(ne.codePointAt(0))||s.L}function d(ne){return i[h(ne)]}var m={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function g(ne,ge){var me=36,$=0,Se=new Map,de=ge&&new Map,ye;return ne.split(",").forEach(function ue(Ke){if(Ke.indexOf("+")!==-1)for(var pe=+Ke;pe--;)ue(ye);else{ye=Ke;var be=Ke.split(">"),Me=be[0],Ge=be[1];Me=String.fromCodePoint($+=parseInt(Me,me)),Ge=String.fromCodePoint($+=parseInt(Ge,me)),Se.set(Me,Ge),ge&&de.set(Ge,Me)}}),{map:Se,reverseMap:de}}var v,C,B;function y(){if(!v){var ne=g(m.pairs,!0),ge=ne.map,me=ne.reverseMap;v=ge,C=me,B=g(m.canonical,!1).map}}function b(ne){return y(),v.get(ne)||null}function M(ne){return y(),C.get(ne)||null}function S(ne){return y(),B.get(ne)||null}var I=s.L,E=s.R,w=s.EN,G=s.ES,W=s.ET,F=s.AN,O=s.CS,D=s.B,X=s.S,J=s.ON,ie=s.BN,Ae=s.NSM,z=s.AL,L=s.LRO,T=s.RLO,R=s.LRE,x=s.RLE,j=s.PDF,k=s.LRI,Q=s.RLI,V=s.FSI,Y=s.PDI;function fe(ne,ge){for(var me=125,$=new Uint32Array(ne.length),Se=0;Se<ne.length;Se++)$[Se]=h(ne[Se]);var de=new Map;function ye(Tt,Qt){var wt=$[Tt];$[Tt]=Qt,de.set(wt,de.get(wt)-1),wt&c&&de.set(c,de.get(c)-1),de.set(Qt,(de.get(Qt)||0)+1),Qt&c&&de.set(c,(de.get(c)||0)+1)}for(var ue=new Uint8Array(ne.length),Ke=new Map,pe=[],be=null,Me=0;Me<ne.length;Me++)be||pe.push(be={start:Me,end:ne.length-1,level:ge==="rtl"?1:ge==="ltr"?0:Ma(Me,!1)}),$[Me]&D&&(be.end=Me,be=null);for(var Ge=x|R|T|L|r|Y|j|D,et=function(Tt){return Tt+(Tt&1?1:2)},st=function(Tt){return Tt+(Tt&1?2:1)},Ue=0;Ue<pe.length;Ue++){be=pe[Ue];var Fe=[{_level:be.level,_override:0,_isolate:0}],Te=void 0,Ze=0,He=0,je=0;de.clear();for(var tt=be.start;tt<=be.end;tt++){var Z=$[tt];if(Te=Fe[Fe.length-1],de.set(Z,(de.get(Z)||0)+1),Z&c&&de.set(c,(de.get(c)||0)+1),Z&Ge)if(Z&(x|R)){ue[tt]=Te._level;var Je=(Z===x?st:et)(Te._level);Je<=me&&!Ze&&!He?Fe.push({_level:Je,_override:0,_isolate:0}):Ze||He++}else if(Z&(T|L)){ue[tt]=Te._level;var $t=(Z===T?st:et)(Te._level);$t<=me&&!Ze&&!He?Fe.push({_level:$t,_override:Z&T?E:I,_isolate:0}):Ze||He++}else if(Z&r){Z&V&&(Z=Ma(tt+1,!0)===1?Q:k),ue[tt]=Te._level,Te._override&&ye(tt,Te._override);var Ye=(Z===Q?st:et)(Te._level);Ye<=me&&Ze===0&&He===0?(je++,Fe.push({_level:Ye,_override:0,_isolate:1,_isolInitIndex:tt})):Ze++}else if(Z&Y){if(Ze>0)Ze--;else if(je>0){for(He=0;!Fe[Fe.length-1]._isolate;)Fe.pop();var Pe=Fe[Fe.length-1]._isolInitIndex;Pe!=null&&(Ke.set(Pe,tt),Ke.set(tt,Pe)),Fe.pop(),je--}Te=Fe[Fe.length-1],ue[tt]=Te._level,Te._override&&ye(tt,Te._override)}else Z&j?(Ze===0&&(He>0?He--:!Te._isolate&&Fe.length>1&&(Fe.pop(),Te=Fe[Fe.length-1])),ue[tt]=Te._level):Z&D&&(ue[tt]=be.level);else ue[tt]=Te._level,Te._override&&Z!==ie&&ye(tt,Te._override)}for(var ut=[],nt=null,Oe=be.start;Oe<=be.end;Oe++){var it=$[Oe];if(!(it&o)){var yt=ue[Oe],vt=it&r,ft=it===Y;nt&&yt===nt._level?(nt._end=Oe,nt._endsWithIsolInit=vt):ut.push(nt={_start:Oe,_end:Oe,_level:yt,_startsWithPDI:ft,_endsWithIsolInit:vt})}}for(var It=[],St=0;St<ut.length;St++){var Jt=ut[St];if(!Jt._startsWithPDI||Jt._startsWithPDI&&!Ke.has(Jt._start)){for(var _t=[nt=Jt],Dt=void 0;nt&&nt._endsWithIsolInit&&(Dt=Ke.get(nt._end))!=null;)for(var Re=St+1;Re<ut.length;Re++)if(ut[Re]._start===Dt){_t.push(nt=ut[Re]);break}for(var Bt=[],ir=0;ir<_t.length;ir++)for(var p=_t[ir],A=p._start;A<=p._end;A++)Bt.push(A);for(var _=ue[Bt[0]],U=be.level,N=Bt[0]-1;N>=0;N--)if(!($[N]&o)){U=ue[N];break}var K=Bt[Bt.length-1],re=ue[K],te=be.level;if(!($[K]&r)){for(var se=K+1;se<=be.end;se++)if(!($[se]&o)){te=ue[se];break}}It.push({_seqIndices:Bt,_sosType:Math.max(U,_)%2?E:I,_eosType:Math.max(te,re)%2?E:I})}}for(var ae=0;ae<It.length;ae++){var oe=It[ae],H=oe._seqIndices,qe=oe._sosType,Ee=oe._eosType,Ce=ue[H[0]]&1?E:I;if(de.get(Ae))for(var Ie=0;Ie<H.length;Ie++){var ke=H[Ie];if($[ke]&Ae){for(var Qe=qe,We=Ie-1;We>=0;We--)if(!($[H[We]]&o)){Qe=$[H[We]];break}ye(ke,Qe&(r|Y)?J:Qe)}}if(de.get(w))for(var ct=0;ct<H.length;ct++){var Ct=H[ct];if($[Ct]&w)for(var Xe=ct-1;Xe>=-1;Xe--){var Rt=Xe===-1?qe:$[H[Xe]];if(Rt&a){Rt===z&&ye(Ct,F);break}}}if(de.get(z))for(var $e=0;$e<H.length;$e++){var ht=H[$e];$[ht]&z&&ye(ht,E)}if(de.get(G)||de.get(O))for(var Et=1;Et<H.length-1;Et++){var sr=H[Et];if($[sr]&(G|O)){for(var mt=0,Ve=0,dt=Et-1;dt>=0&&(mt=$[H[dt]],!!(mt&o));dt--);for(var rt=Et+1;rt<H.length&&(Ve=$[H[rt]],!!(Ve&o));rt++);mt===Ve&&($[sr]===G?mt===w:mt&(w|F))&&ye(sr,mt)}}if(de.get(w))for(var Le=0;Le<H.length;Le++){var Mt=H[Le];if($[Mt]&w){for(var Gt=Le-1;Gt>=0&&$[H[Gt]]&(W|o);Gt--)ye(H[Gt],w);for(Le++;Le<H.length&&$[H[Le]]&(W|o|w);Le++)$[H[Le]]!==w&&ye(H[Le],w)}}if(de.get(W)||de.get(G)||de.get(O))for(var At=0;At<H.length;At++){var Kt=H[At];if($[Kt]&(W|G|O)){ye(Kt,J);for(var jn=At-1;jn>=0&&$[H[jn]]&o;jn--)ye(H[jn],J);for(var Qn=At+1;Qn<H.length&&$[H[Qn]]&o;Qn++)ye(H[Qn],J)}}if(de.get(w))for(var Ui=0,da=qe;Ui<H.length;Ui++){var pa=H[Ui],Oi=$[pa];Oi&w?da===I&&ye(pa,I):Oi&a&&(da=Oi)}if(de.get(c)){var en=E|w|F,ma=en|I,Wn=[];{for(var Or=[],kr=0;kr<H.length;kr++)if($[H[kr]]&c){var tn=ne[H[kr]],Aa=void 0;if(b(tn)!==null)if(Or.length<63)Or.push({char:tn,seqIndex:kr});else break;else if((Aa=M(tn))!==null)for(var rn=Or.length-1;rn>=0;rn--){var ki=Or[rn].char;if(ki===Aa||ki===M(S(tn))||b(S(ki))===tn){Wn.push([Or[rn].seqIndex,kr]),Or.length=rn;break}}}Wn.sort(function(Tt,Qt){return Tt[0]-Qt[0]})}for(var Li=0;Li<Wn.length;Li++){for(var ga=Wn[Li],Xn=ga[0],Pi=ga[1],va=!1,jt=0,Hi=Xn+1;Hi<Pi;Hi++){var Ba=H[Hi];if($[Ba]&ma){va=!0;var Ca=$[Ba]&en?E:I;if(Ca===Ce){jt=Ca;break}}}if(va&&!jt){jt=qe;for(var Ni=Xn-1;Ni>=0;Ni--){var ya=H[Ni];if($[ya]&ma){var ba=$[ya]&en?E:I;ba!==Ce?jt=ba:jt=Ce;break}}}if(jt){if($[H[Xn]]=$[H[Pi]]=jt,jt!==Ce){for(var nn=Xn+1;nn<H.length;nn++)if(!($[H[nn]]&o)){h(ne[H[nn]])&Ae&&($[H[nn]]=jt);break}}if(jt!==Ce){for(var sn=Pi+1;sn<H.length;sn++)if(!($[H[sn]]&o)){h(ne[H[sn]])&Ae&&($[H[sn]]=jt);break}}}}for(var dr=0;dr<H.length;dr++)if($[H[dr]]&c){for(var Ea=dr,Ji=dr,Ki=qe,an=dr-1;an>=0;an--)if($[H[an]]&o)Ea=an;else{Ki=$[H[an]]&en?E:I;break}for(var _a=Ee,on=dr+1;on<H.length;on++)if($[H[on]]&(c|o))Ji=on;else{_a=$[H[on]]&en?E:I;break}for(var ji=Ea;ji<=Ji;ji++)$[H[ji]]=Ki===_a?Ki:Ce;dr=Ji}}}for(var xt=be.start;xt<=be.end;xt++){var Bl=ue[xt],Vn=$[xt];if(Bl&1?Vn&(I|w|F)&&ue[xt]++:Vn&E?ue[xt]++:Vn&(F|w)&&(ue[xt]+=2),Vn&o&&(ue[xt]=xt===0?be.level:ue[xt-1]),xt===be.end||h(ne[xt])&(X|D))for(var Yn=xt;Yn>=0&&h(ne[Yn])&l;Yn--)ue[Yn]=be.level}}return{levels:ue,paragraphs:pe};function Ma(Tt,Qt){for(var wt=Tt;wt<ne.length;wt++){var pr=$[wt];if(pr&(E|z))return 1;if(pr&(D|I)||Qt&&pr===Y)return 0;if(pr&r){var Ta=Cl(wt);wt=Ta===-1?ne.length:Ta}}return 0}function Cl(Tt){for(var Qt=1,wt=Tt+1;wt<ne.length;wt++){var pr=$[wt];if(pr&D)break;if(pr&Y){if(--Qt===0)return wt}else pr&r&&Qt++}return-1}}var le="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",q;function ee(){if(!q){var ne=g(le,!0),ge=ne.map,me=ne.reverseMap;me.forEach(function($,Se){ge.set(Se,$)}),q=ge}}function we(ne){return ee(),q.get(ne)||null}function _e(ne,ge,me,$){var Se=ne.length;me=Math.max(0,me==null?0:+me),$=Math.min(Se-1,$==null?Se-1:+$);for(var de=new Map,ye=me;ye<=$;ye++)if(ge[ye]&1){var ue=we(ne[ye]);ue!==null&&de.set(ye,ue)}return de}function he(ne,ge,me,$){var Se=ne.length;me=Math.max(0,me==null?0:+me),$=Math.min(Se-1,$==null?Se-1:+$);var de=[];return ge.paragraphs.forEach(function(ye){var ue=Math.max(me,ye.start),Ke=Math.min($,ye.end);if(ue<Ke){for(var pe=ge.levels.slice(ue,Ke+1),be=Ke;be>=ue&&h(ne[be])&l;be--)pe[be]=ye.level;for(var Me=ye.level,Ge=1/0,et=0;et<pe.length;et++){var st=pe[et];st>Me&&(Me=st),st<Ge&&(Ge=st|1)}for(var Ue=Me;Ue>=Ge;Ue--)for(var Fe=0;Fe<pe.length;Fe++)if(pe[Fe]>=Ue){for(var Te=Fe;Fe+1<pe.length&&pe[Fe+1]>=Ue;)Fe++;Fe>Te&&de.push([Te+ue,Fe+ue])}}}),de}function Be(ne,ge,me,$){var Se=ve(ne,ge,me,$),de=[].concat(ne);return Se.forEach(function(ye,ue){de[ue]=(ge.levels[ye]&1?we(ne[ye]):null)||ne[ye]}),de.join("")}function ve(ne,ge,me,$){for(var Se=he(ne,ge,me,$),de=[],ye=0;ye<ne.length;ye++)de[ye]=ye;return Se.forEach(function(ue){for(var Ke=ue[0],pe=ue[1],be=de.slice(Ke,pe+1),Me=be.length;Me--;)de[pe-Me]=be[Me]}),de}return e.closingToOpeningBracket=M,e.getBidiCharType=h,e.getBidiCharTypeName=d,e.getCanonicalBracket=S,e.getEmbeddingLevels=fe,e.getMirroredCharacter=we,e.getMirroredCharactersMap=_e,e.getReorderSegments=he,e.getReorderedIndices=ve,e.getReorderedString=Be,e.openingToClosingBracket=b,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}const Zc=/\bvoid\s+main\s*\(\s*\)\s*{/g;function xs(t){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function n(s,i){let r=nu[i];return r?xs(r):s}return t.replace(e,n)}const bt=[];for(let t=0;t<256;t++)bt[t]=(t<16?"0":"")+t.toString(16);function mp(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,s=Math.random()*4294967295|0;return(bt[t&255]+bt[t>>8&255]+bt[t>>16&255]+bt[t>>24&255]+"-"+bt[e&255]+bt[e>>8&255]+"-"+bt[e>>16&15|64]+bt[e>>24&255]+"-"+bt[n&63|128]+bt[n>>8&255]+"-"+bt[n>>16&255]+bt[n>>24&255]+bt[s&255]+bt[s>>8&255]+bt[s>>16&255]+bt[s>>24&255]).toUpperCase()}const _r=Object.assign||function(){let t=arguments[0];for(let e=1,n=arguments.length;e<n;e++){let s=arguments[e];if(s)for(let i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}return t},Ap=Date.now(),bo=new WeakMap,Eo=new Map;let gp=1e10;function Gs(t,e){const n=yp(e);let s=bo.get(t);if(s||bo.set(t,s=Object.create(null)),s[n])return new s[n];const i=`_onBeforeCompile${n}`,r=function(l,u){t.onBeforeCompile.call(this,l,u);const f=this.customProgramCacheKey()+"|"+l.vertexShader+"|"+l.fragmentShader;let h=Eo[f];if(!h){const d=vp(this,l,e,n);h=Eo[f]=d}l.vertexShader=h.vertexShader,l.fragmentShader=h.fragmentShader,_r(l.uniforms,this.uniforms),e.timeUniform&&(l.uniforms[e.timeUniform]={get value(){return Date.now()-Ap}}),this[i]&&this[i](l)},a=function(){return c(e.chained?t:t.clone())},c=function(l){const u=Object.create(l,o);return Object.defineProperty(u,"baseMaterial",{value:t}),Object.defineProperty(u,"id",{value:gp++}),u.uuid=mp(),u.uniforms=_r({},l.uniforms,e.uniforms),u.defines=_r({},l.defines,e.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${n}`]="",u.extensions=_r({},l.extensions,e.extensions),u._listeners=void 0,u},o={constructor:{value:a},isDerivedMaterial:{value:!0},type:{get:()=>t.type,set:l=>{t.type=l}},isDerivedFrom:{writable:!0,configurable:!0,value:function(l){const u=this.baseMaterial;return l===u||u.isDerivedMaterial&&u.isDerivedFrom(l)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return t.customProgramCacheKey()+"|"+n}},onBeforeCompile:{get(){return r},set(l){this[i]=l}},copy:{writable:!0,configurable:!0,value:function(l){return t.copy.call(this,l),!t.isShaderMaterial&&!t.isDerivedMaterial&&(_r(this.extensions,l.extensions),_r(this.defines,l.defines),_r(this.uniforms,$l.clone(l.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const l=new t.constructor;return c(l).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let l=this._depthMaterial;return l||(l=this._depthMaterial=Gs(t.isDerivedMaterial?t.getDepthMaterial():new eu({depthPacking:tu}),e),l.defines.IS_DEPTH_MATERIAL="",l.uniforms=this.uniforms),l}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let l=this._distanceMaterial;return l||(l=this._distanceMaterial=Gs(t.isDerivedMaterial?t.getDistanceMaterial():new ru,e),l.defines.IS_DISTANCE_MATERIAL="",l.uniforms=this.uniforms),l}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:l,_distanceMaterial:u}=this;l&&l.dispose(),u&&u.dispose(),t.dispose.call(this)}}};return s[n]=a,new a}function vp(t,{vertexShader:e,fragmentShader:n},s,i){let{vertexDefs:r,vertexMainIntro:a,vertexMainOutro:c,vertexTransform:o,fragmentDefs:l,fragmentMainIntro:u,fragmentMainOutro:f,fragmentColorTransform:h,customRewriter:d,timeUniform:m}=s;if(r=r||"",a=a||"",c=c||"",l=l||"",u=u||"",f=f||"",(o||d)&&(e=xs(e)),(h||d)&&(n=n.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),n=xs(n)),d){let g=d({vertexShader:e,fragmentShader:n});e=g.vertexShader,n=g.fragmentShader}if(h){let g=[];n=n.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,v=>(g.push(v),"")),f=`${h}
${g.join(`
`)}
${f}`}if(m){const g=`
uniform float ${m};
`;r=g+r,l=g+l}return o&&(e=`vec3 troika_position_${i};
vec3 troika_normal_${i};
vec2 troika_uv_${i};
${e}
`,r=`${r}
void troikaVertexTransform${i}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${o}
}
`,a=`
troika_position_${i} = vec3(position);
troika_normal_${i} = vec3(normal);
troika_uv_${i} = vec2(uv);
troikaVertexTransform${i}(troika_position_${i}, troika_normal_${i}, troika_uv_${i});
${a}
`,e=e.replace(/\b(position|normal|uv)\b/g,(g,v,C,B)=>/\battribute\s+vec[23]\s+$/.test(B.substr(0,C))?v:`troika_${v}_${i}`),t.map&&t.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${i}`))),e=_o(e,i,r,a,c),n=_o(n,i,l,u,f),{vertexShader:e,fragmentShader:n}}function _o(t,e,n,s,i){return(s||i||n)&&(t=t.replace(Zc,`
${n}
void troikaOrigMain${e}() {`),t+=`
void main() {
  ${s}
  troikaOrigMain${e}();
  ${i}
}`),t}function Bp(t,e){return t==="uniforms"?void 0:typeof e=="function"?e.toString():e}let Cp=0;const Mo=new Map;function yp(t){const e=JSON.stringify(t,Bp);let n=Mo.get(e);return n==null&&Mo.set(e,n=++Cp),n}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function bp(){return typeof window>"u"&&(self.window=self),function(t){var e={parse:function(i){var r=e._bin,a=new Uint8Array(i);if(r.readASCII(a,0,4)=="ttcf"){var c=4;r.readUshort(a,c),c+=2,r.readUshort(a,c),c+=2;var o=r.readUint(a,c);c+=4;for(var l=[],u=0;u<o;u++){var f=r.readUint(a,c);c+=4,l.push(e._readFont(a,f))}return l}return[e._readFont(a,0)]},_readFont:function(i,r){var a=e._bin,c=r;a.readFixed(i,r),r+=4;var o=a.readUshort(i,r);r+=2,a.readUshort(i,r),r+=2,a.readUshort(i,r),r+=2,a.readUshort(i,r),r+=2;for(var l=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],u={_data:i,_offset:c},f={},h=0;h<o;h++){var d=a.readASCII(i,r,4);r+=4,a.readUint(i,r),r+=4;var m=a.readUint(i,r);r+=4;var g=a.readUint(i,r);r+=4,f[d]={offset:m,length:g}}for(h=0;h<l.length;h++){var v=l[h];f[v]&&(u[v.trim()]=e[v.trim()].parse(i,f[v].offset,f[v].length,u))}return u},_tabOffset:function(i,r,a){for(var c=e._bin,o=c.readUshort(i,a+4),l=a+12,u=0;u<o;u++){var f=c.readASCII(i,l,4);l+=4,c.readUint(i,l),l+=4;var h=c.readUint(i,l);if(l+=4,c.readUint(i,l),l+=4,f==r)return h}return 0}};e._bin={readFixed:function(i,r){return(i[r]<<8|i[r+1])+(i[r+2]<<8|i[r+3])/65540},readF2dot14:function(i,r){return e._bin.readShort(i,r)/16384},readInt:function(i,r){return e._bin._view(i).getInt32(r)},readInt8:function(i,r){return e._bin._view(i).getInt8(r)},readShort:function(i,r){return e._bin._view(i).getInt16(r)},readUshort:function(i,r){return e._bin._view(i).getUint16(r)},readUshorts:function(i,r,a){for(var c=[],o=0;o<a;o++)c.push(e._bin.readUshort(i,r+2*o));return c},readUint:function(i,r){return e._bin._view(i).getUint32(r)},readUint64:function(i,r){return 4294967296*e._bin.readUint(i,r)+e._bin.readUint(i,r+4)},readASCII:function(i,r,a){for(var c="",o=0;o<a;o++)c+=String.fromCharCode(i[r+o]);return c},readUnicode:function(i,r,a){for(var c="",o=0;o<a;o++){var l=i[r++]<<8|i[r++];c+=String.fromCharCode(l)}return c},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(i,r,a){var c=e._bin._tdec;return c&&r==0&&a==i.length?c.decode(i):e._bin.readASCII(i,r,a)},readBytes:function(i,r,a){for(var c=[],o=0;o<a;o++)c.push(i[r+o]);return c},readASCIIArray:function(i,r,a){for(var c=[],o=0;o<a;o++)c.push(String.fromCharCode(i[r+o]));return c},_view:function(i){return i._dataView||(i._dataView=i.buffer?new DataView(i.buffer,i.byteOffset,i.byteLength):new DataView(new Uint8Array(i).buffer))}},e._lctf={},e._lctf.parse=function(i,r,a,c,o){var l=e._bin,u={},f=r;l.readFixed(i,r),r+=4;var h=l.readUshort(i,r);r+=2;var d=l.readUshort(i,r);r+=2;var m=l.readUshort(i,r);return r+=2,u.scriptList=e._lctf.readScriptList(i,f+h),u.featureList=e._lctf.readFeatureList(i,f+d),u.lookupList=e._lctf.readLookupList(i,f+m,o),u},e._lctf.readLookupList=function(i,r,a){var c=e._bin,o=r,l=[],u=c.readUshort(i,r);r+=2;for(var f=0;f<u;f++){var h=c.readUshort(i,r);r+=2;var d=e._lctf.readLookupTable(i,o+h,a);l.push(d)}return l},e._lctf.readLookupTable=function(i,r,a){var c=e._bin,o=r,l={tabs:[]};l.ltype=c.readUshort(i,r),r+=2,l.flag=c.readUshort(i,r),r+=2;var u=c.readUshort(i,r);r+=2;for(var f=l.ltype,h=0;h<u;h++){var d=c.readUshort(i,r);r+=2;var m=a(i,f,o+d,l);l.tabs.push(m)}return l},e._lctf.numOfOnes=function(i){for(var r=0,a=0;a<32;a++)i>>>a&1&&r++;return r},e._lctf.readClassDef=function(i,r){var a=e._bin,c=[],o=a.readUshort(i,r);if(r+=2,o==1){var l=a.readUshort(i,r);r+=2;var u=a.readUshort(i,r);r+=2;for(var f=0;f<u;f++)c.push(l+f),c.push(l+f),c.push(a.readUshort(i,r)),r+=2}if(o==2){var h=a.readUshort(i,r);for(r+=2,f=0;f<h;f++)c.push(a.readUshort(i,r)),r+=2,c.push(a.readUshort(i,r)),r+=2,c.push(a.readUshort(i,r)),r+=2}return c},e._lctf.getInterval=function(i,r){for(var a=0;a<i.length;a+=3){var c=i[a],o=i[a+1];if(i[a+2],c<=r&&r<=o)return a}return-1},e._lctf.readCoverage=function(i,r){var a=e._bin,c={};c.fmt=a.readUshort(i,r),r+=2;var o=a.readUshort(i,r);return r+=2,c.fmt==1&&(c.tab=a.readUshorts(i,r,o)),c.fmt==2&&(c.tab=a.readUshorts(i,r,3*o)),c},e._lctf.coverageIndex=function(i,r){var a=i.tab;if(i.fmt==1)return a.indexOf(r);if(i.fmt==2){var c=e._lctf.getInterval(a,r);if(c!=-1)return a[c+2]+(r-a[c])}return-1},e._lctf.readFeatureList=function(i,r){var a=e._bin,c=r,o=[],l=a.readUshort(i,r);r+=2;for(var u=0;u<l;u++){var f=a.readASCII(i,r,4);r+=4;var h=a.readUshort(i,r);r+=2;var d=e._lctf.readFeatureTable(i,c+h);d.tag=f.trim(),o.push(d)}return o},e._lctf.readFeatureTable=function(i,r){var a=e._bin,c=r,o={},l=a.readUshort(i,r);r+=2,l>0&&(o.featureParams=c+l);var u=a.readUshort(i,r);r+=2,o.tab=[];for(var f=0;f<u;f++)o.tab.push(a.readUshort(i,r+2*f));return o},e._lctf.readScriptList=function(i,r){var a=e._bin,c=r,o={},l=a.readUshort(i,r);r+=2;for(var u=0;u<l;u++){var f=a.readASCII(i,r,4);r+=4;var h=a.readUshort(i,r);r+=2,o[f.trim()]=e._lctf.readScriptTable(i,c+h)}return o},e._lctf.readScriptTable=function(i,r){var a=e._bin,c=r,o={},l=a.readUshort(i,r);r+=2,l>0&&(o.default=e._lctf.readLangSysTable(i,c+l));var u=a.readUshort(i,r);r+=2;for(var f=0;f<u;f++){var h=a.readASCII(i,r,4);r+=4;var d=a.readUshort(i,r);r+=2,o[h.trim()]=e._lctf.readLangSysTable(i,c+d)}return o},e._lctf.readLangSysTable=function(i,r){var a=e._bin,c={};a.readUshort(i,r),r+=2,c.reqFeature=a.readUshort(i,r),r+=2;var o=a.readUshort(i,r);return r+=2,c.features=a.readUshorts(i,r,o),c},e.CFF={},e.CFF.parse=function(i,r,a){var c=e._bin;(i=new Uint8Array(i.buffer,r,a))[r=0],i[++r],i[++r],i[++r],r++;var o=[];r=e.CFF.readIndex(i,r,o);for(var l=[],u=0;u<o.length-1;u++)l.push(c.readASCII(i,r+o[u],o[u+1]-o[u]));r+=o[o.length-1];var f=[];r=e.CFF.readIndex(i,r,f);var h=[];for(u=0;u<f.length-1;u++)h.push(e.CFF.readDict(i,r+f[u],r+f[u+1]));r+=f[f.length-1];var d=h[0],m=[];r=e.CFF.readIndex(i,r,m);var g=[];for(u=0;u<m.length-1;u++)g.push(c.readASCII(i,r+m[u],m[u+1]-m[u]));if(r+=m[m.length-1],e.CFF.readSubrs(i,r,d),d.CharStrings){r=d.CharStrings,m=[],r=e.CFF.readIndex(i,r,m);var v=[];for(u=0;u<m.length-1;u++)v.push(c.readBytes(i,r+m[u],m[u+1]-m[u]));d.CharStrings=v}if(d.ROS){r=d.FDArray;var C=[];for(r=e.CFF.readIndex(i,r,C),d.FDArray=[],u=0;u<C.length-1;u++){var B=e.CFF.readDict(i,r+C[u],r+C[u+1]);e.CFF._readFDict(i,B,g),d.FDArray.push(B)}r+=C[C.length-1],r=d.FDSelect,d.FDSelect=[];var y=i[r];if(r++,y!=3)throw y;var b=c.readUshort(i,r);for(r+=2,u=0;u<b+1;u++)d.FDSelect.push(c.readUshort(i,r),i[r+2]),r+=3}return d.Encoding&&(d.Encoding=e.CFF.readEncoding(i,d.Encoding,d.CharStrings.length)),d.charset&&(d.charset=e.CFF.readCharset(i,d.charset,d.CharStrings.length)),e.CFF._readFDict(i,d,g),d},e.CFF._readFDict=function(i,r,a){var c;for(var o in r.Private&&(c=r.Private[1],r.Private=e.CFF.readDict(i,c,c+r.Private[0]),r.Private.Subrs&&e.CFF.readSubrs(i,c+r.Private.Subrs,r.Private)),r)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(o)!=-1&&(r[o]=a[r[o]-426+35])},e.CFF.readSubrs=function(i,r,a){var c=e._bin,o=[];r=e.CFF.readIndex(i,r,o);var l,u=o.length;l=u<1240?107:u<33900?1131:32768,a.Bias=l,a.Subrs=[];for(var f=0;f<o.length-1;f++)a.Subrs.push(c.readBytes(i,r+o[f],o[f+1]-o[f]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(i,r){for(var a=0;a<i.charset.length;a++)if(i.charset[a]==r)return a;return-1},e.CFF.glyphBySE=function(i,r){return r<0||r>255?-1:e.CFF.glyphByUnicode(i,e.CFF.tableSE[r])},e.CFF.readEncoding=function(i,r,a){e._bin;var c=[".notdef"],o=i[r];if(r++,o!=0)throw"error: unknown encoding format: "+o;var l=i[r];r++;for(var u=0;u<l;u++)c.push(i[r+u]);return c},e.CFF.readCharset=function(i,r,a){var c=e._bin,o=[".notdef"],l=i[r];if(r++,l==0)for(var u=0;u<a;u++){var f=c.readUshort(i,r);r+=2,o.push(f)}else{if(l!=1&&l!=2)throw"error: format: "+l;for(;o.length<a;){f=c.readUshort(i,r),r+=2;var h=0;for(l==1?(h=i[r],r++):(h=c.readUshort(i,r),r+=2),u=0;u<=h;u++)o.push(f),f++}}return o},e.CFF.readIndex=function(i,r,a){var c=e._bin,o=c.readUshort(i,r)+1,l=i[r+=2];if(r++,l==1)for(var u=0;u<o;u++)a.push(i[r+u]);else if(l==2)for(u=0;u<o;u++)a.push(c.readUshort(i,r+2*u));else if(l==3)for(u=0;u<o;u++)a.push(16777215&c.readUint(i,r+3*u-1));else if(o!=1)throw"unsupported offset size: "+l+", count: "+o;return(r+=o*l)-1},e.CFF.getCharString=function(i,r,a){var c=e._bin,o=i[r],l=i[r+1];i[r+2],i[r+3],i[r+4];var u=1,f=null,h=null;o<=20&&(f=o,u=1),o==12&&(f=100*o+l,u=2),21<=o&&o<=27&&(f=o,u=1),o==28&&(h=c.readShort(i,r+1),u=3),29<=o&&o<=31&&(f=o,u=1),32<=o&&o<=246&&(h=o-139,u=1),247<=o&&o<=250&&(h=256*(o-247)+l+108,u=2),251<=o&&o<=254&&(h=256*-(o-251)-l-108,u=2),o==255&&(h=c.readInt(i,r+1)/65535,u=5),a.val=h??"o"+f,a.size=u},e.CFF.readCharString=function(i,r,a){for(var c=r+a,o=e._bin,l=[];r<c;){var u=i[r],f=i[r+1];i[r+2],i[r+3],i[r+4];var h=1,d=null,m=null;u<=20&&(d=u,h=1),u==12&&(d=100*u+f,h=2),u!=19&&u!=20||(d=u,h=2),21<=u&&u<=27&&(d=u,h=1),u==28&&(m=o.readShort(i,r+1),h=3),29<=u&&u<=31&&(d=u,h=1),32<=u&&u<=246&&(m=u-139,h=1),247<=u&&u<=250&&(m=256*(u-247)+f+108,h=2),251<=u&&u<=254&&(m=256*-(u-251)-f-108,h=2),u==255&&(m=o.readInt(i,r+1)/65535,h=5),l.push(m??"o"+d),r+=h}return l},e.CFF.readDict=function(i,r,a){for(var c=e._bin,o={},l=[];r<a;){var u=i[r],f=i[r+1];i[r+2],i[r+3],i[r+4];var h=1,d=null,m=null;if(u==28&&(m=c.readShort(i,r+1),h=3),u==29&&(m=c.readInt(i,r+1),h=5),32<=u&&u<=246&&(m=u-139,h=1),247<=u&&u<=250&&(m=256*(u-247)+f+108,h=2),251<=u&&u<=254&&(m=256*-(u-251)-f-108,h=2),u==255)throw m=c.readInt(i,r+1)/65535,h=5,"unknown number";if(u==30){var g=[];for(h=1;;){var v=i[r+h];h++;var C=v>>4,B=15&v;if(C!=15&&g.push(C),B!=15&&g.push(B),B==15)break}for(var y="",b=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],M=0;M<g.length;M++)y+=b[g[M]];m=parseFloat(y)}u<=21&&(d=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],h=1,u==12&&(d=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][f],h=2)),d!=null?(o[d]=l.length==1?l[0]:l,l=[]):l.push(m),r+=h}return o},e.cmap={},e.cmap.parse=function(i,r,a){i=new Uint8Array(i.buffer,r,a),r=0;var c=e._bin,o={};c.readUshort(i,r),r+=2;var l=c.readUshort(i,r);r+=2;var u=[];o.tables=[];for(var f=0;f<l;f++){var h=c.readUshort(i,r);r+=2;var d=c.readUshort(i,r);r+=2;var m=c.readUint(i,r);r+=4;var g="p"+h+"e"+d,v=u.indexOf(m);if(v==-1){var C;v=o.tables.length,u.push(m);var B=c.readUshort(i,m);B==0?C=e.cmap.parse0(i,m):B==4?C=e.cmap.parse4(i,m):B==6?C=e.cmap.parse6(i,m):B==12?C=e.cmap.parse12(i,m):console.debug("unknown format: "+B,h,d,m),o.tables.push(C)}if(o[g]!=null)throw"multiple tables for one platform+encoding";o[g]=v}return o},e.cmap.parse0=function(i,r){var a=e._bin,c={};c.format=a.readUshort(i,r),r+=2;var o=a.readUshort(i,r);r+=2,a.readUshort(i,r),r+=2,c.map=[];for(var l=0;l<o-6;l++)c.map.push(i[r+l]);return c},e.cmap.parse4=function(i,r){var a=e._bin,c=r,o={};o.format=a.readUshort(i,r),r+=2;var l=a.readUshort(i,r);r+=2,a.readUshort(i,r),r+=2;var u=a.readUshort(i,r);r+=2;var f=u/2;o.searchRange=a.readUshort(i,r),r+=2,o.entrySelector=a.readUshort(i,r),r+=2,o.rangeShift=a.readUshort(i,r),r+=2,o.endCount=a.readUshorts(i,r,f),r+=2*f,r+=2,o.startCount=a.readUshorts(i,r,f),r+=2*f,o.idDelta=[];for(var h=0;h<f;h++)o.idDelta.push(a.readShort(i,r)),r+=2;for(o.idRangeOffset=a.readUshorts(i,r,f),r+=2*f,o.glyphIdArray=[];r<c+l;)o.glyphIdArray.push(a.readUshort(i,r)),r+=2;return o},e.cmap.parse6=function(i,r){var a=e._bin,c={};c.format=a.readUshort(i,r),r+=2,a.readUshort(i,r),r+=2,a.readUshort(i,r),r+=2,c.firstCode=a.readUshort(i,r),r+=2;var o=a.readUshort(i,r);r+=2,c.glyphIdArray=[];for(var l=0;l<o;l++)c.glyphIdArray.push(a.readUshort(i,r)),r+=2;return c},e.cmap.parse12=function(i,r){var a=e._bin,c={};c.format=a.readUshort(i,r),r+=2,r+=2,a.readUint(i,r),r+=4,a.readUint(i,r),r+=4;var o=a.readUint(i,r);r+=4,c.groups=[];for(var l=0;l<o;l++){var u=r+12*l,f=a.readUint(i,u+0),h=a.readUint(i,u+4),d=a.readUint(i,u+8);c.groups.push([f,h,d])}return c},e.glyf={},e.glyf.parse=function(i,r,a,c){for(var o=[],l=0;l<c.maxp.numGlyphs;l++)o.push(null);return o},e.glyf._parseGlyf=function(i,r){var a=e._bin,c=i._data,o=e._tabOffset(c,"glyf",i._offset)+i.loca[r];if(i.loca[r]==i.loca[r+1])return null;var l={};if(l.noc=a.readShort(c,o),o+=2,l.xMin=a.readShort(c,o),o+=2,l.yMin=a.readShort(c,o),o+=2,l.xMax=a.readShort(c,o),o+=2,l.yMax=a.readShort(c,o),o+=2,l.xMin>=l.xMax||l.yMin>=l.yMax)return null;if(l.noc>0){l.endPts=[];for(var u=0;u<l.noc;u++)l.endPts.push(a.readUshort(c,o)),o+=2;var f=a.readUshort(c,o);if(o+=2,c.length-o<f)return null;l.instructions=a.readBytes(c,o,f),o+=f;var h=l.endPts[l.noc-1]+1;for(l.flags=[],u=0;u<h;u++){var d=c[o];if(o++,l.flags.push(d),(8&d)!=0){var m=c[o];o++;for(var g=0;g<m;g++)l.flags.push(d),u++}}for(l.xs=[],u=0;u<h;u++){var v=(2&l.flags[u])!=0,C=(16&l.flags[u])!=0;v?(l.xs.push(C?c[o]:-c[o]),o++):C?l.xs.push(0):(l.xs.push(a.readShort(c,o)),o+=2)}for(l.ys=[],u=0;u<h;u++)v=(4&l.flags[u])!=0,C=(32&l.flags[u])!=0,v?(l.ys.push(C?c[o]:-c[o]),o++):C?l.ys.push(0):(l.ys.push(a.readShort(c,o)),o+=2);var B=0,y=0;for(u=0;u<h;u++)B+=l.xs[u],y+=l.ys[u],l.xs[u]=B,l.ys[u]=y}else{var b;l.parts=[];do{b=a.readUshort(c,o),o+=2;var M={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(l.parts.push(M),M.glyphIndex=a.readUshort(c,o),o+=2,1&b){var S=a.readShort(c,o);o+=2;var I=a.readShort(c,o);o+=2}else S=a.readInt8(c,o),o++,I=a.readInt8(c,o),o++;2&b?(M.m.tx=S,M.m.ty=I):(M.p1=S,M.p2=I),8&b?(M.m.a=M.m.d=a.readF2dot14(c,o),o+=2):64&b?(M.m.a=a.readF2dot14(c,o),o+=2,M.m.d=a.readF2dot14(c,o),o+=2):128&b&&(M.m.a=a.readF2dot14(c,o),o+=2,M.m.b=a.readF2dot14(c,o),o+=2,M.m.c=a.readF2dot14(c,o),o+=2,M.m.d=a.readF2dot14(c,o),o+=2)}while(32&b);if(256&b){var E=a.readUshort(c,o);for(o+=2,l.instr=[],u=0;u<E;u++)l.instr.push(c[o]),o++}}return l},e.GDEF={},e.GDEF.parse=function(i,r,a,c){var o=r;r+=4;var l=e._bin.readUshort(i,r);return{glyphClassDef:l===0?null:e._lctf.readClassDef(i,o+l)}},e.GPOS={},e.GPOS.parse=function(i,r,a,c){return e._lctf.parse(i,r,a,c,e.GPOS.subt)},e.GPOS.subt=function(i,r,a,c){var o=e._bin,l=a,u={};if(u.fmt=o.readUshort(i,a),a+=2,r==1||r==2||r==3||r==7||r==8&&u.fmt<=2){var f=o.readUshort(i,a);a+=2,u.coverage=e._lctf.readCoverage(i,f+l)}if(r==1&&u.fmt==1){var h=o.readUshort(i,a);a+=2,h!=0&&(u.pos=e.GPOS.readValueRecord(i,a,h))}else if(r==2&&u.fmt>=1&&u.fmt<=2){h=o.readUshort(i,a),a+=2;var d=o.readUshort(i,a);a+=2;var m=e._lctf.numOfOnes(h),g=e._lctf.numOfOnes(d);if(u.fmt==1){u.pairsets=[];var v=o.readUshort(i,a);a+=2;for(var C=0;C<v;C++){var B=l+o.readUshort(i,a);a+=2;var y=o.readUshort(i,B);B+=2;for(var b=[],M=0;M<y;M++){var S=o.readUshort(i,B);B+=2,h!=0&&(F=e.GPOS.readValueRecord(i,B,h),B+=2*m),d!=0&&(O=e.GPOS.readValueRecord(i,B,d),B+=2*g),b.push({gid2:S,val1:F,val2:O})}u.pairsets.push(b)}}if(u.fmt==2){var I=o.readUshort(i,a);a+=2;var E=o.readUshort(i,a);a+=2;var w=o.readUshort(i,a);a+=2;var G=o.readUshort(i,a);for(a+=2,u.classDef1=e._lctf.readClassDef(i,l+I),u.classDef2=e._lctf.readClassDef(i,l+E),u.matrix=[],C=0;C<w;C++){var W=[];for(M=0;M<G;M++){var F=null,O=null;h!=0&&(F=e.GPOS.readValueRecord(i,a,h),a+=2*m),d!=0&&(O=e.GPOS.readValueRecord(i,a,d),a+=2*g),W.push({val1:F,val2:O})}u.matrix.push(W)}}}else if(r==4&&u.fmt==1)u.markCoverage=e._lctf.readCoverage(i,o.readUshort(i,a)+l),u.baseCoverage=e._lctf.readCoverage(i,o.readUshort(i,a+2)+l),u.markClassCount=o.readUshort(i,a+4),u.markArray=e.GPOS.readMarkArray(i,o.readUshort(i,a+6)+l),u.baseArray=e.GPOS.readBaseArray(i,o.readUshort(i,a+8)+l,u.markClassCount);else if(r==6&&u.fmt==1)u.mark1Coverage=e._lctf.readCoverage(i,o.readUshort(i,a)+l),u.mark2Coverage=e._lctf.readCoverage(i,o.readUshort(i,a+2)+l),u.markClassCount=o.readUshort(i,a+4),u.mark1Array=e.GPOS.readMarkArray(i,o.readUshort(i,a+6)+l),u.mark2Array=e.GPOS.readBaseArray(i,o.readUshort(i,a+8)+l,u.markClassCount);else{if(r==9&&u.fmt==1){var D=o.readUshort(i,a);a+=2;var X=o.readUint(i,a);if(a+=4,c.ltype==9)c.ltype=D;else if(c.ltype!=D)throw"invalid extension substitution";return e.GPOS.subt(i,c.ltype,l+X)}console.debug("unsupported GPOS table LookupType",r,"format",u.fmt)}return u},e.GPOS.readValueRecord=function(i,r,a){var c=e._bin,o=[];return o.push(1&a?c.readShort(i,r):0),r+=1&a?2:0,o.push(2&a?c.readShort(i,r):0),r+=2&a?2:0,o.push(4&a?c.readShort(i,r):0),r+=4&a?2:0,o.push(8&a?c.readShort(i,r):0),r+=8&a?2:0,o},e.GPOS.readBaseArray=function(i,r,a){var c=e._bin,o=[],l=r,u=c.readUshort(i,r);r+=2;for(var f=0;f<u;f++){for(var h=[],d=0;d<a;d++)h.push(e.GPOS.readAnchorRecord(i,l+c.readUshort(i,r))),r+=2;o.push(h)}return o},e.GPOS.readMarkArray=function(i,r){var a=e._bin,c=[],o=r,l=a.readUshort(i,r);r+=2;for(var u=0;u<l;u++){var f=e.GPOS.readAnchorRecord(i,a.readUshort(i,r+2)+o);f.markClass=a.readUshort(i,r),c.push(f),r+=4}return c},e.GPOS.readAnchorRecord=function(i,r){var a=e._bin,c={};return c.fmt=a.readUshort(i,r),c.x=a.readShort(i,r+2),c.y=a.readShort(i,r+4),c},e.GSUB={},e.GSUB.parse=function(i,r,a,c){return e._lctf.parse(i,r,a,c,e.GSUB.subt)},e.GSUB.subt=function(i,r,a,c){var o=e._bin,l=a,u={};if(u.fmt=o.readUshort(i,a),a+=2,r!=1&&r!=2&&r!=4&&r!=5&&r!=6)return null;if(r==1||r==2||r==4||r==5&&u.fmt<=2||r==6&&u.fmt<=2){var f=o.readUshort(i,a);a+=2,u.coverage=e._lctf.readCoverage(i,l+f)}if(r==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=o.readShort(i,a),a+=2;else if(u.fmt==2){var h=o.readUshort(i,a);a+=2,u.newg=o.readUshorts(i,a,h),a+=2*u.newg.length}}else if(r==2&&u.fmt==1){h=o.readUshort(i,a),a+=2,u.seqs=[];for(var d=0;d<h;d++){var m=o.readUshort(i,a)+l;a+=2;var g=o.readUshort(i,m);u.seqs.push(o.readUshorts(i,m+2,g))}}else if(r==4)for(u.vals=[],h=o.readUshort(i,a),a+=2,d=0;d<h;d++){var v=o.readUshort(i,a);a+=2,u.vals.push(e.GSUB.readLigatureSet(i,l+v))}else if(r==5&&u.fmt==2){if(u.fmt==2){var C=o.readUshort(i,a);a+=2,u.cDef=e._lctf.readClassDef(i,l+C),u.scset=[];var B=o.readUshort(i,a);for(a+=2,d=0;d<B;d++){var y=o.readUshort(i,a);a+=2,u.scset.push(y==0?null:e.GSUB.readSubClassSet(i,l+y))}}}else if(r==6&&u.fmt==3){if(u.fmt==3){for(d=0;d<3;d++){h=o.readUshort(i,a),a+=2;for(var b=[],M=0;M<h;M++)b.push(e._lctf.readCoverage(i,l+o.readUshort(i,a+2*M)));a+=2*h,d==0&&(u.backCvg=b),d==1&&(u.inptCvg=b),d==2&&(u.ahedCvg=b)}h=o.readUshort(i,a),a+=2,u.lookupRec=e.GSUB.readSubstLookupRecords(i,a,h)}}else{if(r==7&&u.fmt==1){var S=o.readUshort(i,a);a+=2;var I=o.readUint(i,a);if(a+=4,c.ltype==9)c.ltype=S;else if(c.ltype!=S)throw"invalid extension substitution";return e.GSUB.subt(i,c.ltype,l+I)}console.debug("unsupported GSUB table LookupType",r,"format",u.fmt)}return u},e.GSUB.readSubClassSet=function(i,r){var a=e._bin.readUshort,c=r,o=[],l=a(i,r);r+=2;for(var u=0;u<l;u++){var f=a(i,r);r+=2,o.push(e.GSUB.readSubClassRule(i,c+f))}return o},e.GSUB.readSubClassRule=function(i,r){var a=e._bin.readUshort,c={},o=a(i,r),l=a(i,r+=2);r+=2,c.input=[];for(var u=0;u<o-1;u++)c.input.push(a(i,r)),r+=2;return c.substLookupRecords=e.GSUB.readSubstLookupRecords(i,r,l),c},e.GSUB.readSubstLookupRecords=function(i,r,a){for(var c=e._bin.readUshort,o=[],l=0;l<a;l++)o.push(c(i,r),c(i,r+2)),r+=4;return o},e.GSUB.readChainSubClassSet=function(i,r){var a=e._bin,c=r,o=[],l=a.readUshort(i,r);r+=2;for(var u=0;u<l;u++){var f=a.readUshort(i,r);r+=2,o.push(e.GSUB.readChainSubClassRule(i,c+f))}return o},e.GSUB.readChainSubClassRule=function(i,r){for(var a=e._bin,c={},o=["backtrack","input","lookahead"],l=0;l<o.length;l++){var u=a.readUshort(i,r);r+=2,l==1&&u--,c[o[l]]=a.readUshorts(i,r,u),r+=2*c[o[l]].length}return u=a.readUshort(i,r),r+=2,c.subst=a.readUshorts(i,r,2*u),r+=2*c.subst.length,c},e.GSUB.readLigatureSet=function(i,r){var a=e._bin,c=r,o=[],l=a.readUshort(i,r);r+=2;for(var u=0;u<l;u++){var f=a.readUshort(i,r);r+=2,o.push(e.GSUB.readLigature(i,c+f))}return o},e.GSUB.readLigature=function(i,r){var a=e._bin,c={chain:[]};c.nglyph=a.readUshort(i,r),r+=2;var o=a.readUshort(i,r);r+=2;for(var l=0;l<o-1;l++)c.chain.push(a.readUshort(i,r)),r+=2;return c},e.head={},e.head.parse=function(i,r,a){var c=e._bin,o={};return c.readFixed(i,r),r+=4,o.fontRevision=c.readFixed(i,r),r+=4,c.readUint(i,r),r+=4,c.readUint(i,r),r+=4,o.flags=c.readUshort(i,r),r+=2,o.unitsPerEm=c.readUshort(i,r),r+=2,o.created=c.readUint64(i,r),r+=8,o.modified=c.readUint64(i,r),r+=8,o.xMin=c.readShort(i,r),r+=2,o.yMin=c.readShort(i,r),r+=2,o.xMax=c.readShort(i,r),r+=2,o.yMax=c.readShort(i,r),r+=2,o.macStyle=c.readUshort(i,r),r+=2,o.lowestRecPPEM=c.readUshort(i,r),r+=2,o.fontDirectionHint=c.readShort(i,r),r+=2,o.indexToLocFormat=c.readShort(i,r),r+=2,o.glyphDataFormat=c.readShort(i,r),r+=2,o},e.hhea={},e.hhea.parse=function(i,r,a){var c=e._bin,o={};return c.readFixed(i,r),r+=4,o.ascender=c.readShort(i,r),r+=2,o.descender=c.readShort(i,r),r+=2,o.lineGap=c.readShort(i,r),r+=2,o.advanceWidthMax=c.readUshort(i,r),r+=2,o.minLeftSideBearing=c.readShort(i,r),r+=2,o.minRightSideBearing=c.readShort(i,r),r+=2,o.xMaxExtent=c.readShort(i,r),r+=2,o.caretSlopeRise=c.readShort(i,r),r+=2,o.caretSlopeRun=c.readShort(i,r),r+=2,o.caretOffset=c.readShort(i,r),r+=2,r+=8,o.metricDataFormat=c.readShort(i,r),r+=2,o.numberOfHMetrics=c.readUshort(i,r),r+=2,o},e.hmtx={},e.hmtx.parse=function(i,r,a,c){for(var o=e._bin,l={aWidth:[],lsBearing:[]},u=0,f=0,h=0;h<c.maxp.numGlyphs;h++)h<c.hhea.numberOfHMetrics&&(u=o.readUshort(i,r),r+=2,f=o.readShort(i,r),r+=2),l.aWidth.push(u),l.lsBearing.push(f);return l},e.kern={},e.kern.parse=function(i,r,a,c){var o=e._bin,l=o.readUshort(i,r);if(r+=2,l==1)return e.kern.parseV1(i,r-2,a,c);var u=o.readUshort(i,r);r+=2;for(var f={glyph1:[],rval:[]},h=0;h<u;h++){r+=2,a=o.readUshort(i,r),r+=2;var d=o.readUshort(i,r);r+=2;var m=d>>>8;if((m&=15)!=0)throw"unknown kern table format: "+m;r=e.kern.readFormat0(i,r,f)}return f},e.kern.parseV1=function(i,r,a,c){var o=e._bin;o.readFixed(i,r),r+=4;var l=o.readUint(i,r);r+=4;for(var u={glyph1:[],rval:[]},f=0;f<l;f++){o.readUint(i,r),r+=4;var h=o.readUshort(i,r);r+=2,o.readUshort(i,r),r+=2;var d=h>>>8;if((d&=15)!=0)throw"unknown kern table format: "+d;r=e.kern.readFormat0(i,r,u)}return u},e.kern.readFormat0=function(i,r,a){var c=e._bin,o=-1,l=c.readUshort(i,r);r+=2,c.readUshort(i,r),r+=2,c.readUshort(i,r),r+=2,c.readUshort(i,r),r+=2;for(var u=0;u<l;u++){var f=c.readUshort(i,r);r+=2;var h=c.readUshort(i,r);r+=2;var d=c.readShort(i,r);r+=2,f!=o&&(a.glyph1.push(f),a.rval.push({glyph2:[],vals:[]}));var m=a.rval[a.rval.length-1];m.glyph2.push(h),m.vals.push(d),o=f}return r},e.loca={},e.loca.parse=function(i,r,a,c){var o=e._bin,l=[],u=c.head.indexToLocFormat,f=c.maxp.numGlyphs+1;if(u==0)for(var h=0;h<f;h++)l.push(o.readUshort(i,r+(h<<1))<<1);if(u==1)for(h=0;h<f;h++)l.push(o.readUint(i,r+(h<<2)));return l},e.maxp={},e.maxp.parse=function(i,r,a){var c=e._bin,o={},l=c.readUint(i,r);return r+=4,o.numGlyphs=c.readUshort(i,r),r+=2,l==65536&&(o.maxPoints=c.readUshort(i,r),r+=2,o.maxContours=c.readUshort(i,r),r+=2,o.maxCompositePoints=c.readUshort(i,r),r+=2,o.maxCompositeContours=c.readUshort(i,r),r+=2,o.maxZones=c.readUshort(i,r),r+=2,o.maxTwilightPoints=c.readUshort(i,r),r+=2,o.maxStorage=c.readUshort(i,r),r+=2,o.maxFunctionDefs=c.readUshort(i,r),r+=2,o.maxInstructionDefs=c.readUshort(i,r),r+=2,o.maxStackElements=c.readUshort(i,r),r+=2,o.maxSizeOfInstructions=c.readUshort(i,r),r+=2,o.maxComponentElements=c.readUshort(i,r),r+=2,o.maxComponentDepth=c.readUshort(i,r),r+=2),o},e.name={},e.name.parse=function(i,r,a){var c=e._bin,o={};c.readUshort(i,r),r+=2;var l=c.readUshort(i,r);r+=2,c.readUshort(i,r);for(var u,f=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],h=r+=2,d=0;d<l;d++){var m=c.readUshort(i,r);r+=2;var g=c.readUshort(i,r);r+=2;var v=c.readUshort(i,r);r+=2;var C=c.readUshort(i,r);r+=2;var B=c.readUshort(i,r);r+=2;var y=c.readUshort(i,r);r+=2;var b,M=f[C],S=h+12*l+y;if(m==0)b=c.readUnicode(i,S,B/2);else if(m==3&&g==0)b=c.readUnicode(i,S,B/2);else if(g==0)b=c.readASCII(i,S,B);else if(g==1)b=c.readUnicode(i,S,B/2);else if(g==3)b=c.readUnicode(i,S,B/2);else{if(m!=1)throw"unknown encoding "+g+", platformID: "+m;b=c.readASCII(i,S,B),console.debug("reading unknown MAC encoding "+g+" as ASCII")}var I="p"+m+","+v.toString(16);o[I]==null&&(o[I]={}),o[I][M!==void 0?M:C]=b,o[I]._lang=v}for(var E in o)if(o[E].postScriptName!=null&&o[E]._lang==1033)return o[E];for(var E in o)if(o[E].postScriptName!=null&&o[E]._lang==0)return o[E];for(var E in o)if(o[E].postScriptName!=null&&o[E]._lang==3084)return o[E];for(var E in o)if(o[E].postScriptName!=null)return o[E];for(var E in o){u=E;break}return console.debug("returning name table with languageID "+o[u]._lang),o[u]},e["OS/2"]={},e["OS/2"].parse=function(i,r,a){var c=e._bin.readUshort(i,r);r+=2;var o={};if(c==0)e["OS/2"].version0(i,r,o);else if(c==1)e["OS/2"].version1(i,r,o);else if(c==2||c==3||c==4)e["OS/2"].version2(i,r,o);else{if(c!=5)throw"unknown OS/2 table version: "+c;e["OS/2"].version5(i,r,o)}return o},e["OS/2"].version0=function(i,r,a){var c=e._bin;return a.xAvgCharWidth=c.readShort(i,r),r+=2,a.usWeightClass=c.readUshort(i,r),r+=2,a.usWidthClass=c.readUshort(i,r),r+=2,a.fsType=c.readUshort(i,r),r+=2,a.ySubscriptXSize=c.readShort(i,r),r+=2,a.ySubscriptYSize=c.readShort(i,r),r+=2,a.ySubscriptXOffset=c.readShort(i,r),r+=2,a.ySubscriptYOffset=c.readShort(i,r),r+=2,a.ySuperscriptXSize=c.readShort(i,r),r+=2,a.ySuperscriptYSize=c.readShort(i,r),r+=2,a.ySuperscriptXOffset=c.readShort(i,r),r+=2,a.ySuperscriptYOffset=c.readShort(i,r),r+=2,a.yStrikeoutSize=c.readShort(i,r),r+=2,a.yStrikeoutPosition=c.readShort(i,r),r+=2,a.sFamilyClass=c.readShort(i,r),r+=2,a.panose=c.readBytes(i,r,10),r+=10,a.ulUnicodeRange1=c.readUint(i,r),r+=4,a.ulUnicodeRange2=c.readUint(i,r),r+=4,a.ulUnicodeRange3=c.readUint(i,r),r+=4,a.ulUnicodeRange4=c.readUint(i,r),r+=4,a.achVendID=[c.readInt8(i,r),c.readInt8(i,r+1),c.readInt8(i,r+2),c.readInt8(i,r+3)],r+=4,a.fsSelection=c.readUshort(i,r),r+=2,a.usFirstCharIndex=c.readUshort(i,r),r+=2,a.usLastCharIndex=c.readUshort(i,r),r+=2,a.sTypoAscender=c.readShort(i,r),r+=2,a.sTypoDescender=c.readShort(i,r),r+=2,a.sTypoLineGap=c.readShort(i,r),r+=2,a.usWinAscent=c.readUshort(i,r),r+=2,a.usWinDescent=c.readUshort(i,r),r+=2},e["OS/2"].version1=function(i,r,a){var c=e._bin;return r=e["OS/2"].version0(i,r,a),a.ulCodePageRange1=c.readUint(i,r),r+=4,a.ulCodePageRange2=c.readUint(i,r),r+=4},e["OS/2"].version2=function(i,r,a){var c=e._bin;return r=e["OS/2"].version1(i,r,a),a.sxHeight=c.readShort(i,r),r+=2,a.sCapHeight=c.readShort(i,r),r+=2,a.usDefault=c.readUshort(i,r),r+=2,a.usBreak=c.readUshort(i,r),r+=2,a.usMaxContext=c.readUshort(i,r),r+=2},e["OS/2"].version5=function(i,r,a){var c=e._bin;return r=e["OS/2"].version2(i,r,a),a.usLowerOpticalPointSize=c.readUshort(i,r),r+=2,a.usUpperOpticalPointSize=c.readUshort(i,r),r+=2},e.post={},e.post.parse=function(i,r,a){var c=e._bin,o={};return o.version=c.readFixed(i,r),r+=4,o.italicAngle=c.readFixed(i,r),r+=4,o.underlinePosition=c.readShort(i,r),r+=2,o.underlineThickness=c.readShort(i,r),r+=2,o},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(i,r){var a=i.cmap,c=-1;if(a.p0e4!=null?c=a.p0e4:a.p3e1!=null?c=a.p3e1:a.p1e0!=null?c=a.p1e0:a.p0e3!=null&&(c=a.p0e3),c==-1)throw"no familiar platform and encoding!";var o=a.tables[c];if(o.format==0)return r>=o.map.length?0:o.map[r];if(o.format==4){for(var l=-1,u=0;u<o.endCount.length;u++)if(r<=o.endCount[u]){l=u;break}return l==-1||o.startCount[l]>r?0:65535&(o.idRangeOffset[l]!=0?o.glyphIdArray[r-o.startCount[l]+(o.idRangeOffset[l]>>1)-(o.idRangeOffset.length-l)]:r+o.idDelta[l])}if(o.format==12){if(r>o.groups[o.groups.length-1][1])return 0;for(u=0;u<o.groups.length;u++){var f=o.groups[u];if(f[0]<=r&&r<=f[1])return f[2]+(r-f[0])}return 0}throw"unknown cmap table format "+o.format},e.U.glyphToPath=function(i,r){var a={cmds:[],crds:[]};if(i.SVG&&i.SVG.entries[r]){var c=i.SVG.entries[r];return c==null?a:(typeof c=="string"&&(c=e.SVG.toPath(c),i.SVG.entries[r]=c),c)}if(i.CFF){var o={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:i.CFF.Private?i.CFF.Private.defaultWidthX:0,open:!1},l=i.CFF,u=i.CFF.Private;if(l.ROS){for(var f=0;l.FDSelect[f+2]<=r;)f+=2;u=l.FDArray[l.FDSelect[f+1]].Private}e.U._drawCFF(i.CFF.CharStrings[r],o,l,u,a)}else i.glyf&&e.U._drawGlyf(r,i,a);return a},e.U._drawGlyf=function(i,r,a){var c=r.glyf[i];c==null&&(c=r.glyf[i]=e.glyf._parseGlyf(r,i)),c!=null&&(c.noc>-1?e.U._simpleGlyph(c,a):e.U._compoGlyph(c,r,a))},e.U._simpleGlyph=function(i,r){for(var a=0;a<i.noc;a++){for(var c=a==0?0:i.endPts[a-1]+1,o=i.endPts[a],l=c;l<=o;l++){var u=l==c?o:l-1,f=l==o?c:l+1,h=1&i.flags[l],d=1&i.flags[u],m=1&i.flags[f],g=i.xs[l],v=i.ys[l];if(l==c)if(h){if(!d){e.U.P.moveTo(r,g,v);continue}e.U.P.moveTo(r,i.xs[u],i.ys[u])}else d?e.U.P.moveTo(r,i.xs[u],i.ys[u]):e.U.P.moveTo(r,(i.xs[u]+g)/2,(i.ys[u]+v)/2);h?d&&e.U.P.lineTo(r,g,v):m?e.U.P.qcurveTo(r,g,v,i.xs[f],i.ys[f]):e.U.P.qcurveTo(r,g,v,(g+i.xs[f])/2,(v+i.ys[f])/2)}e.U.P.closePath(r)}},e.U._compoGlyph=function(i,r,a){for(var c=0;c<i.parts.length;c++){var o={cmds:[],crds:[]},l=i.parts[c];e.U._drawGlyf(l.glyphIndex,r,o);for(var u=l.m,f=0;f<o.crds.length;f+=2){var h=o.crds[f],d=o.crds[f+1];a.crds.push(h*u.a+d*u.b+u.tx),a.crds.push(h*u.c+d*u.d+u.ty)}for(f=0;f<o.cmds.length;f++)a.cmds.push(o.cmds[f])}},e.U._getGlyphClass=function(i,r){var a=e._lctf.getInterval(r,i);return a==-1?0:r[a+2]},e.U._applySubs=function(i,r,a,c){for(var o=i.length-r-1,l=0;l<a.tabs.length;l++)if(a.tabs[l]!=null){var u,f=a.tabs[l];if(!f.coverage||(u=e._lctf.coverageIndex(f.coverage,i[r]))!=-1){if(a.ltype==1)i[r],f.fmt==1?i[r]=i[r]+f.delta:i[r]=f.newg[u];else if(a.ltype==4)for(var h=f.vals[u],d=0;d<h.length;d++){var m=h[d],g=m.chain.length;if(!(g>o)){for(var v=!0,C=0,B=0;B<g;B++){for(;i[r+C+(1+B)]==-1;)C++;m.chain[B]!=i[r+C+(1+B)]&&(v=!1)}if(v){for(i[r]=m.nglyph,B=0;B<g+C;B++)i[r+B+1]=-1;break}}}else if(a.ltype==5&&f.fmt==2)for(var y=e._lctf.getInterval(f.cDef,i[r]),b=f.cDef[y+2],M=f.scset[b],S=0;S<M.length;S++){var I=M[S],E=I.input;if(!(E.length>o)){for(v=!0,B=0;B<E.length;B++){var w=e._lctf.getInterval(f.cDef,i[r+1+B]);if(y==-1&&f.cDef[w+2]!=E[B]){v=!1;break}}if(v){var G=I.substLookupRecords;for(d=0;d<G.length;d+=2)G[d],G[d+1]}}}else if(a.ltype==6&&f.fmt==3){if(!e.U._glsCovered(i,f.backCvg,r-f.backCvg.length)||!e.U._glsCovered(i,f.inptCvg,r)||!e.U._glsCovered(i,f.ahedCvg,r+f.inptCvg.length))continue;var W=f.lookupRec;for(S=0;S<W.length;S+=2){y=W[S];var F=c[W[S+1]];e.U._applySubs(i,r+y,F,c)}}}}},e.U._glsCovered=function(i,r,a){for(var c=0;c<r.length;c++)if(e._lctf.coverageIndex(r[c],i[a+c])==-1)return!1;return!0},e.U.glyphsToPath=function(i,r,a){for(var c={cmds:[],crds:[]},o=0,l=0;l<r.length;l++){var u=r[l];if(u!=-1){for(var f=l<r.length-1&&r[l+1]!=-1?r[l+1]:0,h=e.U.glyphToPath(i,u),d=0;d<h.crds.length;d+=2)c.crds.push(h.crds[d]+o),c.crds.push(h.crds[d+1]);for(a&&c.cmds.push(a),d=0;d<h.cmds.length;d++)c.cmds.push(h.cmds[d]);a&&c.cmds.push("X"),o+=i.hmtx.aWidth[u],l<r.length-1&&(o+=e.U.getPairAdjustment(i,u,f))}}return c},e.U.P={},e.U.P.moveTo=function(i,r,a){i.cmds.push("M"),i.crds.push(r,a)},e.U.P.lineTo=function(i,r,a){i.cmds.push("L"),i.crds.push(r,a)},e.U.P.curveTo=function(i,r,a,c,o,l,u){i.cmds.push("C"),i.crds.push(r,a,c,o,l,u)},e.U.P.qcurveTo=function(i,r,a,c,o){i.cmds.push("Q"),i.crds.push(r,a,c,o)},e.U.P.closePath=function(i){i.cmds.push("Z")},e.U._drawCFF=function(i,r,a,c,o){for(var l=r.stack,u=r.nStems,f=r.haveWidth,h=r.width,d=r.open,m=0,g=r.x,v=r.y,C=0,B=0,y=0,b=0,M=0,S=0,I=0,E=0,w=0,G=0,W={val:0,size:0};m<i.length;){e.CFF.getCharString(i,m,W);var F=W.val;if(m+=W.size,F=="o1"||F=="o18")l.length%2!=0&&!f&&(h=l.shift()+c.nominalWidthX),u+=l.length>>1,l.length=0,f=!0;else if(F=="o3"||F=="o23")l.length%2!=0&&!f&&(h=l.shift()+c.nominalWidthX),u+=l.length>>1,l.length=0,f=!0;else if(F=="o4")l.length>1&&!f&&(h=l.shift()+c.nominalWidthX,f=!0),d&&e.U.P.closePath(o),v+=l.pop(),e.U.P.moveTo(o,g,v),d=!0;else if(F=="o5")for(;l.length>0;)g+=l.shift(),v+=l.shift(),e.U.P.lineTo(o,g,v);else if(F=="o6"||F=="o7")for(var O=l.length,D=F=="o6",X=0;X<O;X++){var J=l.shift();D?g+=J:v+=J,D=!D,e.U.P.lineTo(o,g,v)}else if(F=="o8"||F=="o24"){O=l.length;for(var ie=0;ie+6<=O;)C=g+l.shift(),B=v+l.shift(),y=C+l.shift(),b=B+l.shift(),g=y+l.shift(),v=b+l.shift(),e.U.P.curveTo(o,C,B,y,b,g,v),ie+=6;F=="o24"&&(g+=l.shift(),v+=l.shift(),e.U.P.lineTo(o,g,v))}else{if(F=="o11")break;if(F=="o1234"||F=="o1235"||F=="o1236"||F=="o1237")F=="o1234"&&(B=v,y=(C=g+l.shift())+l.shift(),G=b=B+l.shift(),S=b,E=v,g=(I=(M=(w=y+l.shift())+l.shift())+l.shift())+l.shift(),e.U.P.curveTo(o,C,B,y,b,w,G),e.U.P.curveTo(o,M,S,I,E,g,v)),F=="o1235"&&(C=g+l.shift(),B=v+l.shift(),y=C+l.shift(),b=B+l.shift(),w=y+l.shift(),G=b+l.shift(),M=w+l.shift(),S=G+l.shift(),I=M+l.shift(),E=S+l.shift(),g=I+l.shift(),v=E+l.shift(),l.shift(),e.U.P.curveTo(o,C,B,y,b,w,G),e.U.P.curveTo(o,M,S,I,E,g,v)),F=="o1236"&&(C=g+l.shift(),B=v+l.shift(),y=C+l.shift(),G=b=B+l.shift(),S=b,I=(M=(w=y+l.shift())+l.shift())+l.shift(),E=S+l.shift(),g=I+l.shift(),e.U.P.curveTo(o,C,B,y,b,w,G),e.U.P.curveTo(o,M,S,I,E,g,v)),F=="o1237"&&(C=g+l.shift(),B=v+l.shift(),y=C+l.shift(),b=B+l.shift(),w=y+l.shift(),G=b+l.shift(),M=w+l.shift(),S=G+l.shift(),I=M+l.shift(),E=S+l.shift(),Math.abs(I-g)>Math.abs(E-v)?g=I+l.shift():v=E+l.shift(),e.U.P.curveTo(o,C,B,y,b,w,G),e.U.P.curveTo(o,M,S,I,E,g,v));else if(F=="o14"){if(l.length>0&&!f&&(h=l.shift()+a.nominalWidthX,f=!0),l.length==4){var Ae=l.shift(),z=l.shift(),L=l.shift(),T=l.shift(),R=e.CFF.glyphBySE(a,L),x=e.CFF.glyphBySE(a,T);e.U._drawCFF(a.CharStrings[R],r,a,c,o),r.x=Ae,r.y=z,e.U._drawCFF(a.CharStrings[x],r,a,c,o)}d&&(e.U.P.closePath(o),d=!1)}else if(F=="o19"||F=="o20")l.length%2!=0&&!f&&(h=l.shift()+c.nominalWidthX),u+=l.length>>1,l.length=0,f=!0,m+=u+7>>3;else if(F=="o21")l.length>2&&!f&&(h=l.shift()+c.nominalWidthX,f=!0),v+=l.pop(),g+=l.pop(),d&&e.U.P.closePath(o),e.U.P.moveTo(o,g,v),d=!0;else if(F=="o22")l.length>1&&!f&&(h=l.shift()+c.nominalWidthX,f=!0),g+=l.pop(),d&&e.U.P.closePath(o),e.U.P.moveTo(o,g,v),d=!0;else if(F=="o25"){for(;l.length>6;)g+=l.shift(),v+=l.shift(),e.U.P.lineTo(o,g,v);C=g+l.shift(),B=v+l.shift(),y=C+l.shift(),b=B+l.shift(),g=y+l.shift(),v=b+l.shift(),e.U.P.curveTo(o,C,B,y,b,g,v)}else if(F=="o26")for(l.length%2&&(g+=l.shift());l.length>0;)C=g,B=v+l.shift(),g=y=C+l.shift(),v=(b=B+l.shift())+l.shift(),e.U.P.curveTo(o,C,B,y,b,g,v);else if(F=="o27")for(l.length%2&&(v+=l.shift());l.length>0;)B=v,y=(C=g+l.shift())+l.shift(),b=B+l.shift(),g=y+l.shift(),v=b,e.U.P.curveTo(o,C,B,y,b,g,v);else if(F=="o10"||F=="o29"){var j=F=="o10"?c:a;if(l.length==0)console.debug("error: empty stack");else{var k=l.pop(),Q=j.Subrs[k+j.Bias];r.x=g,r.y=v,r.nStems=u,r.haveWidth=f,r.width=h,r.open=d,e.U._drawCFF(Q,r,a,c,o),g=r.x,v=r.y,u=r.nStems,f=r.haveWidth,h=r.width,d=r.open}}else if(F=="o30"||F=="o31"){var V=l.length,Y=(ie=0,F=="o31");for(ie+=V-(O=-3&V);ie<O;)Y?(B=v,y=(C=g+l.shift())+l.shift(),v=(b=B+l.shift())+l.shift(),O-ie==5?(g=y+l.shift(),ie++):g=y,Y=!1):(C=g,B=v+l.shift(),y=C+l.shift(),b=B+l.shift(),g=y+l.shift(),O-ie==5?(v=b+l.shift(),ie++):v=b,Y=!0),e.U.P.curveTo(o,C,B,y,b,g,v),ie+=4}else{if((F+"").charAt(0)=="o")throw console.debug("Unknown operation: "+F,i),F;l.push(F)}}}r.x=g,r.y=v,r.nStems=u,r.haveWidth=f,r.width=h,r.open=d};var n=e,s={Typr:n};return t.Typr=n,t.default=s,Object.defineProperty(t,"__esModule",{value:!0}),t}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Ep(){return function(t){var e=Uint8Array,n=Uint16Array,s=Uint32Array,i=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),r=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(F,O){for(var D=new n(31),X=0;X<31;++X)D[X]=O+=1<<F[X-1];var J=new s(D[30]);for(X=1;X<30;++X)for(var ie=D[X];ie<D[X+1];++ie)J[ie]=ie-D[X]<<5|X;return[D,J]},o=c(i,2),l=o[0],u=o[1];l[28]=258,u[258]=28;for(var f=c(r,0)[0],h=new n(32768),d=0;d<32768;++d){var m=(43690&d)>>>1|(21845&d)<<1;m=(61680&(m=(52428&m)>>>2|(13107&m)<<2))>>>4|(3855&m)<<4,h[d]=((65280&m)>>>8|(255&m)<<8)>>>1}var g=function(F,O,D){for(var X=F.length,J=0,ie=new n(O);J<X;++J)++ie[F[J]-1];var Ae,z=new n(O);for(J=0;J<O;++J)z[J]=z[J-1]+ie[J-1]<<1;{Ae=new n(1<<O);var L=15-O;for(J=0;J<X;++J)if(F[J])for(var T=J<<4|F[J],R=O-F[J],x=z[F[J]-1]++<<R,j=x|(1<<R)-1;x<=j;++x)Ae[h[x]>>>L]=T}return Ae},v=new e(288);for(d=0;d<144;++d)v[d]=8;for(d=144;d<256;++d)v[d]=9;for(d=256;d<280;++d)v[d]=7;for(d=280;d<288;++d)v[d]=8;var C=new e(32);for(d=0;d<32;++d)C[d]=5;var B=g(v,9),y=g(C,5),b=function(F){for(var O=F[0],D=1;D<F.length;++D)F[D]>O&&(O=F[D]);return O},M=function(F,O,D){var X=O/8|0;return(F[X]|F[X+1]<<8)>>(7&O)&D},S=function(F,O){var D=O/8|0;return(F[D]|F[D+1]<<8|F[D+2]<<16)>>(7&O)},I=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(F,O,D){var X=new Error(O||I[F]);if(X.code=F,Error.captureStackTrace&&Error.captureStackTrace(X,E),!D)throw X;return X},w=function(F,O,D){var X=F.length;if(!X||D&&!D.l&&X<5)return O||new e(0);var J=!O||D,ie=!D||D.i;D||(D={}),O||(O=new e(3*X));var Ae,z=function(Te){var Ze=O.length;if(Te>Ze){var He=new e(Math.max(2*Ze,Te));He.set(O),O=He}},L=D.f||0,T=D.p||0,R=D.b||0,x=D.l,j=D.d,k=D.m,Q=D.n,V=8*X;do{if(!x){D.f=L=M(F,T,1);var Y=M(F,T+1,3);if(T+=3,!Y){var fe=F[(me=((Ae=T)/8|0)+(7&Ae&&1)+4)-4]|F[me-3]<<8,le=me+fe;if(le>X){ie&&E(0);break}J&&z(R+fe),O.set(F.subarray(me,le),R),D.b=R+=fe,D.p=T=8*le;continue}if(Y==1)x=B,j=y,k=9,Q=5;else if(Y==2){var q=M(F,T,31)+257,ee=M(F,T+10,15)+4,we=q+M(F,T+5,31)+1;T+=14;for(var _e=new e(we),he=new e(19),Be=0;Be<ee;++Be)he[a[Be]]=M(F,T+3*Be,7);T+=3*ee;var ve=b(he),ne=(1<<ve)-1,ge=g(he,ve);for(Be=0;Be<we;){var me,$=ge[M(F,T,ne)];if(T+=15&$,(me=$>>>4)<16)_e[Be++]=me;else{var Se=0,de=0;for(me==16?(de=3+M(F,T,3),T+=2,Se=_e[Be-1]):me==17?(de=3+M(F,T,7),T+=3):me==18&&(de=11+M(F,T,127),T+=7);de--;)_e[Be++]=Se}}var ye=_e.subarray(0,q),ue=_e.subarray(q);k=b(ye),Q=b(ue),x=g(ye,k),j=g(ue,Q)}else E(1);if(T>V){ie&&E(0);break}}J&&z(R+131072);for(var Ke=(1<<k)-1,pe=(1<<Q)-1,be=T;;be=T){var Me=(Se=x[S(F,T)&Ke])>>>4;if((T+=15&Se)>V){ie&&E(0);break}if(Se||E(2),Me<256)O[R++]=Me;else{if(Me==256){be=T,x=null;break}var Ge=Me-254;if(Me>264){var et=i[Be=Me-257];Ge=M(F,T,(1<<et)-1)+l[Be],T+=et}var st=j[S(F,T)&pe],Ue=st>>>4;if(st||E(3),T+=15&st,ue=f[Ue],Ue>3&&(et=r[Ue],ue+=S(F,T)&(1<<et)-1,T+=et),T>V){ie&&E(0);break}J&&z(R+131072);for(var Fe=R+Ge;R<Fe;R+=4)O[R]=O[R-ue],O[R+1]=O[R+1-ue],O[R+2]=O[R+2-ue],O[R+3]=O[R+3-ue];R=Fe}}D.l=x,D.p=be,D.b=R,x&&(L=1,D.m=k,D.d=j,D.n=Q)}while(!L);return R==O.length?O:function(Te,Ze,He){(He==null||He>Te.length)&&(He=Te.length);var je=new(Te instanceof n?n:Te instanceof s?s:e)(He-Ze);return je.set(Te.subarray(Ze,He)),je}(O,0,R)},G=new e(0),W=typeof TextDecoder<"u"&&new TextDecoder;try{W.decode(G,{stream:!0})}catch{}return t.convert_streams=function(F){var O=new DataView(F),D=0;function X(){var q=O.getUint16(D);return D+=2,q}function J(){var q=O.getUint32(D);return D+=4,q}function ie(q){fe.setUint16(le,q),le+=2}function Ae(q){fe.setUint32(le,q),le+=4}for(var z={signature:J(),flavor:J(),length:J(),numTables:X(),reserved:X(),totalSfntSize:J(),majorVersion:X(),minorVersion:X(),metaOffset:J(),metaLength:J(),metaOrigLength:J(),privOffset:J(),privLength:J()},L=0;Math.pow(2,L)<=z.numTables;)L++;L--;for(var T=16*Math.pow(2,L),R=16*z.numTables-T,x=12,j=[],k=0;k<z.numTables;k++)j.push({tag:J(),offset:J(),compLength:J(),origLength:J(),origChecksum:J()}),x+=16;var Q,V=new Uint8Array(12+16*j.length+j.reduce(function(q,ee){return q+ee.origLength+4},0)),Y=V.buffer,fe=new DataView(Y),le=0;return Ae(z.flavor),ie(z.numTables),ie(T),ie(L),ie(R),j.forEach(function(q){Ae(q.tag),Ae(q.origChecksum),Ae(x),Ae(q.origLength),q.outOffset=x,(x+=q.origLength)%4!=0&&(x+=4-x%4)}),j.forEach(function(q){var ee,we=F.slice(q.offset,q.offset+q.compLength);if(q.compLength!=q.origLength){var _e=new Uint8Array(q.origLength);ee=new Uint8Array(we,2),w(ee,_e)}else _e=new Uint8Array(we);V.set(_e,q.outOffset);var he=0;(x=q.outOffset+q.origLength)%4!=0&&(he=4-x%4),V.set(new Uint8Array(he).buffer,q.outOffset+q.origLength),Q=x+he}),Y.slice(0,Q)},Object.defineProperty(t,"__esModule",{value:!0}),t}({}).convert_streams}function _p(t,e){const n={M:2,L:2,Q:4,C:6,Z:0},s={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},i=1,r=2,a=4,c=8,o=16,l=32;let u;function f(I){if(!u){const E={R:r,L:i,D:a,C:o,U:l,T:c};u=new Map;for(let w in s){let G=0;s[w].split(",").forEach(W=>{let[F,O]=W.split("+");F=parseInt(F,36),O=O?parseInt(O,36):0,u.set(G+=F,E[w]);for(let D=O;D--;)u.set(++G,E[w])})}}return u.get(I)||l}const h=1,d=2,m=3,g=4,v=[null,"isol","init","fina","medi"];function C(I){const E=new Uint8Array(I.length);let w=l,G=h,W=-1;for(let F=0;F<I.length;F++){const O=I.codePointAt(F);let D=f(O)|0,X=h;D&c||(w&(i|a|o)?D&(r|a|o)?(X=m,(G===h||G===m)&&E[W]++):D&(i|l)&&(G===d||G===g)&&E[W]--:w&(r|l)&&(G===d||G===g)&&E[W]--,G=E[F]=X,w=D,W=F,O>65535&&F++)}return E}function B(I,E){const w=[];for(let W=0;W<E.length;W++){const F=E.codePointAt(W);F>65535&&W++,w.push(t.U.codeToGlyph(I,F))}const G=I.GSUB;if(G){const{lookupList:W,featureList:F}=G;let O;const D=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,X=[];F.forEach(J=>{if(D.test(J.tag))for(let ie=0;ie<J.tab.length;ie++){if(X[J.tab[ie]])continue;X[J.tab[ie]]=!0;const Ae=W[J.tab[ie]],z=/^(isol|init|fina|medi)$/.test(J.tag);z&&!O&&(O=C(E));for(let L=0;L<w.length;L++)(!O||!z||v[O[L]]===J.tag)&&t.U._applySubs(w,L,Ae,W)}})}return w}function y(I,E){const w=new Int16Array(E.length*3);let G=0;for(;G<E.length;G++){const D=E[G];if(D===-1)continue;w[G*3+2]=I.hmtx.aWidth[D];const X=I.GPOS;if(X){const J=X.lookupList;for(let ie=0;ie<J.length;ie++){const Ae=J[ie];for(let z=0;z<Ae.tabs.length;z++){const L=Ae.tabs[z];if(Ae.ltype===1){if(t._lctf.coverageIndex(L.coverage,D)!==-1&&L.pos){O(L.pos,G);break}}else if(Ae.ltype===2){let T=null,R=W();if(R!==-1){const x=t._lctf.coverageIndex(L.coverage,E[R]);if(x!==-1){if(L.fmt===1){const j=L.pairsets[x];for(let k=0;k<j.length;k++)j[k].gid2===D&&(T=j[k])}else if(L.fmt===2){const j=t.U._getGlyphClass(E[R],L.classDef1),k=t.U._getGlyphClass(D,L.classDef2);T=L.matrix[j][k]}if(T){T.val1&&O(T.val1,R),T.val2&&O(T.val2,G);break}}}}else if(Ae.ltype===4){const T=t._lctf.coverageIndex(L.markCoverage,D);if(T!==-1){const R=W(F),x=R===-1?-1:t._lctf.coverageIndex(L.baseCoverage,E[R]);if(x!==-1){const j=L.markArray[T],k=L.baseArray[x][j.markClass];w[G*3]=k.x-j.x+w[R*3]-w[R*3+2],w[G*3+1]=k.y-j.y+w[R*3+1];break}}}else if(Ae.ltype===6){const T=t._lctf.coverageIndex(L.mark1Coverage,D);if(T!==-1){const R=W();if(R!==-1){const x=E[R];if(b(I,x)===3){const j=t._lctf.coverageIndex(L.mark2Coverage,x);if(j!==-1){const k=L.mark1Array[T],Q=L.mark2Array[j][k.markClass];w[G*3]=Q.x-k.x+w[R*3]-w[R*3+2],w[G*3+1]=Q.y-k.y+w[R*3+1];break}}}}}}}}else if(I.kern&&!I.cff){const J=W();if(J!==-1){const ie=I.kern.glyph1.indexOf(E[J]);if(ie!==-1){const Ae=I.kern.rval[ie].glyph2.indexOf(D);Ae!==-1&&(w[J*3+2]+=I.kern.rval[ie].vals[Ae])}}}}return w;function W(D){for(let X=G-1;X>=0;X--)if(E[X]!==-1&&(!D||D(E[X])))return X;return-1}function F(D){return b(I,D)===1}function O(D,X){for(let J=0;J<3;J++)w[X*3+J]+=D[J]||0}}function b(I,E){const w=I.GDEF&&I.GDEF.glyphClassDef;return w?t.U._getGlyphClass(E,w):0}function M(...I){for(let E=0;E<I.length;E++)if(typeof I[E]=="number")return I[E]}function S(I){const E=Object.create(null),w=I["OS/2"],G=I.hhea,W=I.head.unitsPerEm,F=M(w&&w.sTypoAscender,G&&G.ascender,W),O={unitsPerEm:W,ascender:F,descender:M(w&&w.sTypoDescender,G&&G.descender,0),capHeight:M(w&&w.sCapHeight,F),xHeight:M(w&&w.sxHeight,F),lineGap:M(w&&w.sTypoLineGap,G&&G.lineGap),supportsCodePoint(D){return t.U.codeToGlyph(I,D)>0},forEachGlyph(D,X,J,ie){let Ae=0;const z=1/O.unitsPerEm*X,L=B(I,D);let T=0;const R=y(I,L);return L.forEach((x,j)=>{if(x!==-1){let k=E[x];if(!k){const{cmds:Q,crds:V}=t.U.glyphToPath(I,x);let Y="",fe=0;for(let _e=0,he=Q.length;_e<he;_e++){const Be=n[Q[_e]];Y+=Q[_e];for(let ve=1;ve<=Be;ve++)Y+=(ve>1?",":"")+V[fe++]}let le,q,ee,we;if(V.length){le=q=1/0,ee=we=-1/0;for(let _e=0,he=V.length;_e<he;_e+=2){let Be=V[_e],ve=V[_e+1];Be<le&&(le=Be),ve<q&&(q=ve),Be>ee&&(ee=Be),ve>we&&(we=ve)}}else le=ee=q=we=0;k=E[x]={index:x,advanceWidth:I.hmtx.aWidth[x],xMin:le,yMin:q,xMax:ee,yMax:we,path:Y}}ie.call(null,k,Ae+R[j*3]*z,R[j*3+1]*z,T),Ae+=R[j*3+2]*z,J&&(Ae+=J*X)}T+=D.codePointAt(T)>65535?2:1}),Ae}};return O}return function(E){const w=new Uint8Array(E,0,4),G=t._bin.readASCII(w,0,4);if(G==="wOFF")E=e(E);else if(G==="wOF2")throw new Error("woff2 fonts not supported");return S(t.parse(E)[0])}}const Mp=$r({name:"Typr Font Parser",dependencies:[bp,Ep,_p],init(t,e,n){const s=t(),i=e();return n(s,i)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function Tp(){return function(t){var e=function(){this.buckets=new Map};e.prototype.add=function(y){var b=y>>5;this.buckets.set(b,(this.buckets.get(b)||0)|1<<(31&y))},e.prototype.has=function(y){var b=this.buckets.get(y>>5);return b!==void 0&&(b&1<<(31&y))!=0},e.prototype.serialize=function(){var y=[];return this.buckets.forEach(function(b,M){y.push((+M).toString(36)+":"+b.toString(36))}),y.join(",")},e.prototype.deserialize=function(y){var b=this;this.buckets.clear(),y.split(",").forEach(function(M){var S=M.split(":");b.buckets.set(parseInt(S[0],36),parseInt(S[1],36))})};var n=Math.pow(2,8),s=n-1,i=~s;function r(y){var b=function(S){return S&i}(y).toString(16),M=function(S){return(S&i)+n-1}(y).toString(16);return"codepoint-index/plane"+(y>>16)+"/"+b+"-"+M+".json"}function a(y,b){var M=y&s,S=b.codePointAt(M/6|0);return((S=(S||48)-48)&1<<M%6)!=0}function c(y,b){var M;(M=y,M.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(S){return S.split("-").map(function(I){return parseInt(I.trim(),16)})})).forEach(function(S){var I=S[0],E=S[1];E===void 0&&(E=I),b(I,E)})}function o(y,b){c(y,function(M,S){for(var I=M;I<=S;I++)b(I)})}var l={},u={},f=new WeakMap,h="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function d(y){var b=f.get(y);return b||(b=new e,o(y.ranges,function(M){return b.add(M)}),f.set(y,b)),b}var m,g=new Map;function v(y,b,M){return y[b]?b:y[M]?M:function(S){for(var I in S)return I}(y)}function C(y,b){var M=b;if(!y.includes(M)){M=1/0;for(var S=0;S<y.length;S++)Math.abs(y[S]-b)<Math.abs(M-b)&&(M=y[S])}return M}function B(y){return m||(m=new Set,o("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(b){m.add(b)})),m.has(y)}return t.CodePointSet=e,t.clearCache=function(){l={},u={}},t.getFontsForString=function(y,b){b===void 0&&(b={});var M,S=b.lang;S===void 0&&(S=new RegExp("\\p{Script=Hangul}","u").test(M=y)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(M)?"ja":"en");var I=b.category;I===void 0&&(I="sans-serif");var E=b.style;E===void 0&&(E="normal");var w=b.weight;w===void 0&&(w=400);var G=(b.dataUrl||h).replace(/\/$/g,""),W=new Map,F=new Uint8Array(y.length),O={},D={},X=new Array(y.length),J=new Map,ie=!1;function Ae(T){var R=g.get(T);return R||(R=fetch(G+"/"+T).then(function(x){if(!x.ok)throw new Error(x.statusText);return x.json().then(function(j){if(!Array.isArray(j)||j[0]!==1)throw new Error("Incorrect schema version; need 1, got "+j[0]);return j[1]})}).catch(function(x){if(G!==h)return ie||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+G+'", trying default CDN. '+x.message),ie=!0),G=h,g.delete(T),Ae(T);throw x}),g.set(T,R)),R}for(var z=function(T){var R=y.codePointAt(T),x=r(R);X[T]=x,l[x]||J.has(x)||J.set(x,Ae(x).then(function(j){l[x]=j})),R>65535&&(T++,L=T)},L=0;L<y.length;L++)z(L);return Promise.all(J.values()).then(function(){J.clear();for(var T=function(x){var j=y.codePointAt(x),k=null,Q=l[X[x]],V=void 0;for(var Y in Q){var fe=D[Y];if(fe===void 0&&(fe=D[Y]=new RegExp(Y).test(S||"en")),fe){for(var le in V=Y,Q[Y])if(a(j,Q[Y][le])){k=le;break}break}}if(!k){e:for(var q in Q)if(q!==V){for(var ee in Q[q])if(a(j,Q[q][ee])){k=ee;break e}}}k||(console.debug("No font coverage for U+"+j.toString(16)),k="latin"),X[x]=k,u[k]||J.has(k)||J.set(k,Ae("font-meta/"+k+".json").then(function(we){u[k]=we})),j>65535&&(x++,R=x)},R=0;R<y.length;R++)T(R);return Promise.all(J.values())}).then(function(){for(var T,R=null,x=0;x<y.length;x++){var j=y.codePointAt(x);if(R&&(B(j)||d(R).has(j)))F[x]=F[x-1];else{R=u[X[x]];var k=O[R.id];if(!k){var Q=R.typeforms,V=v(Q,I,"sans-serif"),Y=v(Q[V],E,"normal"),fe=C((T=Q[V])===null||T===void 0?void 0:T[Y],w);k=O[R.id]=G+"/font-files/"+R.id+"/"+V+"."+Y+"."+fe+".woff"}var le=W.get(k);le==null&&(le=W.size,W.set(k,le)),F[x]=le}j>65535&&(x++,F[x]=F[x-1])}return{fontUrls:Array.from(W.keys()),chars:F}})},Object.defineProperty(t,"__esModule",{value:!0}),t}({})}function wp(t,e){const n=Object.create(null),s=Object.create(null);function i(a,c){const o=l=>{console.error(`Failure loading font ${a}`,l)};try{const l=new XMLHttpRequest;l.open("get",a,!0),l.responseType="arraybuffer",l.onload=function(){if(l.status>=400)o(new Error(l.statusText));else if(l.status>0)try{const u=t(l.response);u.src=a,c(u)}catch(u){o(u)}},l.onerror=o,l.send()}catch(l){o(l)}}function r(a,c){let o=n[a];o?c(o):s[a]?s[a].push(c):(s[a]=[c],i(a,l=>{l.src=a,n[a]=l,s[a].forEach(u=>u(l)),delete s[a]}))}return function(a,c,{lang:o,fonts:l=[],style:u="normal",weight:f="normal",unicodeFontsURL:h}={}){const d=new Uint8Array(a.length),m=[];a.length||B();const g=new Map,v=[];if(u!=="italic"&&(u="normal"),typeof f!="number"&&(f=f==="bold"?700:400),l&&!Array.isArray(l)&&(l=[l]),l=l.slice().filter(b=>!b.lang||b.lang.test(o)).reverse(),l.length){let I=0;(function E(w=0){for(let G=w,W=a.length;G<W;G++){const F=a.codePointAt(G);if(I===1&&m[d[G-1]].supportsCodePoint(F)||G>0&&/\s/.test(a[G]))d[G]=d[G-1],I===2&&(v[v.length-1][1]=G);else for(let O=d[G],D=l.length;O<=D;O++)if(O===D){const X=I===2?v[v.length-1]:v[v.length]=[G,G];X[1]=G,I=2}else{d[G]=O;const{src:X,unicodeRange:J}=l[O];if(!J||y(F,J)){const ie=n[X];if(!ie){r(X,()=>{E(G)});return}if(ie.supportsCodePoint(F)){let Ae=g.get(ie);typeof Ae!="number"&&(Ae=m.length,m.push(ie),g.set(ie,Ae)),d[G]=Ae,I=1;break}}}F>65535&&G+1<W&&(d[G+1]=d[G],G++,I===2&&(v[v.length-1][1]=G))}C()})()}else v.push([0,a.length-1]),C();function C(){if(v.length){const b=v.map(M=>a.substring(M[0],M[1]+1)).join(`
`);e.getFontsForString(b,{lang:o||void 0,style:u,weight:f,dataUrl:h}).then(({fontUrls:M,chars:S})=>{const I=m.length;let E=0;v.forEach(G=>{for(let W=0,F=G[1]-G[0];W<=F;W++)d[G[0]+W]=S[E++]+I;E++});let w=0;M.forEach((G,W)=>{r(G,F=>{m[W+I]=F,++w===M.length&&B()})})})}else B()}function B(){c({chars:d,fonts:m})}function y(b,M){for(let S=0;S<M.length;S++){const[I,E=I]=M[S];if(I<=b&&b<=E)return!0}return!1}}}const Fp=$r({name:"FontResolver",dependencies:[wp,Mp,Tp],init(t,e,n){return t(e,n())}});function Ip(t,e){const s=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,i="[^\\S\\u00A0]",r=new RegExp(`${i}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function a({text:m,lang:g,fonts:v,style:C,weight:B,preResolvedFonts:y,unicodeFontsURL:b},M){const S=({chars:I,fonts:E})=>{let w,G;const W=[];for(let F=0;F<I.length;F++)I[F]!==G?(G=I[F],W.push(w={start:F,end:F,fontObj:E[I[F]]})):w.end=F;M(W)};y?S(y):t(m,S,{lang:g,fonts:v,style:C,weight:B,unicodeFontsURL:b})}function c({text:m="",font:g,lang:v,sdfGlyphSize:C=64,fontSize:B=400,fontWeight:y=1,fontStyle:b="normal",letterSpacing:M=0,lineHeight:S="normal",maxWidth:I=1/0,direction:E,textAlign:w="left",textIndent:G=0,whiteSpace:W="normal",overflowWrap:F="normal",anchorX:O=0,anchorY:D=0,metricsOnly:X=!1,unicodeFontsURL:J,preResolvedFonts:ie=null,includeCaretPositions:Ae=!1,chunkedBoundsSize:z=8192,colorRanges:L=null},T){const R=f(),x={fontLoad:0,typesetting:0};m.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),m=m.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),B=+B,M=+M,I=+I,S=S||"normal",G=+G,a({text:m,lang:v,style:b,weight:y,fonts:typeof g=="string"?[{src:g}]:g,unicodeFontsURL:J,preResolvedFonts:ie},j=>{x.fontLoad=f()-R;const k=isFinite(I);let Q=null,V=null,Y=null,fe=null,le=null,q=null,ee=null,we=null,_e=0,he=0,Be=W!=="nowrap";const ve=new Map,ne=f();let ge=G,me=0,$=new h;const Se=[$];j.forEach(pe=>{const{fontObj:be}=pe,{ascender:Me,descender:Ge,unitsPerEm:et,lineGap:st,capHeight:Ue,xHeight:Fe}=be;let Te=ve.get(be);if(!Te){const Z=B/et,Je=S==="normal"?(Me-Ge+st)*Z:S*B,$t=(Je-(Me-Ge)*Z)/2,Ye=Math.min(Je,(Me-Ge)*Z),Pe=(Me+Ge)/2*Z+Ye/2;Te={index:ve.size,src:be.src,fontObj:be,fontSizeMult:Z,unitsPerEm:et,ascender:Me*Z,descender:Ge*Z,capHeight:Ue*Z,xHeight:Fe*Z,lineHeight:Je,baseline:-$t-Me*Z,caretTop:Pe,caretBottom:Pe-Ye},ve.set(be,Te)}const{fontSizeMult:Ze}=Te,He=m.slice(pe.start,pe.end+1);let je,tt;be.forEachGlyph(He,B,M,(Z,Je,$t,Ye)=>{Je+=me,Ye+=pe.start,je=Je,tt=Z;const Pe=m.charAt(Ye),ut=Z.advanceWidth*Ze,nt=$.count;let Oe;if("isEmpty"in Z||(Z.isWhitespace=!!Pe&&new RegExp(i).test(Pe),Z.canBreakAfter=!!Pe&&r.test(Pe),Z.isEmpty=Z.xMin===Z.xMax||Z.yMin===Z.yMax||s.test(Pe)),!Z.isWhitespace&&!Z.isEmpty&&he++,Be&&k&&!Z.isWhitespace&&Je+ut+ge>I&&nt){if($.glyphAt(nt-1).glyphObj.canBreakAfter)Oe=new h,ge=-Je;else for(let yt=nt;yt--;)if(yt===0&&F==="break-word"){Oe=new h,ge=-Je;break}else if($.glyphAt(yt).glyphObj.canBreakAfter){Oe=$.splitAt(yt+1);const vt=Oe.glyphAt(0).x;ge-=vt;for(let ft=Oe.count;ft--;)Oe.glyphAt(ft).x-=vt;break}Oe&&($.isSoftWrapped=!0,$=Oe,Se.push($),_e=I)}let it=$.glyphAt($.count);it.glyphObj=Z,it.x=Je+ge,it.y=$t,it.width=ut,it.charIndex=Ye,it.fontData=Te,Pe===`
`&&($=new h,Se.push($),ge=-(Je+ut+M*B)+G)}),me=je+tt.advanceWidth*Ze+M*B});let de=0;Se.forEach(pe=>{let be=!0;for(let Me=pe.count;Me--;){const Ge=pe.glyphAt(Me);be&&!Ge.glyphObj.isWhitespace&&(pe.width=Ge.x+Ge.width,pe.width>_e&&(_e=pe.width),be=!1);let{lineHeight:et,capHeight:st,xHeight:Ue,baseline:Fe}=Ge.fontData;et>pe.lineHeight&&(pe.lineHeight=et);const Te=Fe-pe.baseline;Te<0&&(pe.baseline+=Te,pe.cap+=Te,pe.ex+=Te),pe.cap=Math.max(pe.cap,pe.baseline+st),pe.ex=Math.max(pe.ex,pe.baseline+Ue)}pe.baseline-=de,pe.cap-=de,pe.ex-=de,de+=pe.lineHeight});let ye=0,ue=0;if(O&&(typeof O=="number"?ye=-O:typeof O=="string"&&(ye=-_e*(O==="left"?0:O==="center"?.5:O==="right"?1:l(O)))),D&&(typeof D=="number"?ue=-D:typeof D=="string"&&(ue=D==="top"?0:D==="top-baseline"?-Se[0].baseline:D==="top-cap"?-Se[0].cap:D==="top-ex"?-Se[0].ex:D==="middle"?de/2:D==="bottom"?de:D==="bottom-baseline"?-Se[Se.length-1].baseline:l(D)*de)),!X){const pe=e.getEmbeddingLevels(m,E);Q=new Uint16Array(he),V=new Uint8Array(he),Y=new Float32Array(he*2),fe={},ee=[1/0,1/0,-1/0,-1/0],we=[],Ae&&(q=new Float32Array(m.length*4)),L&&(le=new Uint8Array(he*3));let be=0,Me=-1,Ge=-1,et,st;if(Se.forEach((Ue,Fe)=>{let{count:Te,width:Ze}=Ue;if(Te>0){let He=0;for(let Ye=Te;Ye--&&Ue.glyphAt(Ye).glyphObj.isWhitespace;)He++;let je=0,tt=0;if(w==="center")je=(_e-Ze)/2;else if(w==="right")je=_e-Ze;else if(w==="justify"&&Ue.isSoftWrapped){let Ye=0;for(let Pe=Te-He;Pe--;)Ue.glyphAt(Pe).glyphObj.isWhitespace&&Ye++;tt=(_e-Ze)/Ye}if(tt||je){let Ye=0;for(let Pe=0;Pe<Te;Pe++){let ut=Ue.glyphAt(Pe);const nt=ut.glyphObj;ut.x+=je+Ye,tt!==0&&nt.isWhitespace&&Pe<Te-He&&(Ye+=tt,ut.width+=tt)}}const Z=e.getReorderSegments(m,pe,Ue.glyphAt(0).charIndex,Ue.glyphAt(Ue.count-1).charIndex);for(let Ye=0;Ye<Z.length;Ye++){const[Pe,ut]=Z[Ye];let nt=1/0,Oe=-1/0;for(let it=0;it<Te;it++)if(Ue.glyphAt(it).charIndex>=Pe){let yt=it,vt=it;for(;vt<Te;vt++){let ft=Ue.glyphAt(vt);if(ft.charIndex>ut)break;vt<Te-He&&(nt=Math.min(nt,ft.x),Oe=Math.max(Oe,ft.x+ft.width))}for(let ft=yt;ft<vt;ft++){const It=Ue.glyphAt(ft);It.x=Oe-(It.x+It.width-nt)}break}}let Je;const $t=Ye=>Je=Ye;for(let Ye=0;Ye<Te;Ye++){const Pe=Ue.glyphAt(Ye);Je=Pe.glyphObj;const ut=Je.index,nt=pe.levels[Pe.charIndex]&1;if(nt){const Oe=e.getMirroredCharacter(m[Pe.charIndex]);Oe&&Pe.fontData.fontObj.forEachGlyph(Oe,0,0,$t)}if(Ae){const{charIndex:Oe,fontData:it}=Pe,yt=Pe.x+ye,vt=Pe.x+Pe.width+ye;q[Oe*4]=nt?vt:yt,q[Oe*4+1]=nt?yt:vt,q[Oe*4+2]=Ue.baseline+it.caretBottom+ue,q[Oe*4+3]=Ue.baseline+it.caretTop+ue;const ft=Oe-Me;ft>1&&u(q,Me,ft),Me=Oe}if(L){const{charIndex:Oe}=Pe;for(;Oe>Ge;)Ge++,L.hasOwnProperty(Ge)&&(st=L[Ge])}if(!Je.isWhitespace&&!Je.isEmpty){const Oe=be++,{fontSizeMult:it,src:yt,index:vt}=Pe.fontData,ft=fe[yt]||(fe[yt]={});ft[ut]||(ft[ut]={path:Je.path,pathBounds:[Je.xMin,Je.yMin,Je.xMax,Je.yMax]});const It=Pe.x+ye,St=Pe.y+Ue.baseline+ue;Y[Oe*2]=It,Y[Oe*2+1]=St;const Jt=It+Je.xMin*it,_t=St+Je.yMin*it,Dt=It+Je.xMax*it,Re=St+Je.yMax*it;Jt<ee[0]&&(ee[0]=Jt),_t<ee[1]&&(ee[1]=_t),Dt>ee[2]&&(ee[2]=Dt),Re>ee[3]&&(ee[3]=Re),Oe%z===0&&(et={start:Oe,end:Oe,rect:[1/0,1/0,-1/0,-1/0]},we.push(et)),et.end++;const Bt=et.rect;if(Jt<Bt[0]&&(Bt[0]=Jt),_t<Bt[1]&&(Bt[1]=_t),Dt>Bt[2]&&(Bt[2]=Dt),Re>Bt[3]&&(Bt[3]=Re),Q[Oe]=ut,V[Oe]=vt,L){const ir=Oe*3;le[ir]=st>>16&255,le[ir+1]=st>>8&255,le[ir+2]=st&255}}}}}),q){const Ue=m.length-Me;Ue>1&&u(q,Me,Ue)}}const Ke=[];ve.forEach(({index:pe,src:be,unitsPerEm:Me,ascender:Ge,descender:et,lineHeight:st,capHeight:Ue,xHeight:Fe})=>{Ke[pe]={src:be,unitsPerEm:Me,ascender:Ge,descender:et,lineHeight:st,capHeight:Ue,xHeight:Fe}}),x.typesetting=f()-ne,T({glyphIds:Q,glyphFontIndices:V,glyphPositions:Y,glyphData:fe,fontData:Ke,caretPositions:q,glyphColors:le,chunkedBounds:we,fontSize:B,topBaseline:ue+Se[0].baseline,blockBounds:[ye,ue-de,ye+_e,ue],visibleBounds:ee,timings:x})})}function o(m,g){c({...m,metricsOnly:!0},v=>{const[C,B,y,b]=v.blockBounds;g({width:y-C,height:b-B})})}function l(m){let g=m.match(/^([\d.]+)%$/),v=g?parseFloat(g[1]):NaN;return isNaN(v)?0:v/100}function u(m,g,v){const C=m[g*4],B=m[g*4+1],y=m[g*4+2],b=m[g*4+3],M=(B-C)/v;for(let S=0;S<v;S++){const I=(g+S)*4;m[I]=C+M*S,m[I+1]=C+M*(S+1),m[I+2]=y,m[I+3]=b}}function f(){return(self.performance||Date).now()}function h(){this.data=[]}const d=["glyphObj","x","y","width","charIndex","fontData"];return h.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/d.length)},glyphAt(m){let g=h.flyweight;return g.data=this.data,g.index=m,g},splitAt(m){let g=new h;return g.data=this.data.splice(m*d.length),g}},h.flyweight=d.reduce((m,g,v,C)=>(Object.defineProperty(m,g,{get(){return this.data[this.index*d.length+v]},set(B){this.data[this.index*d.length+v]=B}}),m),{data:null,index:0}),{typeset:c,measure:o}}const Ir=()=>(self.performance||Date).now(),Ri=zc();let To;function Sp(t,e,n,s,i,r,a,c,o,l,u=!0){return u?Rp(t,e,n,s,i,r,a,c,o,l).then(null,f=>(To||(console.warn("WebGL SDF generation failed, falling back to JS",f),To=!0),Fo(t,e,n,s,i,r,a,c,o,l))):Fo(t,e,n,s,i,r,a,c,o,l)}const ci=[],Dp=5;let Us=0;function qc(){const t=Ir();for(;ci.length&&Ir()-t<Dp;)ci.shift()();Us=ci.length?setTimeout(qc,0):0}const Rp=(...t)=>new Promise((e,n)=>{ci.push(()=>{const s=Ir();try{Ri.webgl.generateIntoCanvas(...t),e({timing:Ir()-s})}catch(i){n(i)}}),Us||(Us=setTimeout(qc,0))}),xp=4,Gp=2e3,wo={};let Up=0;function Fo(t,e,n,s,i,r,a,c,o,l){const u="TroikaTextSDFGenerator_JS_"+Up++%xp;let f=wo[u];return f||(f=wo[u]={workerModule:$r({name:u,workerId:u,dependencies:[zc,Ir],init(h,d){const m=h().javascript.generate;return function(...g){const v=d();return{textureData:m(...g),timing:d()-v}}},getTransferables(h){return[h.textureData.buffer]}}),requests:0,idleTimer:null}),f.requests++,clearTimeout(f.idleTimer),f.workerModule(t,e,n,s,i,r).then(({textureData:h,timing:d})=>{const m=Ir(),g=new Uint8Array(h.length*4);for(let v=0;v<h.length;v++)g[v*4+l]=h[v];return Ri.webglUtils.renderImageData(a,g,c,o,t,e,1<<3-l),d+=Ir()-m,--f.requests===0&&(f.idleTimer=setTimeout(()=>{hp(u)},Gp)),{timing:d}})}function Op(t){t._warm||(Ri.webgl.isSupported(t),t._warm=!0)}const kp=Ri.webglUtils.resizeWebGLCanvasWithoutClearing,Jr={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048,useWorker:!0},Lp=new zt;function Nr(){return(self.performance||Date).now()}const Io=Object.create(null);function $c(t,e){t=Np({},t);const n=Nr(),{defaultFontURL:s}=Jr,i=[];if(s&&i.push({label:"default",src:So(s)}),t.font&&i.push({label:"user",src:So(t.font)}),t.font=i,t.text=""+t.text,t.sdfGlyphSize=t.sdfGlyphSize||Jr.sdfGlyphSize,t.unicodeFontsURL=t.unicodeFontsURL||Jr.unicodeFontsURL,t.colorRanges!=null){let d={};for(let m in t.colorRanges)if(t.colorRanges.hasOwnProperty(m)){let g=t.colorRanges[m];typeof g!="number"&&(g=Lp.set(g).getHex()),d[m]=g}t.colorRanges=d}Object.freeze(t);const{textureWidth:r,sdfExponent:a}=Jr,{sdfGlyphSize:c}=t,o=r/c*4;let l=Io[c];if(!l){const d=document.createElement("canvas");d.width=r,d.height=c*256/o,l=Io[c]={glyphCount:0,sdfGlyphSize:c,sdfCanvas:d,sdfTexture:new lr(d,void 0,void 0,void 0,Ft,Ft),contextLost:!1,glyphsByFont:new Map},l.sdfTexture.generateMipmaps=!1,Pp(l)}const{sdfTexture:u,sdfCanvas:f}=l;rl(t).then(d=>{const{glyphIds:m,glyphFontIndices:g,fontData:v,glyphPositions:C,fontSize:B,timings:y}=d,b=[],M=new Float32Array(m.length*4);let S=0,I=0;const E=Nr(),w=v.map(D=>{let X=l.glyphsByFont.get(D.src);return X||l.glyphsByFont.set(D.src,X=new Map),X});m.forEach((D,X)=>{const J=g[X],{src:ie,unitsPerEm:Ae}=v[J];let z=w[J].get(D);if(!z){const{path:j,pathBounds:k}=d.glyphData[ie][D],Q=Math.max(k[2]-k[0],k[3]-k[1])/c*(Jr.sdfMargin*c+.5),V=l.glyphCount++,Y=[k[0]-Q,k[1]-Q,k[2]+Q,k[3]+Q];w[J].set(D,z={path:j,atlasIndex:V,sdfViewBox:Y}),b.push(z)}const{sdfViewBox:L}=z,T=C[I++],R=C[I++],x=B/Ae;M[S++]=T+L[0]*x,M[S++]=R+L[1]*x,M[S++]=T+L[2]*x,M[S++]=R+L[3]*x,m[X]=z.atlasIndex}),y.quads=(y.quads||0)+(Nr()-E);const G=Nr();y.sdf={};const W=f.height,F=Math.ceil(l.glyphCount/o),O=Math.pow(2,Math.ceil(Math.log2(F*c)));O>W&&(console.info(`Increasing SDF texture size ${W}->${O}`),kp(f,r,O),u.dispose()),Promise.all(b.map(D=>el(D,l,t.gpuAccelerateSDF).then(({timing:X})=>{y.sdf[D.atlasIndex]=X}))).then(()=>{b.length&&!l.contextLost&&(tl(l),u.needsUpdate=!0),y.sdfTotal=Nr()-G,y.total=Nr()-n,e(Object.freeze({parameters:t,sdfTexture:u,sdfGlyphSize:c,sdfExponent:a,glyphBounds:M,glyphAtlasIndices:m,glyphColors:d.glyphColors,caretPositions:d.caretPositions,chunkedBounds:d.chunkedBounds,ascender:d.ascender,descender:d.descender,lineHeight:d.lineHeight,capHeight:d.capHeight,xHeight:d.xHeight,topBaseline:d.topBaseline,blockBounds:d.blockBounds,visibleBounds:d.visibleBounds,timings:d.timings}))})}),Promise.resolve().then(()=>{l.contextLost||Op(f)})}function el({path:t,atlasIndex:e,sdfViewBox:n},{sdfGlyphSize:s,sdfCanvas:i,contextLost:r},a){if(r)return Promise.resolve({timing:-1});const{textureWidth:c,sdfExponent:o}=Jr,l=Math.max(n[2]-n[0],n[3]-n[1]),u=Math.floor(e/4),f=u%(c/s)*s,h=Math.floor(u/(c/s))*s,d=e%4;return Sp(s,s,t,n,l,o,i,f,h,d,a)}function Pp(t){const e=t.sdfCanvas;e.addEventListener("webglcontextlost",n=>{console.log("Context Lost",n),n.preventDefault(),t.contextLost=!0}),e.addEventListener("webglcontextrestored",n=>{console.log("Context Restored",n),t.contextLost=!1;const s=[];t.glyphsByFont.forEach(i=>{i.forEach(r=>{s.push(el(r,t,!0))})}),Promise.all(s).then(()=>{tl(t),t.sdfTexture.needsUpdate=!0})})}function Hp({font:t,characters:e,sdfGlyphSize:n},s){let i=Array.isArray(e)?e.join(`
`):""+e;$c({font:t,sdfGlyphSize:n,text:i},s)}function Np(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}let ti;function So(t){return ti||(ti=typeof document>"u"?{}:document.createElement("a")),ti.href=t,ti.href}function tl(t){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:n}=t,{width:s,height:i}=e,r=t.sdfCanvas.getContext("webgl");let a=n.image.data;(!a||a.length!==s*i*4)&&(a=new Uint8Array(s*i*4),n.image={width:s,height:i,data:a},n.flipY=!1,n.isDataTexture=!0),r.readPixels(0,0,s,i,r.RGBA,r.UNSIGNED_BYTE,a)}}const Jp=$r({name:"Typesetter",dependencies:[Ip,Fp,pp],init(t,e,n){return t(e,n())}}),rl=$r({name:"Typesetter",dependencies:[Jp],init(t){return function(e){return new Promise(n=>{t.typeset(e,n)})}},getTransferables(t){const e=[];for(let n in t)t[n]&&t[n].buffer&&e.push(t[n].buffer);return e}});rl.onMainThread;const Do={};function Kp(t){let e=Do[t];return e||(e=Do[t]=new Un(1,1,t,t).translate(.5,.5,0)),e}const jp="aTroikaGlyphBounds",Ro="aTroikaGlyphIndex",Qp="aTroikaGlyphColor";class Wp extends iu{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Zo,this.boundingBox=new Ps}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let n=Kp(e);["position","normal","uv"].forEach(s=>{this.attributes[s]=n.attributes[s].clone()}),this.setIndex(n.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,n,s,i,r){this.updateAttributeData(jp,e,4),this.updateAttributeData(Ro,n,1),this.updateAttributeData(Qp,r,3),this._blockBounds=s,this._chunkedBounds=i,this.instanceCount=n.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:n,boundingBox:s}=this;if(n){const{PI:i,floor:r,min:a,max:c,sin:o,cos:l}=Math,u=i/2,f=i*2,h=Math.abs(n),d=e[0]/h,m=e[2]/h,g=r((d+u)/f)!==r((m+u)/f)?-h:a(o(d)*h,o(m)*h),v=r((d-u)/f)!==r((m-u)/f)?h:c(o(d)*h,o(m)*h),C=r((d+i)/f)!==r((m+i)/f)?h*2:c(h-l(d)*h,h-l(m)*h);s.min.set(g,e[1],n<0?-C:0),s.max.set(v,e[3],n<0?0:C)}else s.min.set(e[0],e[1],0),s.max.set(e[2],e[3],0);s.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let n=this.getAttribute(Ro).count,s=this._chunkedBounds;if(s)for(let i=s.length;i--;){n=s[i].end;let r=s[i].rect;if(r[1]<e.w&&r[3]>e.y&&r[0]<e.z&&r[2]>e.x)break}this.instanceCount=n}updateAttributeData(e,n,s){const i=this.getAttribute(e);n?i&&i.array.length===n.length?(i.array.set(n),i.needsUpdate=!0):(this.setAttribute(e,new Ko(n,s)),delete this._maxInstanceCount,this.dispose()):i&&this.deleteAttribute(e)}}const Xp=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,Vp=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Yp=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,zp=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function Zp(t){const e=Gs(t,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Sr},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Sa(0,0,0,0)},uTroikaClipRect:{value:new Sa(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Sr},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new zt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new su},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:Xp,vertexTransform:Vp,fragmentDefs:Yp,fragmentColorTransform:zp,customRewriter({vertexShader:n,fragmentShader:s}){let i=/\buniform\s+vec3\s+diffuse\b/;return i.test(s)&&(s=s.replace(i,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),i.test(n)||(n=n.replace(Zc,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:n,fragmentShader:s}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const sa=new wr({color:16777215,side:bi,transparent:!0}),xo=8421504,Go=new zr,ri=new gt,os=new gt,dn=[],qp=new gt,cs="+x+y";function Uo(t){return Array.isArray(t)?t[0]:t}let nl=()=>{const t=new Gr(new Un(1,1),sa);return nl=()=>t,t},il=()=>{const t=new Gr(new Un(1,1,32,1),sa);return il=()=>t,t};const $p={type:"syncstart"},em={type:"synccomplete"},sl=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],tm=sl.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let al=class extends Gr{constructor(){const e=new Wp;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=xo,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=cs,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent($p),$c({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},n=>{this._isSyncing=!1,this._textRenderInfo=n,this.geometry.updateGlyphs(n.glyphBounds,n.glyphAtlasIndices,n.blockBounds,n.chunkedBounds,n.glyphColors);const s=this._queuedSyncs;s&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{s.forEach(i=>i&&i())})),this.dispatchEvent(em),e&&e()})))}onBeforeRender(e,n,s,i,r,a){this.sync(),r.isTroikaTextMaterial&&this._prepareForRender(r)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return Zp(e)}get material(){let e=this._derivedMaterial;const n=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=sa.clone());if((!e||!e.isDerivedFrom(n))&&(e=this._derivedMaterial=this.createDerivedMaterial(n),n.addEventListener("dispose",function s(){n.removeEventListener("dispose",s),e.dispose()})),this.hasOutline()){let s=e._outlineMtl;return s||(s=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),s.isTextOutlineMaterial=!0,s.depthWrite=!1,s.map=null,e.addEventListener("dispose",function i(){e.removeEventListener("dispose",i),s.dispose()})),[s,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return Uo(this.material).getDepthMaterial()}get customDistanceMaterial(){return Uo(this.material).getDistanceMaterial()}_prepareForRender(e){const n=e.isTextOutlineMaterial,s=e.uniforms,i=this.textRenderInfo;if(i){const{sdfTexture:c,blockBounds:o}=i;s.uTroikaSDFTexture.value=c,s.uTroikaSDFTextureSize.value.set(c.image.width,c.image.height),s.uTroikaSDFGlyphSize.value=i.sdfGlyphSize,s.uTroikaSDFExponent.value=i.sdfExponent,s.uTroikaTotalBounds.value.fromArray(o),s.uTroikaUseGlyphColors.value=!n&&!!i.glyphColors;let l=0,u=0,f=0,h,d,m,g=0,v=0;if(n){let{outlineWidth:B,outlineOffsetX:y,outlineOffsetY:b,outlineBlur:M,outlineOpacity:S}=this;l=this._parsePercent(B)||0,u=Math.max(0,this._parsePercent(M)||0),h=S,g=this._parsePercent(y)||0,v=this._parsePercent(b)||0}else f=Math.max(0,this._parsePercent(this.strokeWidth)||0),f&&(m=this.strokeColor,s.uTroikaStrokeColor.value.set(m??xo),d=this.strokeOpacity,d==null&&(d=1)),h=this.fillOpacity;s.uTroikaEdgeOffset.value=l,s.uTroikaPositionOffset.value.set(g,v),s.uTroikaBlurRadius.value=u,s.uTroikaStrokeWidth.value=f,s.uTroikaStrokeOpacity.value=d,s.uTroikaFillOpacity.value=h??1,s.uTroikaCurveRadius.value=this.curveRadius||0;let C=this.clipRect;if(C&&Array.isArray(C)&&C.length===4)s.uTroikaClipRect.value.fromArray(C);else{const B=(this.fontSize||.1)*100;s.uTroikaClipRect.value.set(o[0]-B,o[1]-B,o[2]+B,o[3]+B)}this.geometry.applyClipRect(s.uTroikaClipRect.value)}s.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const r=n?this.outlineColor||0:this.color;if(r==null)delete e.color;else{const c=e.hasOwnProperty("color")?e.color:e.color=new zt;(r!==c._input||typeof r=="object")&&c.set(c._input=r)}let a=this.orientation||cs;if(a!==e._orientation){let c=s.uTroikaOrient.value;a=a.replace(/[^-+xyz]/g,"");let o=a!==cs&&a.match(/^([-+])([xyz])([-+])([xyz])$/);if(o){let[,l,u,f,h]=o;ri.set(0,0,0)[u]=l==="-"?1:-1,os.set(0,0,0)[h]=f==="-"?-1:1,Go.lookAt(qp,ri.cross(os),os),c.setFromMatrix4(Go)}else c.identity();e._orientation=a}}_parsePercent(e){if(typeof e=="string"){let n=e.match(/^(-?[\d.]+)%$/),s=n?parseFloat(n[1]):NaN;e=(isNaN(s)?0:s/100)*this.fontSize}return e}localPositionToTextCoords(e,n=new Sr){n.copy(e);const s=this.curveRadius;return s&&(n.x=Math.atan2(e.x,Math.abs(s)-Math.abs(e.z))*Math.abs(s)),n}worldPositionToTextCoords(e,n=new Sr){return ri.copy(e),this.localPositionToTextCoords(this.worldToLocal(ri),n)}raycast(e,n){const{textRenderInfo:s,curveRadius:i}=this;if(s){const r=s.blockBounds,a=i?il():nl(),c=a.geometry,{position:o,uv:l}=c.attributes;for(let u=0;u<l.count;u++){let f=r[0]+l.getX(u)*(r[2]-r[0]);const h=r[1]+l.getY(u)*(r[3]-r[1]);let d=0;i&&(d=i-Math.cos(f/i)*i,f=Math.sin(f/i)*i),o.setXYZ(u,f,h,d)}c.boundingSphere=this.geometry.boundingSphere,c.boundingBox=this.geometry.boundingBox,a.matrixWorld=this.matrixWorld,a.material.side=this.material.side,dn.length=0,a.raycast(e,dn);for(let u=0;u<dn.length;u++)dn[u].object=this,n.push(dn[u])}}copy(e){const n=this.geometry;return super.copy(e),this.geometry=n,tm.forEach(s=>{this[s]=e[s]}),this}clone(){return new this.constructor().copy(this)}};sl.forEach(t=>{const e="_private_"+t;Object.defineProperty(al.prototype,t,{get(){return this[e]},set(n){n!==this[e]&&(this[e]=n,this._needsSync=!0)}})});new Ps;new zt;const ol=P.forwardRef(({sdfGlyphSize:t=64,anchorX:e="center",anchorY:n="middle",font:s,fontSize:i=1,children:r,characters:a,onSync:c,...o},l)=>{const u=Yt(({invalidate:m})=>m),[f]=P.useState(()=>new al),[h,d]=P.useMemo(()=>{const m=[];let g="";return P.Children.forEach(r,v=>{typeof v=="string"||typeof v=="number"?g+=v:m.push(v)}),[m,g]},[r]);return au(()=>new Promise(m=>Hp({font:s,characters:a},m)),["troika-text",s,a]),P.useLayoutEffect(()=>void f.sync(()=>{u(),c&&c(f)})),P.useEffect(()=>()=>f.dispose(),[f]),P.createElement("primitive",Zt({object:f,ref:l,font:s,text:d,anchorX:e,anchorY:n,fontSize:i,sdfGlyphSize:t},o),h)}),rm=()=>parseInt(No.replace(/\D+/g,"")),cl=rm();let ni=null,ll="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function ul(t=!0,e=!0,n){return s=>{n&&n(s),t&&(ni||(ni=new ap),ni.setDecoderPath(typeof t=="string"?t:ll),s.setDRACOLoader(ni)),e&&s.setMeshoptDecoder(typeof ss=="function"?ss():ss)}}const xi=(t,e,n,s)=>Dr(ia,t,ul(e,n,s));xi.preload=(t,e,n,s)=>Dr.preload(ia,t,ul(e,n,s));xi.clear=t=>Dr.clear(ia,t);xi.setDecoderPath=t=>{ll=t};const nm=3e3,im=3001,ls=cl>=154?"opaque_fragment":"output_fragment";class sm extends Wo{constructor(e){super(e),this.onBeforeCompile=(n,s)=>{const{isWebGL2:i}=s.capabilities;n.fragmentShader=n.fragmentShader.replace(`#include <${ls}>`,`
        ${i?`#include <${ls}>`:`#extension GL_OES_standard_derivatives : enable
#include <${ls}>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <${cl>=154?"colorspace_fragment":"encodings_fragment"}>
      `)}}}const am=P.forwardRef((t,e)=>{const[n]=P.useState(()=>new sm(null));return P.createElement("primitive",Zt({},t,{object:n,ref:e,attach:"material"}))}),om=P.forwardRef(({children:t,enabled:e=!0,speed:n=1,rotationIntensity:s=1,floatIntensity:i=1,floatingRange:r=[-.1,.1],autoInvalidate:a=!1,...c},o)=>{const l=P.useRef(null);P.useImperativeHandle(o,()=>l.current,[]);const u=P.useRef(Math.random()*1e4);return xr(f=>{var h,d;if(!e||n===0)return;a&&f.invalidate();const m=u.current+f.clock.getElapsedTime();l.current.rotation.x=Math.cos(m/4*n)/8*s,l.current.rotation.y=Math.sin(m/4*n)/8*s,l.current.rotation.z=Math.sin(m/4*n)/20*s;let g=Math.sin(m/4*n)/10;g=Kr.mapLinear(g,-.1,.1,(h=r==null?void 0:r[0])!==null&&h!==void 0?h:-.1,(d=r==null?void 0:r[1])!==null&&d!==void 0?d:.1),l.current.position.y=g*i,l.current.updateMatrix()}),P.createElement("group",c,P.createElement("group",{ref:l,matrixAutoUpdate:!1},t))}),fl=(t,e,n)=>{let s;switch(t){case ps:s=new Uint8ClampedArray(e*n*4);break;case Ht:s=new Uint16Array(e*n*4);break;case hu:s=new Uint32Array(e*n*4);break;case fu:s=new Int8Array(e*n*4);break;case uu:s=new Int16Array(e*n*4);break;case lu:s=new Int32Array(e*n*4);break;case ur:s=new Float32Array(e*n*4);break;default:throw new Error("Unsupported data type")}return s};let ii;const cm=(t,e,n,s)=>{if(ii!==void 0)return ii;const i=new ec(1,1,s);e.setRenderTarget(i);const r=new Gr(new Un,new wr({color:16777215}));e.render(r,n),e.setRenderTarget(null);const a=fl(t,i.width,i.height);return e.readRenderTargetPixels(i,0,0,i.width,i.height,a),i.dispose(),r.geometry.dispose(),r.material.dispose(),ii=a[0]!==0,ii};class aa{constructor(e){var n,s,i,r,a,c,o,l,u,f,h,d,m,g,v,C;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(y){throw this._renderer.setRenderTarget(null),y}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const B={format:Tn,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)===null||n===void 0?void 0:n.anisotropy)!==void 0?(s=e.renderTargetOptions)===null||s===void 0?void 0:s.anisotropy:1,generateMipmaps:((i=e.renderTargetOptions)===null||i===void 0?void 0:i.generateMipmaps)!==void 0?(r=e.renderTargetOptions)===null||r===void 0?void 0:r.generateMipmaps:!1,magFilter:((a=e.renderTargetOptions)===null||a===void 0?void 0:a.magFilter)!==void 0?(c=e.renderTargetOptions)===null||c===void 0?void 0:c.magFilter:Ft,minFilter:((o=e.renderTargetOptions)===null||o===void 0?void 0:o.minFilter)!==void 0?(l=e.renderTargetOptions)===null||l===void 0?void 0:l.minFilter:Ft,samples:((u=e.renderTargetOptions)===null||u===void 0?void 0:u.samples)!==void 0?(f=e.renderTargetOptions)===null||f===void 0?void 0:f.samples:void 0,wrapS:((h=e.renderTargetOptions)===null||h===void 0?void 0:h.wrapS)!==void 0?(d=e.renderTargetOptions)===null||d===void 0?void 0:d.wrapS:cr,wrapT:((m=e.renderTargetOptions)===null||m===void 0?void 0:m.wrapT)!==void 0?(g=e.renderTargetOptions)===null||g===void 0?void 0:g.wrapT:cr};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=aa.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new $o,this._camera=new Ei,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!cm(this._type,this._renderer,this._camera,B)){let y;switch(this._type){case Ht:y=this._renderer.extensions.has("EXT_color_buffer_float")?ur:void 0;break}y!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${ur}`),this._type=y):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Gr(new Un,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new ec(this.width,this.height,B),this._renderTarget.texture.mapping=((v=e.renderTargetOptions)===null||v===void 0?void 0:v.mapping)!==void 0?(C=e.renderTargetOptions)===null||C===void 0?void 0:C.mapping:li}static instantiateRenderer(){const e=new ou;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=fl(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const n=new cu(this.toArray(),this.width,this.height,Tn,this._type,(e==null?void 0:e.mapping)||li,(e==null?void 0:e.wrapS)||cr,(e==null?void 0:e.wrapT)||cr,(e==null?void 0:e.magFilter)||Ft,(e==null?void 0:e.minFilter)||Ft,(e==null?void 0:e.anisotropy)||1,ds);return n.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,n}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof ks&&Object.values(this.material.uniforms).forEach(n=>{n.value instanceof lr&&n.value.dispose()}),Object.values(this.material).forEach(n=>{n instanceof lr&&n.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const lm=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,um=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class fm extends ks{constructor({gamma:e,offsetHdr:n,offsetSdr:s,gainMapMin:i,gainMapMax:r,maxDisplayBoost:a,hdrCapacityMin:c,hdrCapacityMax:o,sdr:l,gainMap:u}){super({name:"GainMapDecoderMaterial",vertexShader:lm,fragmentShader:um,uniforms:{sdr:{value:l},gainMap:{value:u},gamma:{value:new gt(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new gt().fromArray(n)},offsetSdr:{value:new gt().fromArray(s)},gainMapMin:{value:new gt().fromArray(i)},gainMapMax:{value:new gt().fromArray(r)},weightFactor:{value:(Math.log2(a)-c)/(o-c)}},blending:mu,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=c,this._hdrCapacityMax=o,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const n=this.uniforms.gamma.value;n.x=1/e[0],n.y=1/e[1],n.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class hl extends Error{}class dl extends Error{}const pn=(t,e,n)=>{const s=new RegExp(`${e}="([^"]*)"`,"i").exec(t);if(s)return s[1];const i=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(t);if(i){const r=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return r&&r.length===3?r.map(a=>a.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(n!==void 0)return n;throw new Error(`Can't find ${e} in gainmap metadata`)},hm=t=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(t):e=t.toString();let n=e.indexOf("<x:xmpmeta");for(;n!==-1;){const s=e.indexOf("x:xmpmeta>",n),i=e.slice(n,s+10);try{const r=pn(i,"hdrgm:GainMapMin","0"),a=pn(i,"hdrgm:GainMapMax"),c=pn(i,"hdrgm:Gamma","1"),o=pn(i,"hdrgm:OffsetSDR","0.015625"),l=pn(i,"hdrgm:OffsetHDR","0.015625"),u=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(i),f=u?u[1]:"0",h=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(i);if(!h)throw new Error("Incomplete gainmap metadata");const d=h[1];return{gainMapMin:Array.isArray(r)?r.map(m=>parseFloat(m)):[parseFloat(r),parseFloat(r),parseFloat(r)],gainMapMax:Array.isArray(a)?a.map(m=>parseFloat(m)):[parseFloat(a),parseFloat(a),parseFloat(a)],gamma:Array.isArray(c)?c.map(m=>parseFloat(m)):[parseFloat(c),parseFloat(c),parseFloat(c)],offsetSdr:Array.isArray(o)?o.map(m=>parseFloat(m)):[parseFloat(o),parseFloat(o),parseFloat(o)],offsetHdr:Array.isArray(l)?l.map(m=>parseFloat(m)):[parseFloat(l),parseFloat(l),parseFloat(l)],hdrCapacityMin:parseFloat(f),hdrCapacityMax:parseFloat(d)}}catch{}n=e.indexOf("<x:xmpmeta",s)}};class dm{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((n,s)=>{const i=this.options.debug,r=new DataView(e.buffer);if(r.getUint16(0)!==65496){s(new Error("Not a valid jpeg"));return}const a=r.byteLength;let c=2,o=0,l;for(;c<a;){if(++o>250){s(new Error(`Found no marker after ${o} loops 😵`));return}if(r.getUint8(c)!==255){s(new Error(`Not a valid marker at offset 0x${c.toString(16)}, found: 0x${r.getUint8(c).toString(16)}`));return}if(l=r.getUint8(c+1),i&&console.log(`Marker: ${l.toString(16)}`),l===226){i&&console.log("Found APP2 marker (0xffe2)");const u=c+4;if(r.getUint32(u)===1297106432){const f=u+4;let h;if(r.getUint16(f)===18761)h=!1;else if(r.getUint16(f)===19789)h=!0;else{s(new Error("No valid endianness marker found in TIFF header"));return}if(r.getUint16(f+2,!h)!==42){s(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const d=r.getUint32(f+4,!h);if(d<8){s(new Error("Not valid TIFF data! (First offset less than 8)"));return}const m=f+d,g=r.getUint16(m,!h),v=m+2;let C=0;for(let M=v;M<v+12*g;M+=12)r.getUint16(M,!h)===45057&&(C=r.getUint32(M+8,!h));const y=m+2+g*12+4,b=[];for(let M=y;M<y+C*16;M+=16){const S={MPType:r.getUint32(M,!h),size:r.getUint32(M+4,!h),dataOffset:r.getUint32(M+8,!h),dependantImages:r.getUint32(M+12,!h),start:-1,end:-1,isFII:!1};S.dataOffset?(S.start=f+S.dataOffset,S.isFII=!1):(S.start=0,S.isFII=!0),S.end=S.start+S.size,b.push(S)}if(this.options.extractNonFII&&b.length){const M=new Blob([r]),S=[];for(const I of b){if(I.isFII&&!this.options.extractFII)continue;const E=M.slice(I.start,I.end+1,"image/jpeg");S.push(E)}n(S)}}}c+=2+r.getUint16(c+2)}})}}const pm=async t=>{const e=hm(t);if(!e)throw new dl("Gain map XMP metadata not found");const s=await new dm({extractFII:!0,extractNonFII:!0}).extract(t);if(s.length!==2)throw new hl("Gain map recovery image not found");return{sdr:new Uint8Array(await s[0].arrayBuffer()),gainMap:new Uint8Array(await s[1].arrayBuffer()),metadata:e}},Oo=t=>new Promise((e,n)=>{const s=document.createElement("img");s.onload=()=>{e(s)},s.onerror=i=>{n(i)},s.src=URL.createObjectURL(t)});class pl extends Ls{constructor(e,n){super(n),e&&(this._renderer=e),this._internalLoadingManager=new du}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new fm({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new lr,sdr:new lr});return new aa({width:16,height:16,type:Ht,colorSpace:ds,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,n,s,i){const r=i?new Blob([i],{type:"image/jpeg"}):void 0,a=new Blob([s],{type:"image/jpeg"});let c,o,l=!1;if(typeof createImageBitmap>"u"){const h=await Promise.all([r?Oo(r):Promise.resolve(void 0),Oo(a)]);o=h[0],c=h[1],l=!0}else{const h=await Promise.all([r?createImageBitmap(r,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:"flipY"})]);o=h[0],c=h[1]}const u=new lr(o||new ImageData(2,2),li,cr,cr,Ft,Da,Tn,ps,1,ds);u.flipY=l,u.needsUpdate=!0;const f=new lr(c,li,cr,cr,Ft,Da,Tn,ps,1,pu);f.flipY=l,f.needsUpdate=!0,e.width=c.width,e.height=c.height,e.material.gainMap=u,e.material.sdr=f,e.material.gainMapMin=n.gainMapMin,e.material.gainMapMax=n.gainMapMax,e.material.offsetHdr=n.offsetHdr,e.material.offsetSdr=n.offsetSdr,e.material.gamma=n.gamma,e.material.hdrCapacityMin=n.hdrCapacityMin,e.material.hdrCapacityMax=n.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,n.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class mm extends pl{load([e,n,s],i,r,a){const c=this.prepareQuadRenderer();let o,l,u;const f=async()=>{if(o&&l&&u){try{await this.render(c,u,o,l)}catch(w){this.manager.itemError(e),this.manager.itemError(n),this.manager.itemError(s),typeof a=="function"&&a(w),c.disposeOnDemandRenderer();return}typeof i=="function"&&i(c),this.manager.itemEnd(e),this.manager.itemEnd(n),this.manager.itemEnd(s),c.disposeOnDemandRenderer()}};let h=!0,d=0,m=0,g=!0,v=0,C=0,B=!0,y=0,b=0;const M=()=>{if(typeof r=="function"){const w=d+v+y,G=m+C+b,W=h&&g&&B;r(new ProgressEvent("progress",{lengthComputable:W,loaded:G,total:w}))}};this.manager.itemStart(e),this.manager.itemStart(n),this.manager.itemStart(s);const S=new yr(this._internalLoadingManager);S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setPath(this.path),S.setWithCredentials(this.withCredentials),S.load(e,async w=>{if(typeof w=="string")throw new Error("Invalid sdr buffer");o=w,await f()},w=>{h=w.lengthComputable,m=w.loaded,d=w.total,M()},w=>{this.manager.itemError(e),typeof a=="function"&&a(w)});const I=new yr(this._internalLoadingManager);I.setResponseType("arraybuffer"),I.setRequestHeader(this.requestHeader),I.setPath(this.path),I.setWithCredentials(this.withCredentials),I.load(n,async w=>{if(typeof w=="string")throw new Error("Invalid gainmap buffer");l=w,await f()},w=>{g=w.lengthComputable,C=w.loaded,v=w.total,M()},w=>{this.manager.itemError(n),typeof a=="function"&&a(w)});const E=new yr(this._internalLoadingManager);return E.setRequestHeader(this.requestHeader),E.setPath(this.path),E.setWithCredentials(this.withCredentials),E.load(s,async w=>{if(typeof w!="string")throw new Error("Invalid metadata string");u=JSON.parse(w),await f()},w=>{B=w.lengthComputable,b=w.loaded,y=w.total,M()},w=>{this.manager.itemError(s),typeof a=="function"&&a(w)}),c}}class Am extends pl{load(e,n,s,i){const r=this.prepareQuadRenderer(),a=new yr(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async c=>{if(typeof c=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const o=new Uint8Array(c);let l,u,f;try{const h=await pm(o);l=h.sdr,u=h.gainMap,f=h.metadata}catch(h){if(h instanceof dl||h instanceof hl)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),f={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},l=o;else throw h}try{await this.render(r,f,l,u)}catch(h){this.manager.itemError(e),typeof i=="function"&&i(h),r.disposeOnDemandRenderer();return}typeof n=="function"&&n(r),this.manager.itemEnd(e),r.disposeOnDemandRenderer()},s,c=>{this.manager.itemError(e),typeof i=="function"&&i(c)}),r}}const Gn={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},ml="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Yr=t=>Array.isArray(t),oa=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function Gi({files:t=oa,path:e="",preset:n=void 0,encoding:s=void 0,extensions:i}={}){let r=null,a=!1;n&&(ca(n),t=Gn[n],e=ml),a=Yr(t);const{extension:c,isCubemap:o}=la(t);if(r=ua(c),!r)throw new Error("useEnvironment: Unrecognized file extension: "+t);const l=Yt(d=>d.gl);P.useLayoutEffect(()=>{if(c!=="webp"&&c!=="jpg"&&c!=="jpeg")return;function d(){Dr.clear(r,a?[t]:t)}l.domElement.addEventListener("webglcontextlost",d,{once:!0})},[t,l.domElement]);const u=Dr(r,a?[t]:t,d=>{(c==="webp"||c==="jpg"||c==="jpeg")&&d.setRenderer(l),d.setPath==null||d.setPath(e),i&&i(d)});let f=a?u[0]:u;if(c==="jpg"||c==="jpeg"||c==="webp"){var h;f=(h=f.renderTarget)==null?void 0:h.texture}return f.mapping=o?Au:gu,"colorSpace"in f?f.colorSpace=s??o?"srgb":"srgb-linear":f.encoding=s??o?im:nm,f}const gm={files:oa,path:"",preset:void 0,extensions:void 0};Gi.preload=t=>{const e={...gm,...t};let{files:n,path:s=""}=e;const{preset:i,extensions:r}=e;i&&(ca(i),n=Gn[i],s=ml);const{extension:a}=la(n);if(a==="webp"||a==="jpg"||a==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const c=ua(a);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+n);Dr.preload(c,Yr(n)?[n]:n,o=>{o.setPath==null||o.setPath(s),r&&r(o)})};const vm={files:oa,preset:void 0};Gi.clear=t=>{const e={...vm,...t};let{files:n}=e;const{preset:s}=e;s&&(ca(s),n=Gn[s]);const{extension:i}=la(n),r=ua(i);if(!r)throw new Error("useEnvironment: Unrecognized file extension: "+n);Dr.clear(r,Yr(n)?[n]:n)};function ca(t){if(!(t in Gn))throw new Error("Preset must be one of: "+Object.keys(Gn).join(", "))}function la(t){var e;const n=Yr(t)&&t.length===6,s=Yr(t)&&t.length===3&&t.some(a=>a.endsWith("json")),i=Yr(t)?t[0]:t;return{extension:n?"cube":s?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":(e=i.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:n,isGainmap:s}}function ua(t){return t==="cube"?vu:t==="hdr"?ip:t==="exr"?sp:t==="jpg"||t==="jpeg"?Am:t==="webp"?mm:null}const Bm=t=>t.current&&t.current.isScene,Cm=t=>Bm(t)?t.current:t;function fa(t,e,n,s,i={}){var r,a,c,o;i={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};const l=Cm(e||n),u=l.background,f=l.environment,h={backgroundBlurriness:l.backgroundBlurriness,backgroundIntensity:l.backgroundIntensity,backgroundRotation:(r=(a=l.backgroundRotation)==null||a.clone==null?void 0:a.clone())!==null&&r!==void 0?r:[0,0,0],environmentIntensity:l.environmentIntensity,environmentRotation:(c=(o=l.environmentRotation)==null||o.clone==null?void 0:o.clone())!==null&&c!==void 0?c:[0,0,0]};return t!=="only"&&(l.environment=s),t&&(l.background=s),us(l,i),()=>{t!=="only"&&(l.environment=f),t&&(l.background=u),us(l,h)}}function ha({scene:t,background:e=!1,map:n,...s}){const i=Yt(r=>r.scene);return P.useLayoutEffect(()=>{if(n)return fa(e,t,i,n,s)}),null}function Al({background:t=!1,scene:e,blur:n,backgroundBlurriness:s,backgroundIntensity:i,backgroundRotation:r,environmentIntensity:a,environmentRotation:c,...o}){const l=Gi(o),u=Yt(f=>f.scene);return P.useLayoutEffect(()=>fa(t,e,u,l,{backgroundBlurriness:n??s,backgroundIntensity:i,backgroundRotation:r,environmentIntensity:a,environmentRotation:c})),null}function ym({children:t,near:e=.1,far:n=1e3,resolution:s=256,frames:i=1,map:r,background:a=!1,blur:c,backgroundBlurriness:o,backgroundIntensity:l,backgroundRotation:u,environmentIntensity:f,environmentRotation:h,scene:d,files:m,path:g,preset:v=void 0,extensions:C}){const B=Yt(E=>E.gl),y=Yt(E=>E.scene),b=P.useRef(null),[M]=P.useState(()=>new $o),S=P.useMemo(()=>{const E=new Bu(s);return E.texture.type=Ht,E},[s]);P.useLayoutEffect(()=>{if(i===1){const E=B.autoClear;B.autoClear=!0,b.current.update(B,M),B.autoClear=E}return fa(a,d,y,S.texture,{backgroundBlurriness:c??o,backgroundIntensity:l,backgroundRotation:u,environmentIntensity:f,environmentRotation:h})},[t,M,S.texture,d,y,a,i,B]);let I=1;return xr(()=>{if(i===1/0||I<i){const E=B.autoClear;B.autoClear=!0,b.current.update(B,M),B.autoClear=E,I++}}),P.createElement(P.Fragment,null,Cu(P.createElement(P.Fragment,null,t,P.createElement("cubeCamera",{ref:b,args:[e,n,S]}),m||v?P.createElement(Al,{background:!0,files:m,preset:v,path:g,extensions:C}):r?P.createElement(ha,{background:!0,map:r,extensions:C}):null),M))}function bm(t){var e,n,s,i;const r=Gi(t),a=t.map||r;P.useMemo(()=>yu({GroundProjectedEnvImpl:bd}),[]);const c=P.useMemo(()=>[a],[a]),o=(e=t.ground)==null?void 0:e.height,l=(n=t.ground)==null?void 0:n.radius,u=(s=(i=t.ground)==null?void 0:i.scale)!==null&&s!==void 0?s:1e3;return P.createElement(P.Fragment,null,P.createElement(ha,Zt({},t,{map:a})),P.createElement("groundProjectedEnvImpl",{args:c,scale:u,height:o,radius:l}))}function Em(t){return t.ground?P.createElement(bm,t):t.map?P.createElement(ha,t):t.children?P.createElement(ym,t):P.createElement(Al,t)}let Mr,mn;const _m=P.createContext(null),ko=new zr,Lo=new gt,Mm=P.forwardRef(({children:t,range:e,limit:n=1e3,...s},i)=>{const r=P.useRef(null);P.useImperativeHandle(i,()=>r.current,[]);const[a,c]=P.useState([]),[[o,l,u]]=P.useState(()=>[new Float32Array(n*3),Float32Array.from({length:n*3},()=>1),Float32Array.from({length:n},()=>1)]);P.useEffect(()=>{r.current.geometry.attributes.position.needsUpdate=!0}),xr(()=>{for(r.current.updateMatrix(),r.current.updateMatrixWorld(),ko.copy(r.current.matrixWorld).invert(),r.current.geometry.drawRange.count=Math.min(n,e!==void 0?e:n,a.length),Mr=0;Mr<a.length;Mr++)mn=a[Mr].current,mn.getWorldPosition(Lo).applyMatrix4(ko),Lo.toArray(o,Mr*3),r.current.geometry.attributes.position.needsUpdate=!0,mn.matrixWorldNeedsUpdate=!0,mn.color.toArray(l,Mr*3),r.current.geometry.attributes.color.needsUpdate=!0,u.set([mn.size],Mr),r.current.geometry.attributes.size.needsUpdate=!0});const f=P.useMemo(()=>({getParent:()=>r,subscribe:h=>(c(d=>[...d,h]),()=>c(d=>d.filter(m=>m.current!==h.current)))}),[]);return P.createElement("points",Zt({userData:{instances:a},matrixAutoUpdate:!1,ref:r,raycast:()=>null},s),P.createElement("bufferGeometry",null,P.createElement("bufferAttribute",{attach:"attributes-position",count:o.length/3,array:o,itemSize:3,usage:Qr}),P.createElement("bufferAttribute",{attach:"attributes-color",count:l.length/3,array:l,itemSize:3,usage:Qr}),P.createElement("bufferAttribute",{attach:"attributes-size",count:u.length,array:u,itemSize:1,usage:Qr})),P.createElement(_m.Provider,{value:f},t))}),Tm=P.forwardRef(({children:t,positions:e,colors:n,sizes:s,stride:i=3,...r},a)=>{const c=P.useRef(null);return P.useImperativeHandle(a,()=>c.current,[]),xr(()=>{const o=c.current.geometry.attributes;o.position.needsUpdate=!0,n&&(o.color.needsUpdate=!0),s&&(o.size.needsUpdate=!0)}),P.createElement("points",Zt({ref:c},r),P.createElement("bufferGeometry",null,P.createElement("bufferAttribute",{attach:"attributes-position",count:e.length/i,array:e,itemSize:i,usage:Qr}),n&&P.createElement("bufferAttribute",{attach:"attributes-color",count:n.length/i,array:n,itemSize:3,usage:Qr}),s&&P.createElement("bufferAttribute",{attach:"attributes-size",count:s.length/i,array:s,itemSize:1,usage:Qr})),t)}),wm=P.forwardRef((t,e)=>t.positions instanceof Float32Array?P.createElement(Tm,Zt({},t,{ref:e})):P.createElement(Mm,Zt({},t,{ref:e})));var gl={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Po=rr.createContext&&rr.createContext(gl),Fm=["attr","size","title"];function Im(t,e){if(t==null)return{};var n=Sm(t,e),s,i;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function Sm(t,e){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function Ci(){return Ci=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ci.apply(this,arguments)}function Ho(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,s)}return n}function yi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ho(Object(n),!0).forEach(function(s){Dm(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ho(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Dm(t,e,n){return e=Rm(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rm(t){var e=xm(t,"string");return typeof e=="symbol"?e:e+""}function xm(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vl(t){return t&&t.map((e,n)=>rr.createElement(e.tag,yi({key:n},e.attr),vl(e.child)))}function Gm(t){return e=>rr.createElement(Um,Ci({attr:yi({},t.attr)},e),vl(t.child))}function Um(t){var e=n=>{var{attr:s,size:i,title:r}=t,a=Im(t,Fm),c=i||n.size||"1em",o;return n.className&&(o=n.className),t.className&&(o=(o?o+" ":"")+t.className),rr.createElement("svg",Ci({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,a,{className:o,style:yi(yi({color:t.color||n.color},n.style),t.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),r&&rr.createElement("title",null,r),t.children)};return Po!==void 0?rr.createElement(Po.Consumer,null,n=>e(n)):e(gl)}function Om(t){return Gm({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(t)}const km=({count:t=1e3,radius:e=2})=>{const n=P.useRef(),s=P.useMemo(()=>{const i=new Float32Array(t*3);for(let r=0;r<t;r++){const a=Math.random()*Math.PI*2,c=Math.sqrt(Math.random())*e;i[r*3]=Math.cos(a)*c,i[r*3+1]=Math.random()*e*2,i[r*3+2]=Math.sin(a)*c}return i},[t,e]);return xr((i,r)=>{if(n.current){n.current.rotation.y+=r*.1;const a=n.current.geometry.attributes.position.array;for(let c=1;c<a.length;c+=3)a[c]-=r*.5,a[c]<-e*2&&(a[c]=e*2);n.current.geometry.attributes.position.needsUpdate=!0}}),De.jsx(wm,{ref:n,positions:s,children:De.jsx(am,{transparent:!0,color:"white",size:.05,sizeAttenuation:!0,alphaTest:.5,opacity:.8})})},Lm="/assets/foot-D23zNANO.mp3",An=[{position:[.7,-.9,.5],text:"Это первая точка."},{position:[.9,-.9,-.5],text:"Вторая точка."},{position:[-.8,-1,-.7],text:"Третья точка."}],Pm=({health:t,money:e,fatigue:n,timeElapsed:s})=>De.jsx(ui,{position:[0,0,0],children:De.jsxs("div",{className:"stats-container",children:[De.jsxs("div",{children:["Health: ",t," Money: ",e]}),De.jsxs("div",{children:["Fatigue: ",n]}),De.jsxs("div",{children:["Time: ",s,"s"]})]})}),Hm=()=>{const[t,e]=P.useState({health:100,money:100,fatigue:0}),[n,s]=P.useState(An[0].position),[i,r]=P.useState(null),[a,c]=P.useState(0),[o,l]=P.useState(!1),[u,f]=P.useState(0),h=P.useRef(),d=P.useRef(),{camera:m}=Yt();P.useEffect(()=>{if(!o){const C=setInterval(()=>{f(B=>B+1)},1e3);return()=>clearInterval(C)}},[o]),P.useEffect(()=>{if(!o){const C=setInterval(()=>{e(B=>{let y=B.health,b=B.money,M=B.fatigue;return a===0&&(M=Math.max(0,B.fatigue-4)),a===1&&(y=Math.min(100,B.health+2),b=Math.max(0,B.money-2)),a===2&&(b=Math.min(101,B.money+3)),a!==1&&(y=Math.max(0,y-2),b=Math.max(0,b-2)),M=Math.min(100,M+3),{health:y,money:b,fatigue:M}})},1e3);return()=>clearInterval(C)}},[a,o]),P.useEffect(()=>{(t.health<=0||t.fatigue>=100||t.money<=0)&&l(!0)},[t]),xr(()=>{if(h.current&&An[a]){const B=n.map((y,b)=>y+(An[a].position[b]-y)*.1);s(B),h.current.position.set(...B),d.current&&d.current.lookAt(m.position)}});const g=C=>{switch(c(C),C){case 0:e(B=>({...B,fatigue:Math.max(0,B.fatigue-2)}));break;case 1:e(B=>({...B,health:Math.min(100,B.health+2)}));break;case 2:e(B=>({...B,money:Math.max(0,B.money-2)}));break}Lm.play()},v=()=>{e({health:100,money:100,fatigue:0}),c(0),s(An[0].position),l(!1),f(0)};return De.jsxs(De.Fragment,{children:[De.jsx(Pm,{health:t.health,money:t.money,fatigue:t.fatigue,timeElapsed:u}),De.jsx(ui,{position:[0,0,0],style:{opacity:1,transition:"opacity 0.3s"},children:o?De.jsxs("div",{className:"game-over",children:[De.jsx("h1",{children:"Game Over"}),De.jsx("p",{children:"You lost!"}),De.jsxs("p",{children:["Time survived: ",u,"s"]}),De.jsx("button",{onClick:v,children:"Restart the level"})]}):De.jsx("div",{})}),An.map((C,B)=>De.jsxs("group",{children:[De.jsxs("mesh",{position:C.position,onClick:()=>g(B),onPointerEnter:()=>r(B),onPointerLeave:()=>r(null),children:[De.jsx("sphereGeometry",{args:[.04,16,16]}),De.jsx("meshBasicMaterial",{color:"#ff7777"})]}),De.jsx(ui,{position:C.position,style:{opacity:i===B?1:0,transition:"opacity 0.3s"},children:De.jsx("div",{className:"point-text",children:C.text})})]},B)),De.jsxs("mesh",{ref:h,rotation:[Math.PI,0,0],position:n,children:[De.jsx("coneGeometry",{args:[.1,.2,16]}),De.jsx("meshBasicMaterial",{color:"#77ff77"})]}),De.jsx(ol,{font:"./bangers-v20-latin-regular.woff",ref:d,position:[n[0],n[1]+.3,n[2]],fontSize:.1,color:"#7777FF",anchorX:"center",anchorY:"middle",children:"you"})]})};function Qm(){const t=xi("/static/scene.glb"),[e,n]=P.useState(!0),[s,i]=P.useState(!0);return P.useEffect(()=>{(()=>{const a=setTimeout(()=>{i(!1)},3e3);return()=>clearTimeout(a)})()},[]),De.jsx(De.Fragment,{children:De.jsxs(De.Fragment,{children:[De.jsx("color",{args:["#241a1a"],attach:"background"}),De.jsx(Em,{preset:"city"}),De.jsx(od,{global:!0,rotation:[.13,.1,0],polar:[-.4,.2],azimuth:[-1,.75],config:{mass:2,tension:400},snap:{mass:4,tension:400},children:De.jsxs(om,{rotationIntensity:.4,children:[De.jsx("rectAreaLight",{width:2.5,height:1.65,intensity:65,color:"#ff6900",rotation:[-.1,Math.PI,0],position:[0,.55,-1.15]}),De.jsx("primitive",{object:t.scene,"position-y":-1.2,"rotation-x":-.14,children:De.jsx(ui,{transform:!0,wrapperClass:"gitIcon",distanceFactor:1.17,position:[-.9,1.7,-2.3],"rotation-x":-.256,children:De.jsx("a",{href:"https://github.com/Spoon221",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",color:"inherit"},children:De.jsxs("div",{style:{textAlign:"center",cursor:"pointer"},children:[De.jsx(Om,{size:50,color:"#ffffff"})," ",De.jsx("p",{style:{margin:0,color:"#ffffff",fontSize:"14px"},children:"GitHub"})]})})})}),De.jsx(Nm,{font:"./bangers-v20-latin-regular.woff",fontSize:1,position:[2,.75,.75],"rotation-y":-1.25,maxWidth:2,children:"Evgenii Simakov"}),De.jsx(km,{count:1e3,radius:2,position:[2,.75,.75]})]})}),De.jsx(Hm,{showHints:e})]})})}function Nm(t){return De.jsx(ol,{...t})}export{Qm as default};
//# sourceMappingURL=Experience-Caihka3F.js.map
